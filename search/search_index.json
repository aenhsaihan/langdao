{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"LangDAO","text":"<p>Mission: Helping people worldwide use their language skills to learn, teach, and earn crypto in Web3.</p> <ul> <li>\ud83c\udf0d Global by design \u2014 LatAm as the first test region</li> <li>\ud83e\udde9 Core integrations: Custom WebRTC (live sessions), PYUSD (payments)</li> <li>\ud83c\udfaf Focus: Skill-based onboarding, community learning, and fair incentives</li> </ul> <p>\u27a1 Start here:</p> <ul> <li>What we\u2019re building: Product Overview</li> <li>What ships for the hackathon: MVP Scope</li> <li>How it works under the hood: Architecture</li> <li>Why LatAm first: Testbed rationale</li> </ul>"},{"location":"adr/0001-huddle01/","title":"ADR-0001: ~~Choose Huddle01~~ Use Custom WebRTC for Live Sessions","text":"<p>Status: SUPERSEDED - Huddle01 did not work for our use case. We implemented a custom WebRTC solution instead.</p>"},{"location":"adr/0001-huddle01/#original-context","title":"Original Context","text":"<p>We need decentralized, wallet-aware live sessions that feel native to Web3.</p>"},{"location":"adr/0001-huddle01/#original-decision","title":"Original Decision","text":"<p>~~Adopt Huddle01 as the video layer for MVP.~~</p>"},{"location":"adr/0001-huddle01/#what-actually-happened","title":"What Actually Happened","text":"<p>Huddle01 integration did not work as expected. We built a custom WebRTC implementation instead.</p>"},{"location":"adr/0001-huddle01/#actual-implementation","title":"Actual Implementation","text":"<ul> <li>Custom WebRTC server in <code>backend/webRTC-implementation-LangDAO/</code></li> <li>Peer-to-peer video/audio calls</li> <li>Session monitoring and disconnect detection</li> <li>Direct integration with our backend for session lifecycle management</li> </ul>"},{"location":"adr/0001-huddle01/#rationale-for-custom-solution","title":"Rationale for Custom Solution","text":"<ul> <li>More control over session lifecycle</li> <li>Easier integration with our payment system</li> <li>Better disconnect detection for auto-ending sessions</li> <li>Simpler to debug and maintain</li> </ul>"},{"location":"adr/0001-huddle01/#consequences","title":"Consequences","text":"<ul> <li>\u2705 Full control over video infrastructure</li> <li>\u2705 Tight integration with session management</li> <li>\u2705 Reliable disconnect detection</li> <li>\u26a0\ufe0f More code to maintain (but worth it)</li> <li>\u26a0\ufe0f Need to handle scaling ourselves</li> </ul>"},{"location":"adr/0001-huddle01/#future-considerations","title":"Future Considerations","text":"<ul> <li>Evaluate recording capabilities</li> <li>Add moderation features</li> <li>Consider TURN servers for better connectivity</li> <li>Monitor performance and scale limits</li> </ul>"},{"location":"architecture/overview/","title":"LangDAO - Actual Architecture (As Implemented)","text":"<p>Last Updated: November 10, 2025</p> <p>This document describes the actual implemented architecture, not the planned/documented one.</p>"},{"location":"architecture/overview/#high-level-overview","title":"High-Level Overview","text":"<p>LangDAO is a real-time language tutoring platform where students and tutors connect via Socket.io, conduct video sessions via WebRTC, and settle payments on-chain using a custom timestamp-based payment system.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Student   \u2502\n\u2502  (Next.js)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n       \u2502                 \u2502\n       \u25bc                 \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Socket.io  \u2502   \u2502   WebRTC    \u2502\n\u2502   Backend   \u2502   \u2502   Server    \u2502\n\u2502  (Express)  \u2502   \u2502  (Custom)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                 \u2502\n       \u25bc                 \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502    Redis    \u2502          \u2502\n\u2502   (State)   \u2502          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n       \u2502                 \u2502\n       \u25bc                 \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   LangDAO Contract      \u2502\n\u2502   (Timestamp-based      \u2502\n\u2502    Payment System)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/overview/#core-components","title":"Core Components","text":""},{"location":"architecture/overview/#1-frontend-nextjs-scaffold-eth-2","title":"1. Frontend (Next.js + Scaffold-ETH 2)","text":"<p>Location: <code>webapp/packages/nextjs/</code></p> <p>Key Pages:</p> <ul> <li><code>/</code> - Landing page</li> <li><code>/find-tutor</code> - Student flow (request tutor, accept offers, start session)</li> <li><code>/tutor</code> - Tutor flow (set availability, accept requests, join sessions)</li> <li><code>/dashboard</code> - User dashboard (session history, earnings)</li> </ul> <p>Tech Stack:</p> <ul> <li>Next.js 14 (App Router)</li> <li>wagmi + viem (Web3 interactions)</li> <li>Socket.io-client (Real-time matching)</li> <li>Thirdweb (Wallet connection)</li> <li>TailwindCSS + Framer Motion (UI)</li> </ul> <p>Key Features:</p> <ul> <li>Wallet connection (WalletConnect, MetaMask, etc.)</li> <li>Real-time tutor/student matching</li> <li>Session lifecycle management</li> <li>PYUSD token interactions</li> </ul>"},{"location":"architecture/overview/#2-backend-express-socketio-redis","title":"2. Backend (Express + Socket.io + Redis)","text":"<p>Location: <code>backend/src/</code></p> <p>Purpose: Real-time matching and session coordination</p> <p>Tech Stack:</p> <ul> <li>Express.js (HTTP API)</li> <li>Socket.io (Real-time events)</li> <li>Redis (State management)</li> <li>ethers.js (Blockchain interactions)</li> </ul> <p>Key Responsibilities:</p> <ul> <li>Match students with available tutors</li> <li>Manage pending requests and acceptances</li> <li>Track session state (waiting, active, ended)</li> <li>Call <code>endSession()</code> when WebRTC detects disconnect</li> <li>Rate limiting and security</li> </ul> <p>Socket Events: <pre><code>// Tutor events\ntutor:setAvailable        // Tutor goes online\ntutor:set-unavailable     // Tutor goes offline\ntutor:accept-request      // Tutor accepts student request\ntutor:decline-request     // Tutor declines student request\ntutor:withdraw-acceptance // Tutor cancels their acceptance\n\n// Student events\nstudent:request-tutor     // Student requests a tutor\nstudent:cancel-request    // Student cancels their request\nstudent:accept-tutor      // Student accepts a tutor offer\nstudent:reject-tutor      // Student rejects a tutor offer\nstudent:entered-room      // Student joined video call\nstudent:rejected-transaction // Student rejected wallet tx\n\n// Session events\nsession:started           // Blockchain tx confirmed\n</code></pre></p> <p>Redis Data Structures: <pre><code>tutors:available          // Set of available tutor addresses\ntutor:{address}           // Hash: {socketId, language, ratePerSecond}\nstudent_request:{id}      // Hash: {studentAddress, language, budgetPerSecond}\nsession:{requestId}       // Hash: {studentAddress, tutorAddress, languageId}\nsocket_to_address         // Hash: socketId -&gt; address mapping\nrate_limit:{socketId}     // Rate limiting counter\n</code></pre></p>"},{"location":"architecture/overview/#3-smart-contract-solidity","title":"3. Smart Contract (Solidity)","text":"<p>Location: <code>webapp/packages/hardhat/contracts/LangDAO.sol</code></p> <p>Purpose: Session management and payment processing</p> <p>Key Features:</p>"},{"location":"architecture/overview/#user-registration","title":"User Registration","text":"<pre><code>registerStudent(uint8 targetLanguage, uint256 budgetPerSec)\nregisterTutor(uint8[] languages, uint256 ratePerSecond)\n</code></pre>"},{"location":"architecture/overview/#funds-management","title":"Funds Management","text":"<pre><code>depositFunds(uint256 amount)        // Student deposits PYUSD\nwithdrawFunds(uint256 amount)       // Student withdraws PYUSD\n</code></pre>"},{"location":"architecture/overview/#session-lifecycle","title":"Session Lifecycle","text":"<pre><code>startSession(address tutor, uint8 language) returns (uint256 sessionId)\nendSession(address tutor)\n</code></pre>"},{"location":"architecture/overview/#payment-calculation","title":"Payment Calculation","text":"<pre><code>// In endSession():\nuint256 duration = block.timestamp - session.startTime;\nuint256 payment = duration * session.ratePerSecond;\n\n// Cap at available balance to prevent revert\nuint256 totalPayment = min(payment, studentBalance);\n\n// Transfer PYUSD from contract to tutor\nIERC20(PYUSD_TOKEN).transfer(tutor, totalPayment);\n</code></pre> <p>Language System:</p> <ul> <li>38 supported languages (English=0, Spanish=1, French=2, etc.)</li> <li>Each tutor can teach multiple languages with different rates</li> <li>Language IDs are uint8 for gas efficiency</li> </ul> <p>Payment Token:</p> <ul> <li>PYUSD (PayPal USD) on Sepolia testnet</li> <li>Address: <code>0xCaC524BcA292aaade2DF8A05cC58F0a65B1B3bB9</code></li> </ul>"},{"location":"architecture/overview/#4-webrtc-server-custom-implementation","title":"4. WebRTC Server (Custom Implementation)","text":"<p>Location: <code>backend/webRTC-implementation-LangDAO/</code></p> <p>Purpose: Video call infrastructure (custom WebRTC implementation)</p> <p>Key Features:</p> <ul> <li>Peer-to-peer video/audio calls</li> <li>Session heartbeat monitoring</li> <li>Disconnect detection</li> <li>Sends events to main backend when:<ul> <li>User disconnects</li> <li>Call ends</li> <li>Heartbeat timeout (2 minutes)</li> </ul> </li> </ul> <p>Integration: <pre><code>// WebRTC server sends HTTP POST to backend\nPOST /api/webrtc-events\n{\n  \"type\": \"session-ended\",\n  \"sessionId\": \"req_abc123\",\n  \"endedBy\": \"student\",\n  \"timestamp\": 1234567890\n}\n\n// Backend calls smart contract\nawait langDAOContract.endSession(tutorAddress);\n</code></pre></p>"},{"location":"architecture/overview/#complete-user-flow","title":"Complete User Flow","text":""},{"location":"architecture/overview/#student-journey","title":"Student Journey","text":"<ol> <li> <p>Connect Wallet</p> <ul> <li>Student connects wallet (MetaMask, WalletConnect, etc.)</li> <li>Frontend checks if registered on-chain</li> </ul> </li> <li> <p>Register (if needed)</p> <ul> <li>Call <code>registerStudent(targetLanguage, budgetPerSec)</code></li> <li>Deposit PYUSD via <code>depositFunds(amount)</code></li> </ul> </li> <li> <p>Request Tutor</p> <ul> <li>Select language and budget</li> <li>Emit <code>student:request-tutor</code> socket event</li> <li>Backend stores request in Redis</li> <li>Backend notifies all matching tutors</li> </ul> </li> <li> <p>Wait for Offers</p> <ul> <li>Tutors who accept emit <code>tutor:accept-request</code></li> <li>Student receives <code>student:tutor-accepted</code> events</li> <li>UI shows list of tutors who accepted</li> </ul> </li> <li> <p>Select Tutor</p> <ul> <li>Student clicks \"Accept\" on a tutor</li> <li>Emit <code>student:accept-tutor</code> socket event</li> <li>Backend notifies rejected tutors</li> <li>Backend notifies selected tutor</li> </ul> </li> <li> <p>Start Session (Blockchain)</p> <ul> <li>Student approves PYUSD spending (if needed)</li> <li>Call <code>startSession(tutorAddress, languageId)</code></li> <li>Transaction mined \u2192 session starts on-chain</li> <li>Emit <code>session:started</code> socket event</li> </ul> </li> <li> <p>Enter Video Call</p> <ul> <li>Student redirected to WebRTC room</li> <li>Emit <code>student:entered-room</code> socket event</li> <li>Backend notifies tutor to join</li> </ul> </li> <li> <p>Video Session</p> <ul> <li>Both parties in WebRTC call</li> <li>WebRTC server monitors connection</li> <li>Payment accrues per second on-chain</li> </ul> </li> <li> <p>End Session</p> <ul> <li>Either party clicks \"End Call\"</li> <li>WebRTC server \u2192 Backend \u2192 <code>endSession(tutorAddress)</code></li> <li>Payment calculated: <code>duration * ratePerSecond</code></li> <li>PYUSD transferred to tutor</li> <li>Both parties redirected to dashboard</li> </ul> </li> </ol>"},{"location":"architecture/overview/#tutor-journey","title":"Tutor Journey","text":"<ol> <li> <p>Connect Wallet</p> <ul> <li>Tutor connects wallet</li> </ul> </li> <li> <p>Register (if needed)</p> <ul> <li>Call <code>registerTutor(languages[], ratePerSecond)</code></li> <li>Set languages and rates</li> </ul> </li> <li> <p>Set Available</p> <ul> <li>Select language to teach</li> <li>Set rate per second</li> <li>Emit <code>tutor:setAvailable</code> socket event</li> <li>Backend stores in Redis</li> </ul> </li> <li> <p>Receive Requests</p> <ul> <li>Backend sends <code>tutor:incoming-request</code> for matching students</li> <li>UI shows pending student requests</li> </ul> </li> <li> <p>Accept Request</p> <ul> <li>Tutor clicks \"Accept\"</li> <li>Emit <code>tutor:accept-request</code> socket event</li> <li>Backend notifies student</li> </ul> </li> <li> <p>Wait for Student Selection</p> <ul> <li>Student may accept or reject</li> <li>If accepted: receive <code>tutor:student-selected</code></li> <li>If rejected: receive <code>tutor:student-rejected</code></li> </ul> </li> <li> <p>Wait for Blockchain Confirmation</p> <ul> <li>Student calls <code>startSession()</code> on-chain</li> <li>Tutor receives <code>session:started</code> socket event</li> </ul> </li> <li> <p>Wait for Student to Enter Room</p> <ul> <li>Student enters WebRTC room first</li> <li>Tutor receives <code>student:in-room</code> socket event</li> <li>Tutor can now join</li> </ul> </li> <li> <p>Join Video Call</p> <ul> <li>Tutor joins WebRTC room</li> <li>Session is live</li> </ul> </li> <li> <p>End Session</p> <ul> <li>Either party ends call</li> <li>Backend calls <code>endSession()</code></li> <li>Tutor receives PYUSD payment</li> <li>Redirect to dashboard</li> </ul> </li> </ol>"},{"location":"architecture/overview/#payment-system-details","title":"Payment System Details","text":""},{"location":"architecture/overview/#how-it-works","title":"How It Works","text":"<p>No streaming protocol needed - payments are calculated at session end based on timestamps.</p>"},{"location":"architecture/overview/#1-student-deposits-funds","title":"1. Student Deposits Funds","text":"<pre><code>// Student deposits PYUSD into contract\ndepositFunds(1000 * 10**6); // 1000 PYUSD (6 decimals)\n\n// Contract stores balance\nstudentBalances[student][PYUSD_TOKEN] = 1000 * 10**6;\n</code></pre>"},{"location":"architecture/overview/#2-session-starts","title":"2. Session Starts","text":"<pre><code>// Student calls startSession()\nstartSession(tutorAddress, SPANISH);\n\n// Contract records start time\nsession.startTime = block.timestamp; // e.g., 1699999000\nsession.ratePerSecond = 100000; // 0.1 PYUSD per second\n</code></pre>"},{"location":"architecture/overview/#3-session-ends","title":"3. Session Ends","text":"<pre><code>// Backend or user calls endSession()\nendSession(tutorAddress);\n\n// Contract calculates payment\nuint256 duration = block.timestamp - session.startTime; // e.g., 600 seconds (10 min)\nuint256 payment = duration * session.ratePerSecond; // 600 * 100000 = 60,000,000 (60 PYUSD)\n\n// Cap at available balance\nuint256 totalPayment = min(payment, studentBalance); // 60 PYUSD\n\n// Transfer to tutor\nIERC20(PYUSD_TOKEN).transfer(tutor, totalPayment);\n\n// Update balances\nstudentBalances[student][PYUSD_TOKEN] -= totalPayment;\ntutors[tutor].totalEarnings += totalPayment;\n</code></pre>"},{"location":"architecture/overview/#why-this-approach","title":"Why This Approach?","text":"<p>Advantages over Superfluid/Sablier:</p> <ul> <li>\u2705 Simpler implementation (no external dependencies)</li> <li>\u2705 No liquidation risk</li> <li>\u2705 No buffer requirements</li> <li>\u2705 Easier to understand and audit</li> <li>\u2705 Lower gas costs</li> <li>\u2705 More predictable behavior</li> </ul> <p>Trade-offs:</p> <ul> <li>\u26a0\ufe0f Payment happens at end (not streaming in real-time)</li> <li>\u26a0\ufe0f Requires trust that <code>endSession()</code> will be called</li> <li>\u26a0\ufe0f Backend must be reliable to call <code>endSession()</code> on disconnect</li> </ul> <p>Mitigation:</p> <ul> <li>WebRTC server monitors connection and calls <code>endSession()</code> on disconnect</li> <li>Heartbeat timeout (2 min) triggers auto-end</li> <li>Owner can emergency end sessions</li> <li>Student/tutor can both call <code>endSession()</code></li> </ul>"},{"location":"architecture/overview/#security-considerations","title":"Security Considerations","text":""},{"location":"architecture/overview/#smart-contract","title":"Smart Contract","text":"<ul> <li>\u2705 Payment capped at student balance (no revert risk)</li> <li>\u2705 Only student, tutor, or owner can end session</li> <li>\u2705 Session must be active to end</li> <li>\u2705 Student can't withdraw while in session</li> <li>\u26a0\ufe0f No reentrancy guard (consider adding)</li> <li>\u26a0\ufe0f No emergency pause mechanism</li> </ul>"},{"location":"architecture/overview/#backend","title":"Backend","text":"<ul> <li>\u2705 Rate limiting on socket events (10 req/min)</li> <li>\u2705 Rate limiting on HTTP endpoints (100 req/min)</li> <li>\u2705 CORS configured</li> <li>\u2705 Helmet security headers</li> <li>\u26a0\ufe0f Backend private key stored in .env (use secrets manager in prod)</li> <li>\u26a0\ufe0f No authentication on socket events (anyone can emit)</li> </ul>"},{"location":"architecture/overview/#frontend","title":"Frontend","text":"<ul> <li>\u2705 Wallet signature verification</li> <li>\u2705 Transaction confirmation before session start</li> <li>\u26a0\ufe0f No session timeout on frontend</li> <li>\u26a0\ufe0f No balance check before long sessions</li> </ul>"},{"location":"architecture/overview/#known-issues-workarounds","title":"Known Issues &amp; Workarounds","text":""},{"location":"architecture/overview/#1-language-matching-mismatch","title":"1. Language Matching Mismatch","text":"<p>Issue: Frontend uses lowercase codes (\"spanish\"), backend uses strings, contract uses IDs (1).</p> <p>Current Workaround: Frontend maps language codes to IDs before calling contract.</p> <p>Proper Fix: Use language IDs everywhere (see <code>LANGUAGE_MATCHING_FIX.md</code>).</p>"},{"location":"architecture/overview/#2-socket-binding-race-condition","title":"2. Socket Binding Race Condition","text":"<p>Issue: Tutor socket may not be bound when student starts session.</p> <p>Current Workaround: Backend logs socket binding and checks before emitting.</p> <p>Proper Fix: Add retry logic or confirmation handshake.</p>"},{"location":"architecture/overview/#3-webrtc-disconnect-detection","title":"3. WebRTC Disconnect Detection","text":"<p>Issue: If WebRTC server is down, sessions won't auto-end.</p> <p>Current Workaround: Student/tutor can manually call <code>endSession()</code>.</p> <p>Proper Fix: Add redundant monitoring (frontend heartbeat, backend polling).</p>"},{"location":"architecture/overview/#environment-variables","title":"Environment Variables","text":""},{"location":"architecture/overview/#backend-env","title":"Backend (.env)","text":"<pre><code># Server\nPORT=4000\nNODE_ENV=development\nCORS_ORIGIN=http://localhost:3000\n\n# Blockchain\nRPC_URL=http://localhost:8545\nBACKEND_PRIVATE_KEY=your_private_key_here\n\n# Redis\nREDIS_URL=redis://localhost:6379\n</code></pre>"},{"location":"architecture/overview/#frontend-envlocal","title":"Frontend (.env.local)","text":"<pre><code>NEXT_PUBLIC_SOCKET_URL=http://localhost:4000\nNEXT_PUBLIC_WEBRTC_URL=http://localhost:3000\n</code></pre>"},{"location":"architecture/overview/#webrtc-server-env","title":"WebRTC Server (.env)","text":"<pre><code>PORT=3000\nBACKEND_URL=http://localhost:4000/api/webrtc-events\n</code></pre>"},{"location":"architecture/overview/#deployment-architecture","title":"Deployment Architecture","text":""},{"location":"architecture/overview/#development-current","title":"Development (Current)","text":"<pre><code>localhost:3000  - Next.js frontend\nlocalhost:4000  - Backend API + Socket.io\nlocalhost:3000  - WebRTC server (different port)\nlocalhost:6379  - Redis\nlocalhost:8545  - Hardhat local blockchain\n</code></pre>"},{"location":"architecture/overview/#production-planned","title":"Production (Planned)","text":"<pre><code>Vercel          - Next.js frontend\nRailway/Render  - Backend API + Socket.io\nRailway/Render  - WebRTC server\nRedis Cloud     - Redis\nSepolia         - Ethereum testnet\n</code></pre>"},{"location":"architecture/overview/#testing","title":"Testing","text":""},{"location":"architecture/overview/#manual-testing-flow","title":"Manual Testing Flow","text":"<ol> <li> <p>Start all services: <pre><code># Terminal 1: Blockchain\ncd webapp/packages/hardhat &amp;&amp; yarn chain\n\n# Terminal 2: Redis\nredis-server\n\n# Terminal 3: Backend\ncd backend &amp;&amp; yarn dev\n\n# Terminal 4: WebRTC\ncd backend/webRTC-implementation-LangDAO &amp;&amp; npm start\n\n# Terminal 5: Frontend\ncd webapp &amp;&amp; yarn start\n</code></pre></p> </li> <li> <p>Test student flow:</p> <ul> <li>Open http://localhost:3000</li> <li>Connect wallet</li> <li>Register as student</li> <li>Deposit PYUSD</li> <li>Request tutor</li> </ul> </li> <li> <p>Test tutor flow:</p> <ul> <li>Open http://localhost:3000 in incognito</li> <li>Connect different wallet</li> <li>Register as tutor</li> <li>Set available</li> <li>Accept student request</li> </ul> </li> <li> <p>Test session:</p> <ul> <li>Student accepts tutor</li> <li>Student starts session (blockchain tx)</li> <li>Both enter video call</li> <li>End call</li> <li>Verify payment on dashboard</li> </ul> </li> </ol>"},{"location":"architecture/overview/#automated-tests","title":"Automated Tests","text":"<p>\u26a0\ufe0f Not implemented yet - need to add:</p> <ul> <li>Smart contract tests (Hardhat)</li> <li>Backend integration tests (Jest + Supertest)</li> <li>Socket event tests (Socket.io-client)</li> <li>Frontend E2E tests (Playwright)</li> </ul>"},{"location":"architecture/overview/#future-improvements","title":"Future Improvements","text":""},{"location":"architecture/overview/#short-term","title":"Short-term","text":"<ol> <li>Add proper language ID mapping throughout stack</li> <li>Add socket authentication (signed messages)</li> <li>Add session timeout handling</li> <li>Add balance warnings before long sessions</li> <li>Add reentrancy guard to contract</li> </ol>"},{"location":"architecture/overview/#medium-term","title":"Medium-term","text":"<ol> <li>Implement POAP/credential minting</li> <li>Add rating system</li> <li>Add session history UI</li> <li>Add tutor profiles</li> <li>Add booking system</li> </ol>"},{"location":"architecture/overview/#long-term","title":"Long-term","text":"<ol> <li>Multi-chain support</li> <li>DAO governance for tutor vetting</li> <li>Reputation system</li> <li>Mobile app</li> <li>Group sessions</li> </ol>"},{"location":"architecture/overview/#summary","title":"Summary","text":"<p>What works:</p> <ul> <li>Real-time matching via Socket.io</li> <li>Video calls via custom WebRTC implementation</li> <li>Timestamp-based payments via custom smart contract</li> <li>Full session lifecycle from request to payment</li> </ul> <p>What's different from docs:</p> <ul> <li>No Superfluid/Sablier (custom payment system instead)</li> <li>No separate Matchmaker API (Socket.io backend handles it)</li> <li>No Relayer Bot (backend calls contract directly)</li> <li>No booking system (roulette matching only)</li> <li>No POAP/credentials (not implemented yet)</li> </ul> <p>Key insight: The actual implementation is simpler and more pragmatic than the documented architecture. This is good - it's easier to understand, maintain, and debug.</p>"},{"location":"bug-reports/","title":"Bug Reports","text":"<p>This directory contains bug reports generated from video analysis sessions using Google AI Studio.</p>"},{"location":"bug-reports/#file-naming-convention","title":"\ud83d\udcc1 File Naming Convention","text":"<p>Bug reports follow this naming pattern:</p> <pre><code>bug-report-YYYY-MM-DD-[brief-description].md\n</code></pre> <p>Examples:</p> <ul> <li><code>bug-report-2025-01-18-tutor-student-ux-issues.md</code></li> <li><code>bug-report-2025-01-21-webrtc-session-flow.md</code></li> <li><code>bug-report-2025-01-25-payment-processing.md</code></li> </ul>"},{"location":"bug-reports/#current-bug-reports","title":"\ud83d\udccb Current Bug Reports","text":"Date File Description Status Tasks 2025-01-18 bug-report-2025-01-18-tutor-student-ux-issues.md Tutor dashboard &amp; student session start flow UX issues \u2705 COMPLETED 3/3 done 2025-01-21 bug-report-2025-01-21-student-session-warning-and-language-flicker.md Missing student session warning &amp; language dropdown flicker \u2705 COMPLETED 2/2 done 2025-01-22 bug-report-2025-01-22-ux-polish-and-navigation-issues.md UX polish &amp; navigation issues (ghost toast, broken button, flicker, language codes) \u2705 COMPLETED 4/4 done 2025-01-22 bug-report-2025-01-22-authentication-routing-and-ui-issues.md Authentication routing flicker, budget display, error handling, loading states \ud83d\udd34 TODO 0/4 done"},{"location":"bug-reports/#workflow","title":"\ud83c\udfaf Workflow","text":"<ol> <li>Record Video: Record screen showing the bugs/issues</li> <li>Analyze with Google AI Studio: Upload video and get text analysis</li> <li>Create Bug Report:</li> <li>Copy <code>bug-report-template.md</code> to new file with date and description</li> <li>Fill in the template with AI Studio analysis</li> <li>Add to this README table</li> <li>Create Kanban Tasks: Create tasks in Vibe Kanban from the bug report</li> <li>Track Progress: Update status in bug report as tasks are completed</li> </ol>"},{"location":"bug-reports/#template","title":"\ud83d\udcdd Template","text":"<p>Use <code>bug-report-template.md</code> as a starting point for new bug reports.</p>"},{"location":"bug-reports/#status-legend","title":"\ud83d\udd0d Status Legend","text":"<ul> <li>\ud83d\udd34 CRITICAL - Blocks core functionality, must fix immediately</li> <li>\ud83d\udfe1 MEDIUM - Affects UX but doesn't block functionality</li> <li>\ud83d\udfe2 LOW - Minor issues, nice to have fixes</li> </ul> <p>Last Updated: 2025-01-22</p>"},{"location":"bug-reports/bug-report-2025-01-18-tutor-student-ux-issues/","title":"Bug report 2025 01 18 tutor student ux issues","text":"<p>Here is a structured, Agentic-Friendly Bug Report tailored for Cursor. You can copy and paste the prompt section directly into Cursor\u2019s \"Composer\" (Cmd+I / Ctrl+I) or Chat.</p> <p>I have broken this down into three distinct tasks based on the issues highlighted in the video.</p>"},{"location":"bug-reports/bug-report-2025-01-18-tutor-student-ux-issues/#bug-report-feature-request-summary","title":"\ud83d\udccb Bug Report &amp; Feature Request Summary","text":"<p>Project: LangDAO Scope: Tutor Dashboard &amp; Student Session Start Flow Context: The video highlights three specific UI/UX issues occurring during the \"Find a Tutor\" -&gt; \"Accept Request\" -&gt; \"Start Session\" flow.</p>"},{"location":"bug-reports/bug-report-2025-01-18-tutor-student-ux-issues/#prompt-for-cursor-copy-paste-this","title":"\ud83e\udd16 Prompt for Cursor (Copy &amp; Paste this)","text":"<p>Context for the Agent: We are fixing UI/UX issues in the LangDAO React application. The flow involves a Student finding a Tutor, the Tutor selecting a language, the Tutor accepting a request, and the Student starting the session (which triggers a wallet transaction).</p> <p>Please perform the following 3 fixes:</p>"},{"location":"bug-reports/bug-report-2025-01-18-tutor-student-ux-issues/#task-1-auto-select-single-language-tutor-side-completed","title":"Task 1: Auto-Select Single Language (Tutor Side) \u2705 COMPLETED","text":"<p>Location: <code>webapp/packages/nextjs/components/tutor/TutorAvailabilityFlow.tsx</code> Current Behavior: The user sees a list of registered languages. Even if there is only one language (e.g., Spanish), they must manually click it to select it. Expected Behavior:</p> <ul> <li>Check the length of the registered languages array.</li> <li>Logic: <code>if (languages.length === 1)</code>, automatically set that language as the <code>selectedLanguage</code> on component mount.</li> <li>The \"Select Language\" button should become active immediately without user intervention.</li> </ul> <p>Implementation: - \u2705 Added <code>useEffect</code> hook that auto-selects language when <code>tutorLanguages.length === 1</code> - \u2705 Only auto-selects when in \"setup\" state and no language is currently selected - \u2705 Waits for tutor info to finish loading before auto-selecting - \u2705 Implemented in <code>TutorAvailabilityFlow.tsx</code> (lines 53-62)</p>"},{"location":"bug-reports/bug-report-2025-01-18-tutor-student-ux-issues/#task-2-fix-persistent-notification-toast-tutor-side-completed","title":"Task 2: Fix Persistent Notification Toast (Tutor Side) \u2705 COMPLETED","text":"<p>Location: <code>webapp/packages/nextjs/components/tutor/TutorAvailabilityFlow.tsx</code> Current Behavior: When a student requests a session, a top-level Toast notification appears and a card appears in the main dashboard. When the Tutor clicks \"Accept\" on the dashboard card, the top-level Toast notification remains on screen (\"lingers\") and does not disappear. Expected Behavior:</p> <ul> <li>Ensure that the state controlling the visibility of the \"New Student Request\" Toast is tied to the request status.</li> <li>Fix: When the request is <code>Accepted</code> (via the main card button), strictly force the Toast notification to close/dismiss. Check for a <code>setShowNotification(false)</code> or similar cleanup function that is missing in the <code>handleAccept</code> handler.</li> </ul> <p>Implementation: - \u2705 Added <code>requestToastMapRef</code> to store mapping of requestId -&gt; toastId - \u2705 Store toast ID when creating toast in <code>handleIncomingRequest</code> - \u2705 Dismiss toast in <code>acceptRequest</code> when called from card button - \u2705 Dismiss toast in <code>declineRequest</code> when called from card button (for consistency) - \u2705 Dismiss all toasts in <code>handleRequestAccepted</code> for safety - \u2705 Clean up toast IDs from map when dismissed</p>"},{"location":"bug-reports/bug-report-2025-01-18-tutor-student-ux-issues/#task-3-add-loading-state-to-start-session-button-student-side-completed","title":"Task 3: Add Loading State to \"Start Session\" Button (Student Side) \u2705 COMPLETED","text":"<p>Location: <code>webapp/packages/nextjs/components/student/StudentTutorFinder.tsx</code> Current Behavior: When the Student clicks \"Start Session Now,\" the button provides no visual feedback. The app waits for a MetaMask wallet signature in the background, making the UI look unresponsive. Expected Behavior:</p> <ul> <li>Add an <code>isProcessing</code> or <code>isLoading</code> state to the \"Start Session Now\" button.</li> <li>Logic:</li> <li><code>onClick</code> -&gt; Set <code>isLoading(true)</code>.</li> <li>Show a spinner or change text to \"Waiting for Wallet...\" and disable the button.</li> <li>Once the transaction is submitted or fails, reset the state.</li> </ul> <p>Implementation: - \u2705 Added <code>isPreparingTransaction</code> state to track when waiting for MetaMask - \u2705 Set loading state before <code>walletClient.writeContract()</code> call - \u2705 Show spinner and \"Waiting for Wallet...\" text when loading - \u2705 Disable button during transaction preparation - \u2705 Reset loading state after MetaMask popup appears (transaction submitted) - \u2705 Reset loading state on error (user rejection, etc.)</p>"},{"location":"bug-reports/bug-report-2025-01-18-tutor-student-ux-issues/#technical-context-for-the-developer","title":"\ud83d\udee0\ufe0f Technical Context (For the Developer)","text":"<p>If you are manually reviewing the code before running the agent, here are the timestamps and specific behaviors observed:</p> <ol> <li>0:59 - 1:15 (Language Select): The UI forces a click on \"Spanish\" even though it's the solitary option.</li> <li>1:45 - 2:05 (Ghost Notification): The \"New Student Request\" banner at the top of the screen persists after the session has already moved to \"Waiting for Student to Start.\" This creates UI clutter and confusion.</li> <li>2:15 - 2:35 (Unresponsive Button): The \"Start Session Now\" button is clicked, but remains green and clickable with no spinner, despite the fact that a blockchain transaction is being prepared in the background.</li> </ol> <p>(Note: The 404 error at the end of the video was explicitly excluded from this report as per your instructions to focus on the previous bugs.)</p>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/","title":"Bug Report - Student Session Warning &amp; Language Flicker","text":"<p>Date: 2025-01-21 Session: 2 Source: Video analysis via Google AI Studio Status: \u2705 FIXED</p>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#summary","title":"\ud83d\udccb Summary","text":"<p>Project: LangDAO Scope: Student Dashboard &amp; Session Management Context: Two UX critical bugs identified: missing session warnings for students (who are paying) and a UI \"flicker\" regarding language defaults.</p>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#video-analysis","title":"\ud83c\udfa5 Video Analysis","text":"<p>Video Timestamps:</p> <ul> <li>0:00 - 1:05: Missing Student Warning - Tutor shows red warning modal, Student shows nothing despite being charged</li> <li>2:25 - 3:10: Language Flicker - Target Language dropdown shows \"English\" initially, then snaps to \"Spanish\"</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#bugs-identified","title":"\ud83d\udc1b Bugs Identified","text":""},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#bug-1-missing-active-session-warning-for-students-fixed","title":"Bug 1: Missing \"Active Session\" Warning for Students \u2705 FIXED","text":"<p>Priority: \ud83d\udd34 CRITICAL Status: \u2705 FIXED (2025-01-21)</p> <p>Location: Student Dashboard (compare with Tutor Dashboard)</p> <p>Current Behavior:</p> <ul> <li>When a Tutor enters the dashboard with an ongoing session, they see a red modal: \"Active Session Detected! You have an ongoing tutoring session. Please end it...\"</li> <li>When a Student (who is paying for the session) enters the dashboard with an ongoing session, they see nothing</li> <li>Students are unaware they are being charged</li> </ul> <p>Expected Behavior:</p> <ul> <li>Students should see the same \"Active Session Detected\" warning modal as tutors</li> <li>Students should be able to \"End Session Now\" if they return to the app while a session is technically still active on the blockchain</li> </ul> <p>Steps to Reproduce:</p> <ol> <li>Start a session as a student</li> <li>Navigate away from the session (or return to dashboard)</li> <li>Observe: Student sees no warning, but is still being charged</li> <li>Compare with tutor view: Tutor sees red warning modal</li> </ol> <p>Video Timestamp: 0:00 - 1:05</p> <p>Technical Details:</p> <ul> <li>Need to locate the logic and UI component used for Tutor's \"Active Session Detected\" modal</li> <li>Port/replicate this logic to Student Dashboard</li> <li>Component likely: <code>ActiveSessionPrompt</code> or similar in tutor flow</li> </ul> <p>Fix Applied:</p> <ul> <li>Made storage reading reactive using <code>useState</code> and <code>useEffect</code> to detect when tutor address becomes available</li> <li>Added filtering to exclude invalid/zero session data from tutor queries</li> <li>Implemented fallback: when <code>isStudying</code> is true but tutor address is missing from storage, query <code>SessionStarted</code> events to find the tutor address</li> <li>Prioritized student session data over tutor session data</li> <li>Enhanced logging for better debugging</li> </ul> <p>Files Modified: - <code>webapp/packages/nextjs/components/session/ActiveSessionPrompt.tsx</code></p>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#bug-2-language-default-flicker-english-to-spanish-fixed","title":"Bug 2: Language Default \"Flicker\" (English to Spanish) \u2705 FIXED","text":"<p>Priority: \ud83d\udfe1 MEDIUM Status: \u2705 FIXED (2025-01-21)</p> <p>Location: Find Tutor component / \"Find Your Perfect Tutor\" screen</p> <p>Current Behavior:</p> <ul> <li>When student clicks \"Find a Tutor,\" the \"Target Language\" dropdown briefly shows \"English\" by default</li> <li>A split second later, it updates to the correct registered language (e.g., \"Spanish\") fetched from the smart contract/backend</li> <li>Creates jarring UI flicker and incorrect initial state</li> </ul> <p>Expected Behavior:</p> <ul> <li>Language dropdown should not show incorrect default</li> <li>Either show loading state or wait until registered language is fetched before rendering</li> <li>Component should mount with correct language immediately</li> </ul> <p>Steps to Reproduce:</p> <ol> <li>Click \"Find a Tutor\" as a student</li> <li>Observe \"Target Language\" field</li> <li>See it briefly shows \"English\" then snaps to correct language (e.g., \"Spanish\")</li> </ol> <p>Video Timestamp: 2:25 - 3:10</p> <p>Technical Details:</p> <ul> <li><code>targetLanguage</code> state likely initialized to 'English' hardcoded</li> <li>Fix: Change initial state to null or show loading skeleton</li> <li>Do not render language dropdown until <code>registeredLanguage</code> fetch is complete</li> <li>Alternatively: Ensure fetch happens earlier so component mounts with correct language</li> </ul> <p>Fix Applied:</p> <ul> <li>Changed <code>language</code> initial state from <code>\"en\"</code> to <code>null</code> to prevent showing incorrect default</li> <li>Changed <code>budgetPerHour</code> initial state from <code>\"10\"</code> to <code>null</code> for consistency</li> <li>Added conditional rendering: show loading skeleton until language data loads, then display actual language</li> <li>Added validation to prevent search until both language and budget are loaded from student profile</li> <li>Fixed all usages of <code>budgetPerHour</code> to handle null values gracefully</li> </ul> <p>Files Modified: - <code>webapp/packages/nextjs/components/student/StudentTutorFinder.tsx</code></p>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#agent-friendly-task-breakdown","title":"\ud83e\udd16 Agent-Friendly Task Breakdown","text":""},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#task-1-implement-active-session-warning-for-students","title":"Task 1: Implement \"Active Session\" Warning for Students","text":"<p>Priority: \ud83d\udd34 CRITICAL</p> <p>Problem: Students who are paying for sessions don't see any warning when they have an active session, unlike tutors who see a red modal. This means students are unaware they're being charged when they return to the dashboard.</p> <p>Current Behavior:</p> <ul> <li>Tutor dashboard shows red \"Active Session Detected\" modal when session is active</li> <li>Student dashboard shows nothing when session is active</li> <li>Students continue to be charged without warning</li> </ul> <p>Expected Behavior:</p> <ul> <li>Student dashboard should show the same \"Active Session Detected\" warning modal as tutor dashboard</li> <li>Students should be able to \"End Session Now\" from the warning</li> <li>Warning should appear when student navigates to dashboard with active session</li> </ul> <p>Implementation:</p> <ul> <li>Locate the component/logic used for tutor's active session warning (likely <code>ActiveSessionPrompt</code> or similar)</li> <li>Check if it's already checking for student sessions or only tutor sessions</li> <li>Ensure the component checks <code>activeSessions</code> mapping for both student and tutor addresses</li> <li>Verify the component is rendered in student dashboard/flow</li> <li>Test that warning appears when student has active session</li> </ul> <p>Files to Modify:</p> <ul> <li><code>webapp/packages/nextjs/components/session/ActiveSessionPrompt.tsx</code> (likely)</li> <li>Student dashboard component (need to locate)</li> <li>Check if component already exists but isn't being used for students</li> </ul> <p>Estimated Effort: Small-Medium (1-2 hours)</p>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#task-2-fix-language-default-flicker-english-to-spanish","title":"Task 2: Fix Language Default \"Flicker\" (English to Spanish)","text":"<p>Priority: \ud83d\udfe1 MEDIUM</p> <p>Problem: When student clicks \"Find a Tutor,\" the language dropdown briefly shows \"English\" as default before updating to the correct registered language, creating a jarring UI flicker.</p> <p>Current Behavior:</p> <ul> <li><code>targetLanguage</code> or <code>language</code> state initialized to \"English\" (hardcoded)</li> <li>Component renders with \"English\" before smart contract data loads</li> <li>After fetch completes, it updates to correct language (e.g., \"Spanish\")</li> <li>Creates visible flicker/jump in UI</li> </ul> <p>Expected Behavior:</p> <ul> <li>No incorrect default shown</li> <li>Either show loading state or wait for data before rendering language field</li> <li>Component should mount with correct language from the start</li> </ul> <p>Implementation:</p> <ul> <li>Find where language state is initialized in <code>StudentTutorFinder</code> or similar component</li> <li>Change initial state from hardcoded \"English\" to <code>null</code> or loading state</li> <li>Add conditional rendering: only show language dropdown when data is loaded</li> <li>Alternatively: Ensure <code>useEffect</code> that fetches student info runs before component renders language field</li> <li>Consider using loading skeleton or placeholder until language is determined</li> </ul> <p>Files to Modify:</p> <ul> <li><code>webapp/packages/nextjs/components/student/StudentTutorFinder.tsx</code> (likely)</li> <li>Check <code>useState</code> initialization for language</li> <li>Check <code>useEffect</code> that pre-fills language from <code>studentInfo</code></li> </ul> <p>Estimated Effort: Small (30 minutes - 1 hour)</p>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#completion-status","title":"\u2705 Completion Status","text":"<ul> <li> Bug 1 / Task 1 - Implement \"Active Session\" Warning for Students - \u2705 FIXED</li> <li> Bug 2 / Task 2 - Fix Language Default \"Flicker\" - \u2705 FIXED</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#notes","title":"\ud83d\udcdd Notes","text":"<ul> <li>Both issues are UX-focused and affect user experience</li> <li>Task 1 is critical as it affects billing/charging awareness</li> <li>Task 2 is medium priority but creates poor first impression</li> <li>Both should be relatively straightforward fixes</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-21-student-session-warning-and-language-flicker/#related-issues","title":"\ud83d\udd17 Related Issues","text":"<ul> <li>Previous bug report: <code>bug-report-2025-01-18-tutor-student-ux-issues.md</code> (also dealt with student-tutor flow UX)</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/","title":"Bug Report - Authentication Routing and UI Issues","text":"<p>Date: 2025-01-22 Session: Wave 3 UX Testing Source: Video analysis via Google AI Studio Status: \ud83d\udd34 TODO</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#summary","title":"\ud83d\udccb Summary","text":"<p>Project: LangDAO Scope: Authentication Routing, Dashboard UI, and Error Handling Context: Wave 3 UX Testing session involving Student and Tutor dashboards. Issues identified during dashboard reloads, budget display, error handling, and button interactions.</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#video-analysis","title":"\ud83c\udfa5 Video Analysis","text":"<p>Video Timestamps: - 0:15 - 1:00: Authentication/Route flicker on dashboard reload - 3:30: $0.00/hr budget display issue in \"You're Live!\" card - 4:10: Language code display (already fixed in previous bug report) - 4:40: Generic error message when user rejects MetaMask transaction</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#bugs-identified","title":"\ud83d\udc1b Bugs Identified","text":""},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#bug-1-authenticationroute-flicker","title":"Bug 1: Authentication/Route \"Flicker\"","text":"<p>Priority: \ud83d\udd34 CRITICAL Status: \ud83d\udd34 TODO (Partial fix attempted - student flicker improved but still present, tutor flicker still quite bad)</p> <p>Location: Main App router, AuthProvider, or root index page</p> <p>Current Behavior: - When reloading the dashboard (Student or Tutor), the app rapidly cycles through multiple views - Sequence: Landing Page \u2192 Checking Status \u2192 Loading \u2192 Dashboard - Creates disorienting \"flicker\" effect - User sees intermediate states before final dashboard loads</p> <p>Expected Behavior: - Show a steady loading state during authentication check - Do not render any route content (especially Landing Page) until authentication check is complete - Display simple white screen or spinner during check to prevent UI flash</p> <p>Steps to Reproduce: 1. Navigate to Student or Tutor dashboard 2. Reload the page (Cmd+R / Ctrl+R) 3. Observe: Rapid flickering through multiple views before dashboard appears</p> <p>Video Timestamp: 0:15 - 1:00</p> <p>Technical Details: - Check main App router logic - Check AuthProvider or authentication guard - Check root index page (<code>app/page.tsx</code>) - Implement global <code>isLoading</code> or <code>isCheckingAuth</code> state - Prevent rendering route content until auth check completes</p> <p>Partial Fix Attempted: - Created <code>AuthGuard</code> component that prevents rendering until authentication state is determined - Wrapped <code>/tutor</code> and <code>/find-tutor</code> routes with <code>AuthGuard</code> - Student flicker improved but still present - Tutor flicker still quite bad - needs further investigation - May need to check OnboardingFlow registration checks or other async operations causing flicker</p> <p>Files Modified: - <code>webapp/packages/nextjs/components/auth/AuthGuard.tsx</code> (new file) - <code>webapp/packages/nextjs/app/tutor/page.tsx</code> - <code>webapp/packages/nextjs/app/find-tutor/page.tsx</code></p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#bug-2-000hr-budget-display-fixed","title":"Bug 2: \"$0.00/hr\" Budget Display \u2705 FIXED","text":"<p>Priority: \ud83d\udfe1 MEDIUM Status: \u2705 FIXED (2025-01-22)</p> <p>Location: TutorLiveDashboard or \"You're Live!\" component</p> <p>Current Behavior: - In the \"You're Live!\" card, under the stats section - Budget display reads \"$0.00/hr\" even though session rate is set to $1.00/hr - Incorrect calculation or prop passing for hourly rate</p> <p>Expected Behavior: - Display the actual active session rate (e.g., \"$1.00/hr\") - Correctly calculate or inherit the session rate from active session data</p> <p>Steps to Reproduce: 1. Navigate to Tutor dashboard 2. Go live and start a session 3. Check the \"You're Live!\" card stats section 4. Observe: Budget shows \"$0.00/hr\" instead of actual rate</p> <p>Video Timestamp: 3:30</p> <p>Technical Details: - Check TutorLiveDashboard or \"You're Live!\" component - Trace <code>budget</code> or <code>hourlyRate</code> prop being passed - Verify calculation logic for hourly rate from session data - Ensure it uses actual active session rate instead of defaulting to zero</p> <p>Fix Applied: - Updated rate calculation to prioritize active session rate over tutor rate - If active session exists, use <code>ratePerSecond</code> from <code>activeSessionData</code> - Otherwise, use <code>tutorRate</code> from contract query - Added loading state check - shows \"...\" instead of \"$0.00\" while rate is loading - Added <code>enabled</code> condition to <code>getTutorRate</code> query to only run when account and language are available - Prevents showing $0.00/hr when rate is actually set but still loading</p> <p>Files Modified: - <code>webapp/packages/nextjs/components/tutor/TutorAvailabilityFlow.tsx</code></p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#bug-3-generic-wallet-rejection-error-handling","title":"Bug 3: Generic Wallet Rejection Error Handling","text":"<p>Priority: \ud83d\udfe1 MEDIUM</p> <p>Location: <code>handleStartSession</code> or transaction submission logic in Student dashboard</p> <p>Current Behavior: - When user rejects MetaMask transaction, app shows generic error - Error message: \"Failed to start session. Please try again.\" - Does not distinguish between user rejection and actual failure</p> <p>Expected Behavior: - Catch specific error code from wallet provider (error code 4001 for User Rejected) - Display specific, neutral message: \"Transaction cancelled by user\" - Only show generic failure error for actual transaction failures</p> <p>Steps to Reproduce: 1. Navigate to Student dashboard 2. Click \"Find a Tutor\" and accept a tutor 3. When MetaMask popup appears, click \"Reject\" 4. Observe: Generic error message appears</p> <p>Video Timestamp: 4:40</p> <p>Technical Details: - Check <code>handleStartSession</code> function in Student dashboard - Check transaction submission logic - Add error code detection (4001 = User Rejected) - Implement conditional error messages based on error type</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#bug-4-missing-loading-state-on-find-tutor-button","title":"Bug 4: Missing Loading State on \"Find Tutor\" Button","text":"<p>Priority: \ud83d\udfe1 MEDIUM</p> <p>Location: StudentDashboard or FindTutorButton component</p> <p>Current Behavior: - Clicking \"Find a Tutor\" causes UI to hang for a few seconds - No visual feedback during the process - Button appears unresponsive while logic runs in background - User may click multiple times thinking it didn't work</p> <p>Expected Behavior: - Add immediate <code>isLoading</code> state to button onClick - Show spinner or disable button immediately - Provide visual feedback that process has started - Prevent multiple clicks while fetching available tutors</p> <p>Steps to Reproduce: 1. Navigate to Student dashboard 2. Click \"Find a Tutor\" button 3. Observe: No visual feedback for 2-3 seconds before navigation</p> <p>Video Timestamp: Not specified (mentioned in task description)</p> <p>Technical Details: - Check StudentDashboard component - Check FindTutorButton component - Add loading state management - Disable button and show spinner during tutor fetch/navigation</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#agent-friendly-task-breakdown","title":"\ud83e\udd16 Agent-Friendly Task Breakdown","text":""},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#task-1-fix-authenticationroute-flicker","title":"Task 1: Fix Authentication/Route \"Flicker\"","text":"<p>Priority: \ud83d\udd34 CRITICAL</p> <p>Problem: When reloading the dashboard (Student or Tutor), the app rapidly cycles through multiple views (Landing Page \u2192 Checking Status \u2192 Loading \u2192 Dashboard) instead of showing a steady loading state. This causes a disorienting \"flicker.\"</p> <p>Current Behavior: - App renders Landing Page before authentication check completes - Multiple intermediate states flash in sequence - Creates jarring user experience</p> <p>Expected Behavior: - Implement global <code>isLoading</code> or <code>isCheckingAuth</code> state in routing logic - Do not render any route content (especially Landing Page) until authentication check is strictly complete - Show simple white screen or spinner during check to prevent UI flash</p> <p>Implementation: - Locate main App router, AuthProvider, or root index page - Add global loading state that prevents rendering until auth check completes - Ensure authentication check happens before any route content renders - Show loading indicator during check</p> <p>Files to Modify: - <code>webapp/packages/nextjs/app/page.tsx</code> (root page) - Authentication guard component (if separate) - Main app router/layout</p> <p>Estimated Effort: Medium (1-2 hours)</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#task-2-fix-000hr-budget-display","title":"Task 2: Fix \"$0.00/hr\" Budget Display","text":"<p>Priority: \ud83d\udfe1 MEDIUM</p> <p>Problem: In the \"You're Live!\" card, under the stats section, the budget display reads \"$0.00/hr\" even though the session rate is set to $1.00/hr.</p> <p>Current Behavior: - Budget display shows \"$0.00/hr\" instead of actual rate - Calculation or prop passing is incorrect</p> <p>Expected Behavior: - Display actual active session rate (e.g., \"$1.00/hr\") - Correctly calculate or inherit session rate from active session data</p> <p>Implementation: - Locate TutorLiveDashboard or \"You're Live!\" component - Trace <code>budget</code> or <code>hourlyRate</code> prop being passed - Verify calculation logic for hourly rate from session data - Ensure it uses actual active session rate instead of defaulting to zero</p> <p>Files to Modify: - TutorLiveDashboard component (need to locate) - \"You're Live!\" component (check TutorAvailabilityFlow or similar) - Session rate calculation logic</p> <p>Estimated Effort: Small (30 minutes - 1 hour)</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#task-3-improve-wallet-rejection-error-handling","title":"Task 3: Improve Wallet Rejection Error Handling","text":"<p>Priority: \ud83d\udfe1 MEDIUM</p> <p>Problem: When a user rejects the MetaMask transaction, the app shows a generic error: \"Failed to start session. Please try again.\" This doesn't distinguish between user rejection and actual failure.</p> <p>Current Behavior: - Generic error message for all transaction failures - No distinction between user rejection and actual failure</p> <p>Expected Behavior: - Catch specific error code from wallet provider (error code 4001 for User Rejected) - Display specific, neutral message: \"Transaction cancelled by user\" - Only show generic failure error for actual transaction failures</p> <p>Implementation: - Locate <code>handleStartSession</code> or transaction submission logic in Student dashboard - Add error code detection (4001 = User Rejected) - Implement conditional error messages based on error type - Update error handling to be more user-friendly</p> <p>Files to Modify: - Student dashboard component (StudentTutorFinder or similar) - Transaction submission logic - Error handling utilities</p> <p>Estimated Effort: Small (30 minutes - 1 hour)</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#task-4-add-loading-state-to-find-tutor-button","title":"Task 4: Add Loading State to \"Find Tutor\" Button","text":"<p>Priority: \ud83d\udfe1 MEDIUM</p> <p>Problem: Clicking \"Find a Tutor\" causes the UI to hang for a few seconds with no visual feedback before navigating.</p> <p>Current Behavior: - Button click provides no immediate feedback - UI appears unresponsive during tutor fetch/navigation - User may click multiple times</p> <p>Expected Behavior: - Add immediate <code>isLoading</code> state to button onClick - Show spinner or disable button immediately - Provide visual feedback that process has started - Prevent multiple clicks while fetching available tutors</p> <p>Implementation: - Locate StudentDashboard or FindTutorButton component - Add loading state management - Disable button and show spinner during tutor fetch/navigation - Ensure loading state is set immediately on click</p> <p>Files to Modify: - StudentDashboard component - FindTutorButton component (if separate) - Navigation/tutor fetch logic</p> <p>Estimated Effort: Small (15-30 minutes)</p>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#completion-status","title":"\u2705 Completion Status","text":"<ul> <li> Bug 1 / Task 1 - Fix Authentication/Route \"Flicker\" - \ud83d\udd34 TODO (Partial fix - needs more work)</li> <li> Bug 2 / Task 2 - Fix \"$0.00/hr\" Budget Display - \u2705 FIXED</li> <li> Bug 3 / Task 3 - Improve Wallet Rejection Error Handling - \ud83d\udfe1 TODO</li> <li> Bug 4 / Task 4 - Add Loading State to \"Find Tutor\" Button - \ud83d\udfe1 TODO</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#notes","title":"\ud83d\udcdd Notes","text":"<ul> <li>All issues identified during Wave 3 UX Testing session</li> <li>Bug 1 (Flicker) is similar to Bug 3 from previous report but focuses specifically on authentication routing</li> <li>Bug 2 may be related to session rate calculation or prop passing</li> <li>Bug 3 improves user experience by providing clearer error feedback</li> <li>Bug 4 is a UX polish issue to improve perceived responsiveness</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-22-authentication-routing-and-ui-issues/#related-issues","title":"\ud83d\udd17 Related Issues","text":"<ul> <li>Related to: <code>bug-report-2025-01-22-ux-polish-and-navigation-issues.md</code> (Bug 3: Root Route \"Flicker\" - already fixed, but this is a different aspect)</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/","title":"Bug Report - UX Polish &amp; Navigation Issues","text":"<p>Date: 2025-01-22 Session: User Acceptance Testing (Wave 3) Source: Video analysis via Google AI Studio Status: \ud83d\udd34 TODO</p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#summary","title":"\ud83d\udccb Summary","text":"<p>Project: LangDAO Scope: Student/Tutor connection flow, Routing, and Notifications Context: User Acceptance Testing identified 4 distinct issues ranging from critical navigation failures to UI polish problems affecting the overall user experience.</p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#video-analysis","title":"\ud83c\udfa5 Video Analysis","text":"<p>Video Timestamps: - 0:15 - 0:35: Ghost Toast Notification - Student sees irrelevant \"Global Tutor removed\" message - 1:05 - 1:30: Broken \"Get Started\" Button - Tutor onboarding button doesn't navigate - 1:58 - 2:40: Root Route Flicker - Landing page flashes before redirect - 4:10 - 4:20: Language Code Display - Shows \"es\" instead of \"Spanish\"</p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#bugs-identified","title":"\ud83d\udc1b Bugs Identified","text":""},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#bug-1-ghost-toast-notification-global-tutor-removed-fixed","title":"Bug 1: Ghost Toast Notification (\"Global Tutor Removed\") \u2705 FIXED","text":"<p>Priority: \ud83d\udfe1 MEDIUM Status: \u2705 FIXED (2025-01-22)</p> <p>Location: StudentDashboard and global SocketProvider (WebSocket event handlers)</p> <p>Current Behavior: - When a Student navigates away from their dashboard or refreshes, a toast notification appears saying \"Global Tutor removed.\" - This message is irrelevant to the student and confusing - The notification appears on the student's own screen erroneously</p> <p>Expected Behavior: - Connection/disconnection toasts should be context-aware - \"Tutor removed\" notification should only show if a partner disconnects during an active session - If the current user is navigating, suppress the notification</p> <p>Steps to Reproduce: 1. Navigate to Student Dashboard 2. Navigate away or refresh the page 3. Observe: \"Global Tutor removed\" toast appears incorrectly</p> <p>Video Timestamp: 0:15 - 0:35</p> <p>Technical Details: - Check WebSocket disconnection or component unmount logic - Investigate where the \"Global Tutor removed\" toast is triggered - Ensure toasts are context-aware based on user role and session state</p> <p>Fix Applied: - Removed global debug toasts for <code>tutor:available-updated</code> and <code>tutor:became-unavailable</code> events in SocketProvider - These toasts were showing irrelevant \"Global Tutor removed\" messages to all users (including students) - Components (TutorAvailabilityFlow, StudentTutorFinder) already handle these events contextually where appropriate - Students no longer see confusing tutor-related notifications when navigating away or refreshing</p> <p>Files Modified: - <code>webapp/packages/nextjs/lib/socket/socketContext.tsx</code></p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#bug-2-broken-get-started-button-tutor-onboarding-fixed","title":"Bug 2: Broken \"Get Started\" Button (Tutor Onboarding) \u2705 FIXED","text":"<p>Priority: \ud83d\udd34 CRITICAL Status: \u2705 FIXED (2025-01-22)</p> <p>Location: Welcome or Onboarding component (page with green \"Get Started\" button)</p> <p>Current Behavior: - Clicking \"Get Started\" logs \"Onboarding completed\" in the console - UI does nothing - user is stuck on the same page - No navigation occurs after button click</p> <p>Expected Behavior: - After clicking \"Get Started\", user should be redirected to tutor dashboard - Navigation should occur (e.g., <code>router.push('/tutor/dashboard')</code> or update local state)</p> <p>Steps to Reproduce: 1. Navigate to Tutor onboarding/welcome page 2. Click the green \"Get Started\" button 3. Observe: Console logs success but page doesn't change</p> <p>Video Timestamp: 1:05 - 1:30</p> <p>Technical Details: - Check the <code>handleGetStarted</code> function - Missing navigation logic after console log - Should redirect to <code>/tutor/dashboard</code> or show dashboard state</p> <p>Fix Applied: - Added Next.js router navigation to \"Get Started\" button in OnboardingFlow - Tutors are now redirected to <code>/tutor</code> route (TutorAvailabilityFlow) - Students are redirected to <code>/find-tutor</code> route - Added fallback logic to determine role from registration status if selectedRole is not set - Button now properly navigates users after onboarding completion</p> <p>Files Modified: - <code>webapp/packages/nextjs/components/onboarding/OnboardingFlow.tsx</code></p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#bug-3-root-route-flicker-fouc-flash-of-unstyled-content-fixed","title":"Bug 3: Root Route \"Flicker\" (FOUC - Flash of Unstyled Content) \u2705 FIXED","text":"<p>Priority: \ud83d\udfe1 MEDIUM Status: \u2705 FIXED (2025-01-22)</p> <p>Location: Root page <code>index.tsx/jsx</code> or main App router/Authentication Guard</p> <p>Current Behavior: - When navigating to root (<code>/</code>), the app rapidly flashes through multiple views:   - Landing Page \u2192 Status Check \u2192 Dashboard - Creates jarring user experience - App is checking auth status/roles sequentially and rendering intermediate states</p> <p>Expected Behavior: - Implement a \"Loading\" or \"SplashScreen\" state - Do not render any content (Landing page or Dashboard) until authentication and role checks are fully resolved - Show loading indicator during auth/role resolution</p> <p>Steps to Reproduce: 1. Navigate to <code>localhost:3000</code> (root route) 2. Observe: Rapid flickering through Landing Page \u2192 Status Check \u2192 Dashboard</p> <p>Video Timestamp: 1:58 - 2:40</p> <p>Technical Details: - Check authentication guard logic - Check role checking sequence - Implement loading state that prevents rendering until all checks complete</p> <p>Fix Applied: - Added loading state (<code>isInitializing</code>) to <code>HomeContent</code> component - Shows a loading screen with \"Checking your connection...\" message during initialization - Waits up to 150ms for account state to settle before rendering content - If account state is determined earlier, shows content immediately (responsive) - Prevents flicker by not showing landing page before account check completes - Smooth transition to either landing page (no account) or dashboard (account connected)</p> <p>Files Modified: - <code>webapp/packages/nextjs/app/page.tsx</code></p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#bug-4-language-code-display-iso-code-instead-of-name-fixed","title":"Bug 4: Language Code Display (ISO Code Instead of Name) \u2705 FIXED","text":"<p>Priority: \ud83d\udfe2 LOW Status: \u2705 FIXED (2025-01-22)</p> <p>Location: \"Request Accepted\" or \"Session Details\" component (where it lists \"Language vs Budget\")</p> <p>Current Behavior: - UI displays the raw ISO code (e.g., \"Language: es\") instead of human-readable name - Creates confusion for users who don't know language codes</p> <p>Expected Behavior: - Display human-readable language name (e.g., \"Spanish\" instead of \"es\") - Use proper language name mapping</p> <p>Fix Applied: - Updated all language code displays to use human-readable names from LANGUAGES constant - Fixed \"Request Accepted\" screen in TutorAvailabilityFlow to show language name instead of code - Fixed toast notifications in TutorSocketEvents to show language names - Fixed notification messages in SocketNotifications to show language names - All displays now use <code>LANGUAGES.find(l =&gt; l.code === languageCode)?.name || languageCode</code> pattern - Falls back to code if language not found in mapping</p> <p>Files Modified: - <code>webapp/packages/nextjs/components/tutor/TutorAvailabilityFlow.tsx</code> - <code>webapp/packages/nextjs/components/socket/TutorSocketEvents.tsx</code> - <code>webapp/packages/nextjs/components/socket/SocketNotifications.tsx</code></p> <p>Steps to Reproduce: 1. Accept a tutor request or view session details 2. Observe: Language field shows \"es\" instead of \"Spanish\"</p> <p>Video Timestamp: 4:10 - 4:20</p> <p>Technical Details: - Create or use a utility function to map language codes to names - Implementation: Use <code>new Intl.DisplayNames(['en'], { type: 'language' }).of('es')</code> or a lookup object - Render \"Spanish\" instead of \"es\"</p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#agent-friendly-task-breakdown","title":"\ud83e\udd16 Agent-Friendly Task Breakdown","text":""},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#task-1-fix-ghost-toast-notification-global-tutor-removed","title":"Task 1: Fix Ghost Toast Notification (\"Global Tutor Removed\")","text":"<p>Priority: \ud83d\udfe1 MEDIUM</p> <p>Problem: Students see irrelevant \"Global Tutor removed\" toast notifications when navigating away or refreshing their dashboard. This is confusing and creates a poor user experience.</p> <p>Current Behavior: - Toast appears when student navigates away or refreshes - Message is irrelevant to student context - Notification appears on student's own screen erroneously</p> <p>Expected Behavior: - Toast should only appear if a tutor disconnects during an active session - Suppress notification when current user is navigating - Make toasts context-aware based on user role and session state</p> <p>Implementation: - Locate where \"Global Tutor removed\" toast is triggered (likely in SocketProvider or WebSocket event handlers) - Add context check: only show if user is in active session and partner disconnects - Suppress notification on component unmount or navigation - Check if notification is meant for tutors only</p> <p>Files to Modify: - <code>webapp/packages/nextjs/lib/socket/socketContext.tsx</code> (likely) - <code>webapp/packages/nextjs/components/dashboard/StudentDashboard.tsx</code> (check for toast handlers) - Any WebSocket event handlers that emit tutor-related notifications</p> <p>Estimated Effort: Small (30 minutes - 1 hour)</p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#task-2-fix-broken-get-started-button-tutor-onboarding","title":"Task 2: Fix Broken \"Get Started\" Button (Tutor Onboarding)","text":"<p>Priority: \ud83d\udd34 CRITICAL</p> <p>Problem: The \"Get Started\" button on the tutor onboarding/welcome page logs success but doesn't navigate, leaving users stuck.</p> <p>Current Behavior: - Button click logs \"Onboarding completed\" to console - No UI change occurs - User remains on same page</p> <p>Expected Behavior: - After clicking \"Get Started\", redirect to tutor dashboard - Navigation should occur via router or state update</p> <p>Implementation: - Locate the Welcome/Onboarding component with green \"Get Started\" button - Find <code>handleGetStarted</code> function - Add navigation logic after console log:   - Use <code>router.push('/tutor/dashboard')</code> or similar   - Or update local state to show dashboard view - Test that navigation works correctly</p> <p>Files to Modify: - Welcome/Onboarding component (need to locate - check <code>webapp/packages/nextjs/components/onboarding/</code> or similar) - Check for <code>handleGetStarted</code> function</p> <p>Estimated Effort: Small (15-30 minutes)</p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#task-3-fix-root-route-flicker-fouc","title":"Task 3: Fix Root Route \"Flicker\" (FOUC)","text":"<p>Priority: \ud83d\udfe1 MEDIUM</p> <p>Problem: Navigating to root route (<code>/</code>) causes rapid flickering through multiple views (Landing Page \u2192 Status Check \u2192 Dashboard) as auth/role checks resolve sequentially.</p> <p>Current Behavior: - App renders intermediate states during auth/role checks - Creates jarring flicker effect - Multiple views flash in sequence</p> <p>Expected Behavior: - Show loading/splash screen during auth/role resolution - Don't render any content until all checks complete - Smooth transition to final view</p> <p>Implementation: - Locate root page (<code>index.tsx</code> or main router) - Find authentication guard and role checking logic - Add loading state that prevents rendering until:   - Authentication status is resolved   - User role is determined   - All checks are complete - Show loading indicator/splash screen during this time - Only render Landing Page or Dashboard after all checks complete</p> <p>Files to Modify: - <code>webapp/packages/nextjs/app/page.tsx</code> (root page) - Authentication guard component (if separate) - Main app router/layout</p> <p>Estimated Effort: Medium (1-2 hours)</p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#task-4-map-language-codes-to-names","title":"Task 4: Map Language Codes to Names","text":"<p>Priority: \ud83d\udfe2 LOW</p> <p>Problem: UI displays raw ISO language codes (e.g., \"es\") instead of human-readable names (e.g., \"Spanish\") in session details.</p> <p>Current Behavior: - Language field shows \"Language: es\" - Users see ISO codes instead of readable names</p> <p>Expected Behavior: - Display \"Language: Spanish\" instead of \"Language: es\" - Use proper language name mapping</p> <p>Implementation: - Locate \"Request Accepted\" or \"Session Details\" component - Find where language code is displayed - Create utility function to map codes to names:   - Option 1: Use <code>new Intl.DisplayNames(['en'], { type: 'language' }).of('es')</code>   - Option 2: Create lookup object mapping codes to names - Replace code display with mapped name - Consider using existing LANGUAGES constant if available</p> <p>Files to Modify: - \"Request Accepted\" component (need to locate) - \"Session Details\" component (need to locate) - Create or update language utility function - Check <code>webapp/packages/nextjs/lib/constants/contracts.ts</code> for existing LANGUAGES constant</p> <p>Estimated Effort: Small (30 minutes - 1 hour)</p>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#completion-status","title":"\u2705 Completion Status","text":"<ul> <li> Bug 1 / Task 1 - Fix Ghost Toast Notification - \u2705 FIXED</li> <li> Bug 2 / Task 2 - Fix Broken \"Get Started\" Button - \u2705 FIXED</li> <li> Bug 3 / Task 3 - Fix Root Route \"Flicker\" - \u2705 FIXED</li> <li> Bug 4 / Task 4 - Map Language Codes to Names - \u2705 FIXED</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#notes","title":"\ud83d\udcdd Notes","text":"<ul> <li>All issues identified during User Acceptance Testing (Wave 3)</li> <li>Task 2 (Broken Button) is critical as it blocks tutor onboarding flow</li> <li>Task 3 (Flicker) affects first impression and perceived app quality</li> <li>Task 4 is low priority but improves UX polish</li> </ul>"},{"location":"bug-reports/bug-report-2025-01-22-ux-polish-and-navigation-issues/#related-issues","title":"\ud83d\udd17 Related Issues","text":"<ul> <li>Previous bug report: <code>bug-report-2025-01-21-student-session-warning-and-language-flicker.md</code> (also dealt with language display issues)</li> </ul>"},{"location":"bug-reports/bug-report-template/","title":"Bug Report - [Brief Description]","text":"<p>Date: YYYY-MM-DD Session: [Session number or identifier] Source: Video analysis via Google AI Studio Status: \ud83d\udd34 TODO | \ud83d\udfe1 IN_PROGRESS | \u2705 COMPLETED</p>"},{"location":"bug-reports/bug-report-template/#summary","title":"\ud83d\udccb Summary","text":"<p>Project: LangDAO Scope: [e.g., Tutor Dashboard, Student Flow, WebRTC, etc.] Context: [Brief description of the flow/feature where bugs occur]</p>"},{"location":"bug-reports/bug-report-template/#video-analysis","title":"\ud83c\udfa5 Video Analysis","text":"<p>Video Timestamp/Description: [If available from AI Studio analysis]</p>"},{"location":"bug-reports/bug-report-template/#bugs-identified","title":"\ud83d\udc1b Bugs Identified","text":""},{"location":"bug-reports/bug-report-template/#bug-1-short-title","title":"Bug 1: [Short Title]","text":"<p>Priority: \ud83d\udd34 CRITICAL | \ud83d\udfe1 MEDIUM | \ud83d\udfe2 LOW</p> <p>Location: [Component/File path if known]</p> <p>Current Behavior: - [Describe what currently happens]</p> <p>Expected Behavior: - [Describe what should happen]</p> <p>Steps to Reproduce: 1. [Step 1] 2. [Step 2] 3. [Step 3]</p> <p>Video Timestamp: [If available]</p> <p>Technical Details: - [Any technical context, file paths, function names, etc.]</p>"},{"location":"bug-reports/bug-report-template/#bug-2-short-title","title":"Bug 2: [Short Title]","text":"<p>[Repeat structure above]</p>"},{"location":"bug-reports/bug-report-template/#agent-friendly-task-breakdown","title":"\ud83e\udd16 Agent-Friendly Task Breakdown","text":""},{"location":"bug-reports/bug-report-template/#task-1-task-title","title":"Task 1: [Task Title]","text":"<p>Priority: \ud83d\udd34 CRITICAL | \ud83d\udfe1 MEDIUM | \ud83d\udfe2 LOW</p> <p>Problem: [Detailed problem description]</p> <p>Current Behavior: - [Specific current behavior]</p> <p>Expected Behavior: - [Specific expected behavior]</p> <p>Implementation: - [Implementation steps or approach]</p> <p>Files to Modify: - [File paths]</p> <p>Estimated Effort: [Small/Medium/Large] ([X hours/days])</p>"},{"location":"bug-reports/bug-report-template/#task-2-task-title","title":"Task 2: [Task Title]","text":"<p>[Repeat structure above]</p>"},{"location":"bug-reports/bug-report-template/#completion-status","title":"\u2705 Completion Status","text":"<ul> <li> Bug 1 / Task 1 - [Status]</li> <li> Bug 2 / Task 2 - [Status]</li> <li> Bug 3 / Task 3 - [Status]</li> </ul>"},{"location":"bug-reports/bug-report-template/#notes","title":"\ud83d\udcdd Notes","text":"<p>[Any additional notes, observations, or follow-up items]</p>"},{"location":"bug-reports/bug-report-template/#related-issues","title":"\ud83d\udd17 Related Issues","text":"<ul> <li>[Link to related bug reports or tasks]</li> </ul>"},{"location":"guides/ai-teaching-materials/","title":"AI Teaching Material Preparation","text":""},{"location":"guides/ai-teaching-materials/#overview","title":"Overview","text":"<p>The AI Teaching Material Preparation feature allows tutors to generate customized lesson plans using Google's Gemini AI. Tutors can specify the teaching language, student proficiency level, lesson focus, and session duration to receive tailored teaching materials.</p>"},{"location":"guides/ai-teaching-materials/#features","title":"Features","text":"<ul> <li>AI-Powered Generation: Uses Gemini API to create structured lesson plans</li> <li>Customizable Parameters: </li> <li>Teaching language</li> <li>Proficiency level (Beginner, Intermediate, Advanced)</li> <li>Lesson focus (Conversational, Informational, Daily Life, Grammar, Vocabulary, Pronunciation)</li> <li>Session duration (15, 30, 45, 60, 90 minutes)</li> <li>Export Options: Download materials as PDF or Markdown</li> <li>Ephemeral Content: Materials are not stored in the database for privacy</li> <li>Tutor-Only Access: Only registered tutors can access this feature</li> </ul>"},{"location":"guides/ai-teaching-materials/#setup","title":"Setup","text":""},{"location":"guides/ai-teaching-materials/#backend-configuration","title":"Backend Configuration","text":"<ol> <li>Add your Gemini API key to <code>backend/.env</code>:</li> </ol> <pre><code>GEMINI_API_KEY=your_api_key_here\nGEMINI_MODEL=model_name\n</code></pre> <ol> <li>The backend endpoint is automatically registered at <code>/api/materials/generate</code></li> </ol>"},{"location":"guides/ai-teaching-materials/#frontend-configuration","title":"Frontend Configuration","text":"<p>The frontend automatically connects to the backend using the <code>NEXT_PUBLIC_SOCKET_URL</code> environment variable.</p>"},{"location":"guides/ai-teaching-materials/#usage","title":"Usage","text":""},{"location":"guides/ai-teaching-materials/#for-tutors","title":"For Tutors","text":"<ol> <li>Navigate to your tutor dashboard</li> <li>Click on \"Prepare Material with AI\"</li> <li>Fill in the form:</li> <li>Select the teaching language</li> <li>Choose student proficiency level</li> <li>Select lesson focus</li> <li>Pick session duration</li> <li>Click \"Generate Materials\"</li> <li>Review the generated lesson plan</li> <li>Export as PDF or Markdown if desired</li> <li>Click \"Regenerate\" to create new materials with different parameters</li> </ol>"},{"location":"guides/ai-teaching-materials/#api-endpoint","title":"API Endpoint","text":"<p>POST <code>/api/materials/generate</code></p> <p>Request Body: <pre><code>{\n  \"language\": \"Spanish\",\n  \"proficiencyLevel\": \"Intermediate\",\n  \"lessonFocus\": \"Conversational\",\n  \"sessionDuration\": 60\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"content\": \"# Lesson Plan\\n\\n## Learning Objectives...\",\n  \"generatedAt\": \"2024-01-15T10:30:00.000Z\"\n}\n</code></pre></p> <p>Error Responses: - <code>400</code>: Validation error (missing or invalid parameters) - <code>429</code>: Rate limit exceeded - <code>500</code>: Configuration error or API unavailable - <code>503</code>: AI service temporarily unavailable</p>"},{"location":"guides/ai-teaching-materials/#architecture","title":"Architecture","text":""},{"location":"guides/ai-teaching-materials/#backend-backendsrcroutesmaterialsjs","title":"Backend (<code>backend/src/routes/materials.js</code>)","text":"<ul> <li>Validates input parameters</li> <li>Constructs system prompt for Gemini API</li> <li>Makes HTTP request to Gemini API</li> <li>Returns generated content</li> <li>Handles errors appropriately</li> </ul>"},{"location":"guides/ai-teaching-materials/#frontend-components","title":"Frontend Components","text":"<p><code>/app/prepare-materials/page.tsx</code> - Main page with route protection - Manages state for generation and display - Handles API calls and error states</p> <p><code>/components/materials/MaterialForm.tsx</code> - Form with dropdowns for all parameters - Client-side validation - Loading states during generation</p> <p><code>/components/materials/MaterialDisplay.tsx</code> - Displays generated content with formatting - Provides export buttons - Allows regeneration</p> <p><code>/utils/exportMaterials.ts</code> - PDF export using jsPDF - Markdown export with metadata - Filename generation</p>"},{"location":"guides/ai-teaching-materials/#security","title":"Security","text":"<ul> <li>API Key Protection: Gemini API key is stored only in backend environment variables</li> <li>Route Protection: Only registered tutors can access the feature</li> <li>Rate Limiting: Backend applies global rate limiting (100 req/min)</li> <li>Input Validation: All parameters are validated before API calls</li> <li>No Persistence: Generated materials are not stored in any database</li> </ul>"},{"location":"guides/ai-teaching-materials/#error-handling","title":"Error Handling","text":"<p>The system provides specific error messages for different failure scenarios:</p> <ul> <li>AI service unavailable: Gemini API is down</li> <li>Configuration error: Invalid API key</li> <li>Rate limit exceeded: Too many requests</li> <li>Connection error: Network issues</li> <li>Validation errors: Missing or invalid parameters</li> </ul>"},{"location":"guides/ai-teaching-materials/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/ai-teaching-materials/#configuration-error-please-contact-support","title":"\"Configuration error, please contact support\"","text":"<ul> <li>Check that <code>GEMINI_API_KEY</code> is set in <code>backend/.env</code></li> <li>Verify the API key is valid</li> </ul>"},{"location":"guides/ai-teaching-materials/#ai-service-temporarily-unavailable","title":"\"AI service temporarily unavailable\"","text":"<ul> <li>Gemini API may be experiencing issues</li> <li>Try again in a few minutes</li> </ul>"},{"location":"guides/ai-teaching-materials/#too-many-requests","title":"\"Too many requests\"","text":"<ul> <li>Wait a few minutes before trying again</li> <li>Rate limit is 10 requests per minute per user</li> </ul>"},{"location":"guides/ai-teaching-materials/#materials-not-generating","title":"Materials not generating","text":"<ul> <li>Check browser console for errors</li> <li>Verify backend is running on port 4000</li> <li>Check that <code>NEXT_PUBLIC_SOCKET_URL</code> is set correctly</li> </ul>"},{"location":"guides/ai-teaching-materials/#future-enhancements","title":"Future Enhancements","text":"<ul> <li>Save favorite lesson plans</li> <li>Share materials with other tutors</li> <li>Material templates library</li> <li>Multi-language UI support</li> <li>Collaborative editing</li> <li>Material rating system</li> </ul>"},{"location":"guides/ai-teaching-materials/#dependencies","title":"Dependencies","text":""},{"location":"guides/ai-teaching-materials/#backend","title":"Backend","text":"<ul> <li>No additional dependencies (uses native <code>fetch</code>)</li> </ul>"},{"location":"guides/ai-teaching-materials/#frontend","title":"Frontend","text":"<ul> <li><code>jspdf</code>: ^2.5.2 (PDF generation)</li> </ul>"},{"location":"guides/ai-teaching-materials/#testing","title":"Testing","text":"<p>To test the feature:</p> <ol> <li>Start the backend: <code>cd backend &amp;&amp; npm run dev</code></li> <li>Start the frontend: <code>cd webapp/packages/nextjs &amp;&amp; yarn dev</code></li> <li>Register as a tutor</li> <li>Navigate to <code>/prepare-materials</code></li> <li>Fill in the form and generate materials</li> <li>Test PDF and Markdown export</li> <li>Verify materials are not persisted after page refresh</li> </ol>"},{"location":"guides/language-matching-fix/","title":"Language Matching Issue &amp; Proper Fix","text":""},{"location":"guides/language-matching-fix/#current-problem","title":"Current Problem","text":"<p>There's a mismatch between: 1. Frontend Socket System: Uses lowercase language codes (<code>\"english\"</code>, <code>\"spanish\"</code>) 2. Smart Contract: Uses numeric language IDs (<code>1</code> = Spanish, <code>2</code> = French, etc.) 3. LANGUAGES Constant: Uses proper case names (<code>\"Spanish\"</code>, <code>\"French\"</code>)</p>"},{"location":"guides/language-matching-fix/#current-workaround","title":"Current Workaround","text":"<p>The code now uses the student's selected language from the frontend, which should match what the tutor offered (since the socket matching system already verified they match).</p> <pre><code>// Uses student's language selection\nconst languageObj = LANGUAGES.find(l =&gt; \n  l.code === language || \n  l.name.toLowerCase() === language.toLowerCase() ||\n  l.name === language\n);\nconst languageId = languageObj?.id || 1;\n</code></pre>"},{"location":"guides/language-matching-fix/#proper-fix-to-implement-later","title":"Proper Fix (To Implement Later)","text":""},{"location":"guides/language-matching-fix/#option-1-read-tutors-on-chain-languages-recommended","title":"Option 1: Read Tutor's On-Chain Languages (Recommended)","text":"<p>When to do this: - When you want to ensure the tutor actually registered for the language on-chain - When you want to support tutors teaching multiple languages</p> <p>Implementation:</p> <ol> <li>In TutorAvailabilityFlow.tsx, read the tutor's registered languages from the blockchain:</li> </ol> <pre><code>// Add these hooks\nconst { data: tutorInfo } = useScaffoldReadContract({\n  contractName: \"LangDAO\",\n  functionName: \"getTutorInfo\",\n  args: [account?.address],\n});\n\n// Check which languages the tutor offers (1-10)\nconst tutorLanguageChecks = LANGUAGES.map(lang =&gt; \n  useScaffoldReadContract({\n    contractName: \"LangDAO\",\n    functionName: \"getTutorLanguage\",\n    args: [account?.address, BigInt(lang.id)],\n  })\n);\n\n// Filter to only show languages the tutor registered for\nconst availableLanguages = LANGUAGES.filter((lang, index) =&gt; \n  tutorLanguageChecks[index].data === true\n);\n</code></pre> <ol> <li>Only allow tutor to select from their registered languages:</li> </ol> <pre><code>&lt;div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\"&gt;\n  {availableLanguages.map((lang) =&gt; (\n    &lt;button\n      key={lang.id}\n      onClick={() =&gt; setLanguage(lang.code)}\n      className={/* ... */}\n    &gt;\n      &lt;div className=\"text-2xl mb-1\"&gt;{lang.flag}&lt;/div&gt;\n      &lt;div className=\"text-sm font-medium\"&gt;{lang.name}&lt;/div&gt;\n    &lt;/button&gt;\n  ))}\n&lt;/div&gt;\n</code></pre> <ol> <li>Send language ID instead of language code to socket:</li> </ol> <pre><code>socket.emit(\"tutor:set-available\", {\n  address: account?.address,\n  languageId: selectedLanguage.id,  // Send ID instead of code\n  language: selectedLanguage.name,   // Also send name for display\n  ratePerSecond,\n});\n</code></pre>"},{"location":"guides/language-matching-fix/#option-2-standardize-language-codes-everywhere","title":"Option 2: Standardize Language Codes Everywhere","text":"<p>When to do this: - When you want simpler code - When you don't need to verify on-chain languages</p> <p>Implementation:</p> <ol> <li>Update LANGUAGES constant to use lowercase codes consistently:</li> </ol> <pre><code>export const LANGUAGES = [\n  { id: 1, name: \"Spanish\", flag: \"\ud83c\uddea\ud83c\uddf8\", code: \"spanish\" },\n  { id: 2, name: \"French\", flag: \"\ud83c\uddeb\ud83c\uddf7\", code: \"french\" },\n  // ... etc\n] as const;\n</code></pre> <ol> <li>Update TutorAvailabilityFlow to use the same codes:</li> </ol> <pre><code>const languages = LANGUAGES.map(l =&gt; ({\n  value: l.code,\n  label: l.name,\n  flag: l.flag,\n  id: l.id\n}));\n</code></pre> <ol> <li>Update matching logic to use language IDs:</li> </ol> <pre><code>// In backend matching service\nconst languageId = LANGUAGES.find(l =&gt; l.code === language)?.id || 1;\n</code></pre>"},{"location":"guides/language-matching-fix/#option-3-store-language-id-in-socket-data-best-long-term","title":"Option 3: Store Language ID in Socket Data (Best Long-term)","text":"<p>When to do this: - For production - When you want the most reliable matching</p> <p>Implementation:</p> <ol> <li>Update socket events to include language ID:</li> </ol> <pre><code>// Tutor sets availability\nsocket.emit(\"tutor:set-available\", {\n  address: account?.address,\n  languageId: 1,  // Numeric ID from blockchain\n  languageName: \"Spanish\",  // For display\n  ratePerSecond,\n});\n\n// Student requests tutor\nsocket.emit(\"student:request-tutor\", {\n  requestId,\n  studentAddress: account?.address,\n  languageId: 1,  // Numeric ID\n  languageName: \"Spanish\",  // For display\n  budgetPerSecond,\n});\n</code></pre> <ol> <li>Update backend matching to use language IDs:</li> </ol> <pre><code>// In matchingService.js\nasync function findMatchingTutors({ languageId, budgetPerSecond, studentAddress }) {\n  // Match by numeric ID instead of string\n  const tutorAddresses = await redisClient.sMembers(`tutors:lang:${languageId}`);\n  // ...\n}\n</code></pre> <ol> <li>Update StudentTutorFinder to use the language ID directly:</li> </ol> <pre><code>const confirmAndStartSession = async () =&gt; {\n  // No need to map - use the ID directly from the matched tutor\n  const languageId = currentTutor.languageId;\n\n  await startSessionWrite({\n    functionName: \"startSession\",\n    args: [\n      currentTutor.tutorAddress as `0x${string}`, \n      BigInt(languageId),  // Direct from socket data\n      CONTRACTS.PYUSD\n    ],\n  });\n};\n</code></pre>"},{"location":"guides/language-matching-fix/#testing-the-current-workaround","title":"Testing the Current Workaround","text":"<ol> <li>Student selects \"Spanish\" \u2192 Frontend uses language code \"spanish\"</li> <li>Tutor selects \"Spanish\" \u2192 Frontend uses language code \"spanish\"</li> <li>Socket matching \u2192 Matches \"spanish\" === \"spanish\" \u2705</li> <li>Student starts session \u2192 Maps \"spanish\" \u2192 ID 1 \u2192 Calls <code>startSession(tutor, 1, token)</code></li> <li>Smart contract checks \u2192 Does tutor offer language ID 1? \u2705</li> </ol>"},{"location":"guides/language-matching-fix/#debug-logs-to-check","title":"Debug Logs to Check","text":"<p>When testing, check the console for:</p> <pre><code>=== LANGUAGE MAPPING DEBUG ===\ncurrentTutor.language from socket: spanish\nStudent's selected language: spanish\n\u2705 Using student's selected language: { languageId: 1, languageName: \"Spanish\", originalLanguage: \"spanish\" }\n============================\n</code></pre> <p>If you see a different language ID than expected, check: 1. What language the tutor registered with on-chain (in TutorRegistration) 2. What language the tutor selected in TutorAvailabilityFlow 3. What language the student selected in StudentTutorFinder</p>"},{"location":"guides/language-matching-fix/#summary","title":"Summary","text":"<ul> <li>Current workaround: Uses student's selected language (works if socket matching is correct)</li> <li>Proper fix: Implement Option 3 (store language IDs in socket data)</li> <li>Timeline: Can implement proper fix after MVP testing</li> </ul>"},{"location":"guides/student-tutor-pairing-flow/","title":"Student-Tutor Pairing Flow Documentation","text":""},{"location":"guides/student-tutor-pairing-flow/#overview","title":"Overview","text":"<p>This document explains the complete flow of pairing students with tutors, including all UI states, transitions, socket events, and when each screen appears. This flow is critical to understand for debugging and feature development.</p>"},{"location":"guides/student-tutor-pairing-flow/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Student  \u2502 \u25c4\u2500\u2500\u2500\u2500\u2500\u25ba \u2502   Backend    \u2502 \u25c4\u2500\u2500\u2500\u2500\u2500\u25ba \u2502    Tutor    \u2502\n\u2502  Frontend  \u2502 Socket  \u2502   Server     \u2502 Socket  \u2502  Frontend   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u25bc\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                        \u2502     Redis    \u2502\n                        \u2502  (Matching)  \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#student-flow","title":"Student Flow","text":""},{"location":"guides/student-tutor-pairing-flow/#component-studenttutorfindertsx","title":"Component: <code>StudentTutorFinder.tsx</code>","text":"<p>The student flow has 5 main states:</p> <ol> <li><code>setup</code> - Initial configuration screen</li> <li><code>searching</code> - Actively searching for tutors</li> <li><code>tutor-found</code> - A tutor has accepted the request</li> <li><code>session-starting</code> - Transaction submitted, waiting for blockchain</li> <li><code>no-tutors</code> - No tutors available (currently merged into <code>searching</code>)</li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#state-1-setup-finderstate-setup","title":"State 1: Setup (<code>finderState === \"setup\"</code>)","text":"<p>When shown:</p> <ul> <li>Initial state when component mounts</li> <li>After cancelling a search</li> <li>After returning from a session</li> </ul> <p>What the student sees:</p> <ul> <li>Language selection (pre-filled from registration, read-only)</li> <li>Budget input (pre-filled from registration, editable)</li> <li>Connection status indicator</li> <li>\"Find Tutors Now\" button</li> </ul> <p>User actions:</p> <ul> <li>Can adjust budget (must be sufficient for at least 10 minutes)</li> <li>Can click \"Find Tutors Now\" to start search</li> <li>Can click \"Back\" (if <code>onBack</code> prop provided)</li> </ul> <p>What happens when \"Find Tutors Now\" is clicked:</p> <pre><code>1. Validates connection and inputs\n2. Converts hourly budget to per-second PYUSD units\n3. Generates unique requestId\n4. Emits: student:request-tutor {\n     requestId,\n     studentAddress,\n     language,\n     budgetPerSecond\n   }\n5. Waits for: student:request-sent event\n6. Transitions to: \"searching\" state\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#state-2-searching-finderstate-searching","title":"State 2: Searching (<code>finderState === \"searching\"</code>)","text":"<p>When shown:</p> <ul> <li>After student clicks \"Find Tutors Now\"</li> <li>After tutor withdraws acceptance</li> <li>After skipping a tutor</li> <li>After tutor becomes unavailable</li> </ul> <p>What the student sees:</p> <ul> <li>Animated search indicator with language flag</li> <li>Elapsed search time counter</li> <li>Status messages that change based on elapsed time:</li> <li>&lt; 10 seconds: \"Searching available tutors...\"</li> <li>&lt; 30 seconds: \"Notifying tutors who come online...\"</li> <li> <p>= 30 seconds: \"Broadcasting to new tutors...\"</p> </li> <li>\"Cancel Search\" button</li> </ul> <p>Socket events listened for:</p> <ul> <li><code>student:request-sent</code> - Confirms request was received</li> <li><code>student:no-tutors-available</code> - No tutors online initially</li> <li><code>student:tutor-accepted</code> - A tutor accepted the request</li> <li><code>tutor:available-updated</code> - Tutor availability changed</li> <li><code>tutor:withdrew-acceptance</code> - Tutor withdrew their acceptance</li> </ul> <p>What happens when tutor accepts:</p> <pre><code>1. Receives: student:tutor-accepted event\n2. Stores tutor data in currentTutor state\n3. Transitions to: \"tutor-found\" state\n4. Shows success toast notification\n</code></pre> <p>What happens when tutor withdraws:</p> <pre><code>1. Receives: tutor:withdrew-acceptance event\n2. Checks if it's the current tutor\n3. Clears currentTutor state\n4. Stays in: \"searching\" state\n5. Shows toast: \"Tutor withdrew acceptance, continuing search...\"\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#state-3-tutor-found-finderstate-tutor-found","title":"State 3: Tutor Found (<code>finderState === \"tutor-found\"</code>)","text":"<p>When shown:</p> <ul> <li>After receiving <code>student:tutor-accepted</code> event</li> <li>After transaction rejection (if user wants to retry)</li> </ul> <p>What the student sees:</p> <ul> <li>Success animation (\ud83c\udf89)</li> <li>Tutor information:</li> <li>Tutor address (truncated)</li> <li>Language being taught</li> <li>Rate per hour (from blockchain)</li> <li>Balance warnings (if applicable):</li> <li>Insufficient balance warning (if <code>hasSufficientBalance === false</code>)</li> <li>Budget too low warning (if <code>canAfford === false</code>)</li> <li>Two action buttons:</li> <li>\"Skip &amp; Find Another\" - Rejects this tutor, continues searching</li> <li>\"Start Session Now\" - Accepts tutor and starts session</li> </ul> <p>Blockchain checks performed:</p> <ul> <li><code>canAffordRate()</code> - Can student afford this tutor's rate?</li> <li><code>hasSufficientBalance()</code> - Does student have 10 minutes worth of balance?</li> <li><code>getTutorInfo()</code> - Get tutor's on-chain information</li> <li><code>tutorRates()</code> - Get tutor's actual rate from blockchain</li> </ul> <p>User actions:</p> <ol> <li>Skip Tutor:</li> </ol> <pre><code>- Emits: student:reject-tutor {\n    requestId,\n    tutorAddress,\n    studentAddress\n  }\n- Clears currentTutor\n- Returns to: \"searching\" state\n</code></pre> <ol> <li>Accept Tutor (Start Session): <pre><code>- Prepares transaction: simulateContract(startSession)\n- Shows MetaMask popup: writeContract()\n- Gets transaction hash immediately after MetaMask confirmation\n- Sets state to: \"session-starting\" IMMEDIATELY (student sees rotating camera screen)\n- Emits: student:accept-tutor {\n    requestId,\n    tutorAddress,\n    studentAddress,\n    language\n  }\n- Stores session info in sessionStorage\n- Starts blockchain polling (every 1 second) for active session\n- On blockchain confirmation (active session detected):\n  * Redirects to video call URL (window.location.href)\n- On transaction rejection:\n  * Emits: student:rejected-transaction\n  * Returns to: \"tutor-found\" state (user can try again)\n- On other errors:\n  * Returns to: \"tutor-found\" state (user can try again)\n</code></pre></li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#state-4-session-starting-finderstate-session-starting","title":"State 4: Session Starting (<code>finderState === \"session-starting\"</code>)","text":"<p>When shown:</p> <ul> <li>Immediately after student clicks \"Start Session Now\" on the \"tutor-found\" screen</li> <li>While waiting for MetaMask transaction confirmation</li> <li>While waiting for blockchain transaction to confirm</li> </ul> <p>What the student sees:</p> <ul> <li>Rotating video camera icon (\ud83d\udcf9)</li> <li>\"Starting Your Session! \ud83c\udf93\" message</li> <li>\"Preparing video call...\" status</li> <li>This screen is shown while the transaction is being processed</li> </ul> <p>What happens:</p> <pre><code>1. Student clicks \"Start Session Now\"\n2. MetaMask popup appears for transaction confirmation\n3. After student confirms in MetaMask, transaction hash is received\n4. setFinderState(\"session-starting\") is called IMMEDIATELY\n5. Student sees \"session-starting\" screen (rotating camera)\n6. Emits student:accept-tutor event (notifies tutor)\n7. Stores session info in sessionStorage\n8. Starts blockchain polling every 1 second for active session\n9. Polls activeSessions(tutorAddress) until session becomes active\n10. Once blockchain confirms session (isActive &amp;&amp; startTime &gt; 0):\n    * Redirects to video call URL\n    * Student enters WebRTC room simultaneously with tutor\n</code></pre> <p>Blockchain Polling:</p> <ul> <li>Polls <code>activeSessions(tutorAddress)</code> every 1 second</li> <li>Checks if <code>isActive === true</code> and <code>startTime &gt; 0</code></li> <li>When active, redirects to video call URL</li> <li>This ensures both student and tutor enter at the same time</li> </ul> <p>Note: The student will see this screen from MetaMask confirmation until blockchain confirms the session (typically a few seconds). Both student and tutor use blockchain polling to enter simultaneously.</p>"},{"location":"guides/student-tutor-pairing-flow/#tutor-flow","title":"Tutor Flow","text":""},{"location":"guides/student-tutor-pairing-flow/#component-tutoravailabilityflowtsx","title":"Component: <code>TutorAvailabilityFlow.tsx</code>","text":"<p>The tutor flow has 5 main states:</p> <ol> <li><code>setup</code> - Initial configuration screen</li> <li><code>waiting</code> - Available and waiting for student requests</li> <li><code>waiting-for-student</code> - Accepted a request, waiting for student to confirm</li> <li><code>session-starting</code> - Student confirmed transaction, waiting for blockchain</li> <li><code>in-session</code> - Currently in an active session (rarely used, mostly handled by video call)</li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#state-1-setup-availabilitystate-setup","title":"State 1: Setup (<code>availabilityState === \"setup\"</code>)","text":"<p>When shown:</p> <ul> <li>Initial state when component mounts</li> <li>After stopping tutoring</li> <li>After session ends</li> </ul> <p>What the tutor sees:</p> <ul> <li>Registration check (if not registered, shows warning)</li> <li>Language selection grid (only registered languages)</li> <li>Rate display for selected language (from blockchain)</li> <li>Connection status indicator</li> <li>\"Go Live &amp; Start Earning\" button</li> </ul> <p>User actions:</p> <ul> <li>Select a language from registered languages</li> <li>Click \"Go Live &amp; Start Earning\" to become available</li> <li>Click \"Back\" (if <code>onBack</code> prop provided)</li> </ul> <p>What happens when \"Go Live\" is clicked:</p> <pre><code>1. Validates: registered, language selected, rate exists\n2. Gets rate from blockchain for selected language\n3. Emits: tutor:set-available {\n     address,\n     language, // language code\n     ratePerSecond\n   }\n4. Waits for: tutor:availability-set event\n5. Transitions to: \"waiting\" state\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#state-2-waiting-availabilitystate-waiting","title":"State 2: Waiting (<code>availabilityState === \"waiting\"</code>)","text":"<p>When shown:</p> <ul> <li>After tutor goes live</li> <li>After student rejects tutor</li> <li>After student rejects transaction</li> <li>After tutor withdraws acceptance</li> </ul> <p>What the tutor sees:</p> <ul> <li>Animated waiting indicator with language flag</li> <li>Connection status debug info</li> <li>Earnings preview (per minute, hour, day)</li> <li>Sound wave animation</li> <li>\"Waiting for students...\" status</li> <li>Incoming requests list (if any)</li> <li>\"Stop Tutoring\" button</li> </ul> <p>Socket events listened for:</p> <ul> <li><code>tutor:incoming-request</code> - New student request received</li> <li><code>tutor:request-accepted</code> - Confirmation after accepting request</li> <li><code>tutor:student-rejected</code> - Student rejected this tutor</li> <li><code>tutor:availability-removed</code> - Availability removed (from stop button)</li> </ul> <p>What happens when student request arrives:</p> <pre><code>1. Receives: tutor:incoming-request event\n2. Adds request to incomingRequests array\n3. Shows toast notification with Accept/Decline buttons\n4. Request appears in \"Incoming Requests\" section\n</code></pre> <p>User actions:</p> <ol> <li>Accept Request:</li> </ol> <pre><code>- Emits: tutor:accept-request {\n    requestId,\n    tutorAddress\n  }\n- Removes request from incomingRequests\n- Waits for: tutor:request-accepted event\n- Transitions to: \"waiting-for-student\" state\n</code></pre> <ol> <li>Decline Request:</li> </ol> <pre><code>- Emits: tutor:decline-request { requestId }\n- Removes request from incomingRequests\n- Stays in: \"waiting\" state\n</code></pre> <ol> <li>Stop Tutoring: <pre><code>- Emits: tutor:set-unavailable { address }\n- Waits for: tutor:availability-removed event\n- Transitions to: \"setup\" state\n</code></pre></li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#state-3-waiting-for-student-availabilitystate-waiting-for-student","title":"State 3: Waiting for Student (<code>availabilityState === \"waiting-for-student\"</code>)","text":"<p>When shown:</p> <ul> <li>After tutor accepts a student request</li> <li>Waiting for student to confirm transaction</li> </ul> <p>What the tutor sees:</p> <ul> <li>Animated waiting indicator (\u23f3)</li> <li>\"Waiting for Student to Start \ud83c\udf93\" message</li> <li>Request details:</li> <li>Student address (truncated)</li> <li>Language</li> <li>Student's budget</li> <li>\"Back to Waiting\" button (withdraws acceptance)</li> </ul> <p>Socket events listened for:</p> <ul> <li><code>student:accept-tutor</code> - Student confirmed transaction</li> <li><code>tutor:student-rejected</code> - Student rejected or selected another tutor</li> <li><code>tutor:student-rejected-transaction</code> - Student rejected MetaMask transaction</li> </ul> <p>What happens when student accepts:</p> <pre><code>1. Receives: student:accept-tutor event\n2. Stores session data in currentSession\n3. Transitions to: \"session-starting\" state\n4. Shows rotating camera screen (same as student sees)\n</code></pre> <p>What happens when student rejects:</p> <pre><code>1. Receives: tutor:student-rejected event\n2. Clears currentSession\n3. Transitions to: \"waiting\" state\n4. Shows toast: \"Student rejected you or selected another tutor\"\n</code></pre> <p>User actions:</p> <ul> <li>Withdraw Acceptance: <pre><code>- Emits: tutor:withdraw-acceptance {\n    requestId,\n    tutorAddress,\n    studentAddress\n  }\n- Transitions to: \"waiting\" state\n</code></pre></li> </ul>"},{"location":"guides/student-tutor-pairing-flow/#state-4-session-starting-availabilitystate-session-starting","title":"State 4: Session Starting (<code>availabilityState === \"session-starting\"</code>)","text":"<p>When shown:</p> <ul> <li>After student confirms transaction (<code>student:accept-tutor</code> event)</li> <li>Waiting for blockchain confirmation and student to enter video room</li> </ul> <p>What the tutor sees:</p> <ul> <li>Rotating video camera icon</li> <li>\"Starting Your Session! \ud83c\udf93\" message</li> <li>\"Preparing video call...\" status</li> </ul> <p>What happens:</p> <pre><code>1. Receives student:accept-tutor event (student confirmed MetaMask transaction)\n2. Transitions to \"session-starting\" state\n3. Shows rotating camera screen (same as student sees)\n4. Starts blockchain polling every 1 second for active session\n5. Polls activeSessions(tutorAddress) until session becomes active\n6. Once blockchain confirms session (isActive &amp;&amp; startTime &gt; 0):\n   * Redirects to video call URL immediately\n   * Tutor enters WebRTC room simultaneously with student\n</code></pre> <p>Socket events listened for:</p> <ul> <li><code>student:accept-tutor</code> - Student confirmed MetaMask transaction</li> <li><code>session:started</code> - Transaction confirmed on blockchain (informational only)</li> <li><code>student:in-room</code> - Student entered video call room (informational only, not used for redirect)</li> </ul> <p>Blockchain polling:</p> <ul> <li>Polls <code>activeSessions(tutorAddress)</code> every 1 second</li> <li>Checks if <code>isActive === true</code> and <code>startTime &gt; 0</code></li> <li>When active, redirects to video call immediately (no delay)</li> <li>This is the primary and only method for entering the WebRTC room</li> <li>Ensures both student and tutor enter simultaneously</li> </ul>"},{"location":"guides/student-tutor-pairing-flow/#backend-matching-logic","title":"Backend Matching Logic","text":""},{"location":"guides/student-tutor-pairing-flow/#matching-service-matchingservicejs","title":"Matching Service (<code>matchingService.js</code>)","text":"<p>Key Functions:</p> <ol> <li> <p><code>setTutorAvailable(address, language, ratePerSecond)</code></p> </li> <li> <p>Stores tutor in Redis with TTL (5 minutes default)</p> </li> <li>Adds to <code>available_tutors</code> set</li> <li>Adds to <code>tutors:{language}</code> set</li> <li> <p>Checks for pending student requests matching this tutor</p> </li> <li> <p><code>findMatchingTutors({language, budgetPerSecond, studentAddress})</code></p> </li> <li> <p>Gets all tutors for the language from Redis</p> </li> <li>Filters by: <code>tutorRate &lt;= studentBudget</code></li> <li>Sorts by rate (lowest first)</li> <li> <p>Returns matching tutors</p> </li> <li> <p><code>storeStudentRequest(requestId, requestData)</code></p> </li> <li> <p>Stores request in Redis with TTL (1 minute default)</p> </li> <li>Adds to <code>pending_requests</code> set</li> <li> <p>Request includes: studentAddress, language, budgetPerSecond, socketId</p> </li> <li> <p><code>getPendingStudentRequests(language, tutorRatePerSecond)</code></p> </li> <li>Gets all pending requests</li> <li>Filters by matching language and budget</li> <li>Returns sorted by creation time (oldest first)</li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#socket-event-flow","title":"Socket Event Flow","text":""},{"location":"guides/student-tutor-pairing-flow/#student-requests-tutor","title":"Student Requests Tutor","text":"<pre><code>Student                    Backend                    Tutor\n  \u2502                          \u2502                          \u2502\n  \u2502\u2500\u2500student:request-tutor\u2500\u25ba\u2502                          \u2502\n  \u2502                          \u2502\u2500\u2500store in Redis\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502                          \u2502\u2500\u2500findMatchingTutors()\u2500\u2500\u2500\u2524\n  \u2502                          \u2502\u2500\u2500tutor:incoming-request\u25ba\u2502\n  \u2502\u25c4\u2500student:request-sent\u2500\u2500\u2500\u2500\u2502                          \u2502\n  \u2502                          \u2502                          \u2502\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#tutor-accepts-request","title":"Tutor Accepts Request","text":"<pre><code>Student                    Backend                    Tutor\n  \u2502                          \u2502                          \u2502\n  \u2502                          \u2502\u25c4\u2500\u2500tutor:accept-request\u2500\u2500\u2500\u2502\n  \u2502                          \u2502\u2500\u2500getStudentRequest()\u2500\u2500\u2500\u2500\u2524\n  \u2502                          \u2502\u2500\u2500getTutorByAddress()\u2500\u2500\u2500\u2500\u2524\n  \u2502\u25c4\u2500\u2500student:tutor-accepted\u2500\u2502\u2500\u2500student:tutor-accepted\u25ba\u2502\n  \u2502                          \u2502\u2500\u2500removeStudentRequest()\u2500\u2524\n  \u2502                          \u2502\u2500\u2500tutor:request-accepted\u25ba\u2502\n  \u2502                          \u2502                          \u2502\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#student-accepts-tutor-starts-session","title":"Student Accepts Tutor (Starts Session)","text":"<pre><code>Student                    Backend                    Tutor\n  \u2502                          \u2502                          \u2502\n  \u2502\u2500\u2500startSession() tx\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                          \u2502\n  \u2502   (MetaMask confirm)     \u2502                          \u2502\n  \u2502\u2500\u2500setState(\"session-      \u2502                          \u2502\n  \u2502   starting\")              \u2502                          \u2502\n  \u2502\u2500\u2500student:accept-tutor\u2500\u2500\u2500\u2500\u25ba\u2502                          \u2502\n  \u2502                          \u2502\u2500\u2500removeStudentRequest()\u2500\u2524\n  \u2502                          \u2502\u2500\u2500student:accept-tutor\u2500\u2500\u2500\u25ba\u2502\n  \u2502                          \u2502                          \u2502\n  \u2502\u2500\u2500poll blockchain\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                          \u2502\u2500\u2500poll blockchain\n  \u2502   (every 1s)             \u2502                          \u2502   (every 1s)\n  \u2502                          \u2502                          \u2502\n  \u2502\u2500\u2500detect active session\u2500\u2500\u2500\u2524                          \u2502\u2500\u2500detect active session\n  \u2502\u2500\u2500redirect to video\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                          \u2502\u2500\u2500redirect to video\n  \u2502   (simultaneously)        \u2502                          \u2502   (simultaneously)\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#student-enters-video-room","title":"Student Enters Video Room","text":"<pre><code>Student                    Backend                    Tutor\n  \u2502                          \u2502                          \u2502\n  \u2502\u2500\u2500redirect to WebRTC\u2500\u2500\u2500\u2500\u2500\u2500\u2524                          \u2502\u2500\u2500redirect to WebRTC\n  \u2502   (after blockchain      \u2502                          \u2502   (after blockchain\n  \u2502    confirms)              \u2502                          \u2502    confirms)\n  \u2502                          \u2502                          \u2502\n  \u2502\u2500\u2500student:entered-room\u2500\u2500\u2500\u25ba\u2502                          \u2502\n  \u2502   (from WebRTC page)     \u2502                          \u2502\n  \u2502                          \u2502\u2500\u2500storeSessionMapping()\u2500\u2500\u2524\n  \u2502                          \u2502\u2500\u2500student:in-room\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502\n  \u2502                          \u2502   (broadcast to all)     \u2502\n  \u2502\u25c4\u2500\u2500student:room-entry\u2500\u2500\u2500\u2500\u2500\u2502                          \u2502\n  \u2502   -confirmed             \u2502                          \u2502\n  \u2502                          \u2502                          \u2502\n</code></pre> <p>Note: Both student and tutor redirect to WebRTC simultaneously via blockchain polling. The <code>student:entered-room</code> event is emitted after both have already entered the room, and is used for session tracking, not for triggering redirects.</p>"},{"location":"guides/student-tutor-pairing-flow/#active-session-prompt","title":"Active Session Prompt","text":""},{"location":"guides/student-tutor-pairing-flow/#component-activesessionprompttsx","title":"Component: <code>ActiveSessionPrompt.tsx</code>","text":"<p>Purpose: Warns users if they have an active session when navigating away from session pages.</p> <p>When shown:</p> <ul> <li>User has an active session on blockchain (<code>activeSessions(address)</code> returns active session)</li> <li>User is NOT on <code>/tutor</code> or <code>/find-tutor</code> pages (or paths starting with these)</li> <li>Session has started (<code>startTime &gt; 0</code>)</li> <li>Session is NOT very new (more than 60 seconds old) - grace period for session-starting flow</li> </ul> <p>What user sees:</p> <ul> <li>Orange/red banner at top of page</li> <li>Session duration (live counter)</li> <li>\"End Session Now\" button</li> <li>\"Dismiss\" button</li> </ul> <p>What happens:</p> <ul> <li>Polls blockchain every 5 seconds for active session</li> <li>Updates duration counter every second</li> <li>\"End Session Now\" calls <code>endSession(tutorAddress)</code> on blockchain</li> </ul>"},{"location":"guides/student-tutor-pairing-flow/#state-transition-diagrams","title":"State Transition Diagrams","text":""},{"location":"guides/student-tutor-pairing-flow/#student-state-machine","title":"Student State Machine","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502setup \u2502\n\u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2518\n   \u2502 \"Find Tutors Now\"\n   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502searching \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n   \u2502 tutor accepted    \u2502 skip/reject\n   \u25bc                   \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502\n\u2502tutor-found  \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u2502 \"Start Session\"\n   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502session-starting \u2502\n\u2502 (polling        \u2502\n\u2502  blockchain)    \u2502\n\u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u2502 active session\n   \u2502 detected\n   \u25bc\n[Redirect to Video Call]\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#tutor-state-machine","title":"Tutor State Machine","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502setup \u2502\n\u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2518\n   \u2502 \"Go Live\"\n   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 waiting  \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2502\n   \u2502 accept request             \u2502 student rejects\n   \u25bc                            \u2502 or withdraw\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502waiting-for-student\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u2502 student accepts\n   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502session-starting \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u2502\n   \u25bc\n[Redirect to Video Call]\n</code></pre>"},{"location":"guides/student-tutor-pairing-flow/#common-issues-debugging","title":"Common Issues &amp; Debugging","text":""},{"location":"guides/student-tutor-pairing-flow/#student-sees-searching-but-no-tutors-appear","title":"Student sees \"Searching\" but no tutors appear","text":"<p>Check:</p> <ol> <li>Are tutors actually available? Check Redis: <code>SMEMBERS available_tutors</code></li> <li>Do tutors match language? Check: <code>SMEMBERS tutors:{language}</code></li> <li>Do tutors match budget? Check tutor rates vs student budget</li> <li>Are socket connections working? Check backend logs for <code>tutor:incoming-request</code> emissions</li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#tutor-doesnt-receive-student-requests","title":"Tutor doesn't receive student requests","text":"<p>Check:</p> <ol> <li>Is tutor's socket ID stored in Redis? <code>HGET tutor:{address} socketId</code></li> <li>Is tutor in the correct language set? <code>SMEMBERS tutors:{language}</code></li> <li>Is student's request stored? <code>HGETALL request:{requestId}</code></li> <li>Check backend logs for request processing</li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#student-accepts-tutor-but-nothing-happens","title":"Student accepts tutor but nothing happens","text":"<p>Check:</p> <ol> <li>Did transaction succeed? Check MetaMask</li> <li>Did <code>student:accept-tutor</code> event reach backend? Check backend logs</li> <li>Did tutor receive <code>student:accept-tutor</code>? Check tutor frontend console</li> <li>Is session stored in Redis? Check <code>sessionService.storeSessionMapping()</code></li> <li>Is blockchain polling working? Check console for \"Student polling blockchain\" logs</li> <li>Is active session detected? Check if <code>activeSessions(tutorAddress)</code> returns active session</li> <li>Important: Student queries <code>activeSessions(tutorAddress)</code>, not <code>activeSessions(studentAddress)</code> - the mapping is keyed by tutor address</li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#tutor-stuck-in-waiting-for-student","title":"Tutor stuck in \"waiting-for-student\"","text":"<p>Check:</p> <ol> <li>Did student actually accept? Check student's transaction history</li> <li>Did <code>student:accept-tutor</code> event fire? Check backend logs</li> <li>Is tutor listening for the event? Check tutor frontend console</li> <li>Try withdrawing acceptance and going back to waiting</li> </ol>"},{"location":"guides/student-tutor-pairing-flow/#key-files","title":"Key Files","text":"<ul> <li>Student Component: <code>webapp/packages/nextjs/components/student/StudentTutorFinder.tsx</code></li> <li>Tutor Component: <code>webapp/packages/nextjs/components/tutor/TutorAvailabilityFlow.tsx</code></li> <li>Active Session Prompt: <code>webapp/packages/nextjs/components/session/ActiveSessionPrompt.tsx</code></li> <li>Backend Server: <code>backend/src/server.js</code></li> <li>Matching Service: <code>backend/src/services/matchingService.js</code></li> <li>Socket Events Docs: <code>docs/tech/socket-events.md</code></li> </ul>"},{"location":"guides/student-tutor-pairing-flow/#related-documentation","title":"Related Documentation","text":"<ul> <li>Socket Events Reference</li> <li>WebRTC Integration Guide</li> <li>API Reference</li> </ul>"},{"location":"guides/webrtc-integration/","title":"WebRTC End Session Integration","text":""},{"location":"guides/webrtc-integration/#overview","title":"Overview","text":"<p>This integration connects the webRTC video call system with the LangDAO smart contract's <code>endSession()</code> function. When a user ends a call or disconnects, the backend automatically calls <code>endSession()</code> on the blockchain to process payment and update session state.</p>"},{"location":"guides/webrtc-integration/#architecture","title":"Architecture","text":"<pre><code>WebRTC Server (Railway)\n    \u2193 HTTP POST\nBackend API (/api/webrtc-events)\n    \u2193 Read session mapping from Redis\n    \u2193 Call smart contract\nLangDAO.endSession(tutorAddress)\n    \u2193 Process payment\n    \u2193 Update session state\n</code></pre>"},{"location":"guides/webrtc-integration/#components-created","title":"Components Created","text":""},{"location":"guides/webrtc-integration/#1-backendsrcrouteswebrtcjs","title":"1. backend/src/routes/webrtc.js","text":"<ul> <li>Receives events from webRTC server</li> <li>Handles: <code>session-heartbeat</code>, <code>session-ended</code>, <code>user-disconnected</code></li> <li>Calls <code>endSession()</code> on smart contract</li> <li>Monitors heartbeat and auto-ends stale sessions</li> </ul>"},{"location":"guides/webrtc-integration/#2-backendsrcservicessessionservicejs","title":"2. backend/src/services/sessionService.js","text":"<ul> <li>Stores session mappings in Redis</li> <li>Maps <code>sessionId</code> \u2192 <code>{studentAddress, tutorAddress, languageId}</code></li> <li>Used to find tutor address when ending session</li> </ul>"},{"location":"guides/webrtc-integration/#3-backendwebrtc-implementation-langdaoserverjs-updated","title":"3. backend/webRTC-implementation-LangDAO/server.js (Updated)","text":"<ul> <li>Changed backend URL from <code>localhost:3001</code> to <code>localhost:4000</code></li> <li>Sends events to main LangDAO backend</li> </ul>"},{"location":"guides/webrtc-integration/#events-flow","title":"Events Flow","text":""},{"location":"guides/webrtc-integration/#when-session-starts","title":"When Session Starts:","text":"<ol> <li>Student confirms transaction \u2192 <code>startSession()</code> called on blockchain</li> <li>Student emits <code>session:started</code> socket event</li> <li>Backend stores session mapping in Redis:    <pre><code>{\n  sessionId: \"req_abc123\",\n  studentAddress: \"0x...\",\n  tutorAddress: \"0x...\",\n  languageId: 1\n}\n</code></pre></li> <li>Both users redirect to webRTC call</li> </ol>"},{"location":"guides/webrtc-integration/#when-session-ends","title":"When Session Ends:","text":""},{"location":"guides/webrtc-integration/#method-1-user-clicks-end-call","title":"Method 1: User Clicks \"End Call\"","text":"<ol> <li>WebRTC client sends <code>call-ended</code> message</li> <li>WebRTC server \u2192 POST <code>/api/webrtc-events</code> <pre><code>{\n  \"type\": \"session-ended\",\n  \"sessionId\": \"req_abc123\",\n  \"endedBy\": \"student\",\n  \"userAddress\": \"0x...\",\n  \"timestamp\": 1234567890\n}\n</code></pre></li> <li>Backend retrieves session mapping from Redis</li> <li>Backend calls <code>langDAOContract.endSession(tutorAddress)</code></li> <li>Smart contract processes payment and updates state</li> <li>Session mapping removed from Redis</li> </ol>"},{"location":"guides/webrtc-integration/#method-2-user-disconnects-connection-lost","title":"Method 2: User Disconnects (Connection Lost)","text":"<ol> <li>WebRTC server detects disconnect</li> <li>WebRTC server \u2192 POST <code>/api/webrtc-events</code> <pre><code>{\n  \"type\": \"user-disconnected\",\n  \"sessionId\": \"req_abc123\",\n  \"userRole\": \"student\",\n  \"reason\": \"connection-closed\"\n}\n</code></pre></li> <li>Backend waits 30 seconds (grace period for reconnection)</li> <li>If no reconnection, calls <code>endSession()</code> on blockchain</li> </ol>"},{"location":"guides/webrtc-integration/#method-3-heartbeat-timeout","title":"Method 3: Heartbeat Timeout","text":"<ol> <li>WebRTC client sends heartbeat every 30 seconds</li> <li>Backend monitors heartbeats every minute</li> <li>If no heartbeat for 2 minutes \u2192 calls <code>endSession()</code></li> </ol>"},{"location":"guides/webrtc-integration/#smart-contract-integration","title":"Smart Contract Integration","text":"<p>The backend uses ethers.js to interact with the LangDAO contract:</p> <pre><code>const provider = new ethers.JsonRpcProvider('http://localhost:8545');\nconst backendWallet = new ethers.Wallet(PRIVATE_KEY, provider);\nconst langDAOContract = new ethers.Contract(ADDRESS, ABI, backendWallet);\n\n// End session\nconst tx = await langDAOContract.endSession(tutorAddress);\nawait tx.wait();\n</code></pre>"},{"location":"guides/webrtc-integration/#environment-variables","title":"Environment Variables","text":""},{"location":"guides/webrtc-integration/#backend-env","title":"Backend (.env)","text":"<pre><code># Blockchain\nRPC_URL=http://localhost:8545\nBACKEND_PRIVATE_KEY=your_private_key_here\n\n# Redis\nREDIS_URL=redis://localhost:6379\n</code></pre>"},{"location":"guides/webrtc-integration/#webrtc-server-env","title":"WebRTC Server (.env)","text":"<pre><code>BACKEND_URL=http://localhost:4000/api/webrtc-events\nPORT=3000\n</code></pre>"},{"location":"guides/webrtc-integration/#testing","title":"Testing","text":""},{"location":"guides/webrtc-integration/#1-start-all-services","title":"1. Start All Services","text":"<pre><code># Terminal 1: Local blockchain\ncd webapp/packages/hardhat\nyarn chain\n\n# Terminal 2: Redis\nredis-server\n\n# Terminal 3: Main backend\ncd backend\nyarn dev\n\n# Terminal 4: WebRTC server\ncd backend/webRTC-implementation-LangDAO\nnpm start\n\n# Terminal 5: Frontend\ncd webapp\nyarn start\n</code></pre>"},{"location":"guides/webrtc-integration/#2-test-session-end","title":"2. Test Session End","text":"<ol> <li>Start a session between student and tutor</li> <li>Both users should be in webRTC call</li> <li>Click \"End Call\" button</li> <li>Check backend logs for:    <pre><code>\ud83d\uded1 Session ended by student: req_abc123\nSession details: Student=0x..., Tutor=0x...\nCalling endSession on smart contract for tutor: 0x...\nTransaction sent: 0x...\n\u2705 Session ended on blockchain. Gas used: 123456\n</code></pre></li> </ol>"},{"location":"guides/webrtc-integration/#3-test-disconnect","title":"3. Test Disconnect","text":"<ol> <li>Start a session</li> <li>Close browser tab (simulate disconnect)</li> <li>Wait 30 seconds</li> <li>Check backend logs for grace period and auto-end</li> </ol>"},{"location":"guides/webrtc-integration/#4-test-heartbeat-timeout","title":"4. Test Heartbeat Timeout","text":"<ol> <li>Start a session</li> <li>Stop sending heartbeats (pause webRTC client)</li> <li>Wait 2 minutes</li> <li>Backend should auto-end session</li> </ol>"},{"location":"guides/webrtc-integration/#monitoring","title":"Monitoring","text":""},{"location":"guides/webrtc-integration/#backend-logs","title":"Backend Logs","text":"<pre><code># Session started\n\u2705 Session mapping stored: req_abc123 -&gt; 0x1234...\n\n# Heartbeat received\n\ud83d\udc93 Heartbeat for session req_abc123\n\n# Session ended\n\ud83d\uded1 Session ended by student: req_abc123\n\u2705 Session ended on blockchain. Gas used: 123456\n\u2705 Session mapping removed: req_abc123\n</code></pre>"},{"location":"guides/webrtc-integration/#webrtc-server-logs","title":"WebRTC Server Logs","text":"<pre><code># User connected\nClient joined room: req_abc123 as student\n\n# Heartbeat sent\nHeartbeat received: { sessionId: 'req_abc123', ... }\n\n# Call ended\nCall ended by user: { type: 'call-ended', ... }\nBackend notified: session-ended\n</code></pre>"},{"location":"guides/webrtc-integration/#error-handling","title":"Error Handling","text":""},{"location":"guides/webrtc-integration/#session-not-found","title":"Session Not Found","text":"<pre><code>// If session mapping doesn't exist\nSession mapping not found for req_abc123\n// Session may have already ended or expired\n</code></pre>"},{"location":"guides/webrtc-integration/#blockchain-transaction-failed","title":"Blockchain Transaction Failed","text":"<pre><code>// If endSession() reverts\nError ending session on blockchain: Error: execution reverted\n// Check: Is session still active? Does tutor have active session?\n</code></pre>"},{"location":"guides/webrtc-integration/#webrtc-server-unreachable","title":"WebRTC Server Unreachable","text":"<pre><code>// If backend can't reach webRTC server\nBackend notification failed: ECONNREFUSED\n// WebRTC server may be down\n</code></pre>"},{"location":"guides/webrtc-integration/#future-improvements","title":"Future Improvements","text":"<ol> <li>Add session duration tracking - Store start time and calculate duration</li> <li>Add payment verification - Verify payment amount matches duration</li> <li>Add session history - Store completed sessions in database</li> <li>Add reconnection handling - Allow users to rejoin after disconnect</li> <li>Add admin override - Allow owner to force-end sessions</li> <li>Add session analytics - Track average session duration, completion rate, etc.</li> </ol>"},{"location":"guides/webrtc-integration/#security-considerations","title":"Security Considerations","text":"<ol> <li>Backend Private Key - Store securely, never commit to git</li> <li>Rate Limiting - Already implemented on API endpoints</li> <li>Session Validation - Verify session exists before ending</li> <li>Grace Period - 30 seconds prevents accidental ends from brief disconnects</li> <li>Heartbeat Monitoring - 2-minute timeout prevents zombie sessions</li> </ol>"},{"location":"guides/webrtc-integration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/webrtc-integration/#session-doesnt-end-when-clicking-end-call","title":"Session doesn't end when clicking \"End Call\"","text":"<ul> <li>Check webRTC server logs - is event being sent?</li> <li>Check backend logs - is event being received?</li> <li>Check Redis - does session mapping exist?</li> <li>Check blockchain - is session still active?</li> </ul>"},{"location":"guides/webrtc-integration/#payment-not-processed-correctly","title":"Payment not processed correctly","text":"<ul> <li>Check smart contract logs</li> <li>Verify <code>endSession()</code> was called with correct tutor address</li> <li>Check student's balance before/after</li> </ul>"},{"location":"guides/webrtc-integration/#tutor-stuck-in-waiting-for-student-state","title":"Tutor stuck in \"waiting-for-student\" state","text":"<ul> <li>Check if blockchain polling is working</li> <li>Check if socket event was received</li> <li>Manually end session using smart contract</li> </ul>"},{"location":"guides/webrtc-integration/#summary","title":"Summary","text":"<p>This integration provides three layers of protection to ensure sessions are properly ended:</p> <ol> <li>User Action - Immediate end when user clicks button</li> <li>Disconnect Detection - Auto-end after 30-second grace period</li> <li>Heartbeat Monitoring - Auto-end after 2-minute timeout</li> </ol> <p>All methods call <code>endSession()</code> on the blockchain to process payment and update state.</p>"},{"location":"ops/environment-variables/","title":"Environment Variables Reference","text":"<p>Complete reference for all environment variables used across the LangDAO platform.</p>"},{"location":"ops/environment-variables/#backend-express-socketio","title":"Backend (Express + Socket.io)","text":"<p>Location: <code>backend/.env</code></p>"},{"location":"ops/environment-variables/#server-configuration","title":"Server Configuration","text":"Variable Required Default Description <code>PORT</code> No <code>4000</code> Port for backend server <code>NODE_ENV</code> No <code>development</code> Environment mode (<code>development</code>, <code>production</code>, <code>test</code>) <code>CORS_ORIGIN</code> No <code>http://localhost:3000</code> Allowed CORS origin for frontend"},{"location":"ops/environment-variables/#blockchain-configuration","title":"Blockchain Configuration","text":"Variable Required Default Description <code>RPC_URL</code> Yes <code>http://localhost:8545</code> Ethereum RPC endpoint (local Hardhat or testnet) <code>CONTRACT_ADDRESS</code> Yes - Deployed LangDAO contract address <code>BACKEND_PRIVATE_KEY</code> Yes - Private key for backend wallet (to call <code>endSession()</code>) <p>\u26a0\ufe0f Security Warning: Never commit private keys to git. Use environment variables or secrets management in production.</p>"},{"location":"ops/environment-variables/#redis-configuration","title":"Redis Configuration","text":"Variable Required Default Description <code>REDIS_URL</code> No <code>redis://localhost:6379</code> Redis connection URL <p>Redis is used for:</p> <ul> <li>Tutor availability state</li> <li>Student request storage</li> <li>Session mappings</li> <li>Socket-to-address bindings</li> <li>Rate limiting</li> </ul>"},{"location":"ops/environment-variables/#example-env","title":"Example <code>.env</code>","text":"<pre><code># Server\nPORT=4000\nNODE_ENV=development\nCORS_ORIGIN=http://localhost:3000\n\n# Blockchain\nRPC_URL=http://localhost:8545\nCONTRACT_ADDRESS=0x5FbDB2315678afecb367f032d93F642f64180aa3\nBACKEND_PRIVATE_KEY=your_private_key_here\n\n# Redis\nREDIS_URL=redis://localhost:6379\n</code></pre>"},{"location":"ops/environment-variables/#frontend-nextjs","title":"Frontend (Next.js)","text":"<p>Location: <code>webapp/packages/nextjs/.env.local</code></p>"},{"location":"ops/environment-variables/#thirdweb-configuration","title":"Thirdweb Configuration","text":"Variable Required Default Description <code>NEXT_PUBLIC_THIRDWEB_CLIENT_ID</code> Yes - Thirdweb client ID for wallet connection <p>Get your client ID from: https://thirdweb.com/dashboard</p>"},{"location":"ops/environment-variables/#alchemy-configuration","title":"Alchemy Configuration","text":"Variable Required Default Description <code>NEXT_PUBLIC_ALCHEMY_API_KEY</code> Yes - Alchemy API key for RPC access <p>Get your API key from: https://dashboard.alchemy.com/</p>"},{"location":"ops/environment-variables/#walletconnect-configuration","title":"WalletConnect Configuration","text":"Variable Required Default Description <code>NEXT_PUBLIC_WALLET_CONNECT_PROJECT_ID</code> Yes - WalletConnect project ID <p>Get your project ID from: https://cloud.walletconnect.com/</p>"},{"location":"ops/environment-variables/#socketio-configuration","title":"Socket.io Configuration","text":"Variable Required Default Description <code>NEXT_PUBLIC_SOCKET_URL</code> No <code>http://localhost:4000</code> Backend Socket.io server URL"},{"location":"ops/environment-variables/#webrtc-configuration","title":"WebRTC Configuration","text":"Variable Required Default Description <code>NEXT_PUBLIC_WEBRTC_URL</code> No <code>http://localhost:3000</code> WebRTC server URL"},{"location":"ops/environment-variables/#example-envlocal","title":"Example <code>.env.local</code>","text":"<pre><code># Thirdweb\nNEXT_PUBLIC_THIRDWEB_CLIENT_ID=your_client_id_here\n\n# Alchemy\nNEXT_PUBLIC_ALCHEMY_API_KEY=your_alchemy_api_key\n\n# WalletConnect\nNEXT_PUBLIC_WALLET_CONNECT_PROJECT_ID=your_project_id\n\n# Backend\nNEXT_PUBLIC_SOCKET_URL=http://localhost:4000\n\n# WebRTC\nNEXT_PUBLIC_WEBRTC_URL=http://localhost:3000\n</code></pre>"},{"location":"ops/environment-variables/#smart-contracts-hardhat","title":"Smart Contracts (Hardhat)","text":"<p>Location: <code>webapp/packages/hardhat/.env</code></p>"},{"location":"ops/environment-variables/#alchemy-configuration_1","title":"Alchemy Configuration","text":"Variable Required Default Description <code>ALCHEMY_API_KEY</code> No - Alchemy API key for testnet deployment"},{"location":"ops/environment-variables/#etherscan-configuration","title":"Etherscan Configuration","text":"Variable Required Default Description <code>ETHERSCAN_V2_API_KEY</code> No - Etherscan API key for contract verification <p>Get your API key from: https://etherscan.io/myapikey</p>"},{"location":"ops/environment-variables/#deployer-configuration","title":"Deployer Configuration","text":"Variable Required Default Description <code>DEPLOYER_PRIVATE_KEY_ENCRYPTED</code> No - Encrypted deployer private key (generated by Scaffold-ETH) <p>\u26a0\ufe0f Don't fill this manually! Use: - <code>yarn generate</code> - Generate new account - <code>yarn account:import</code> - Import existing private key</p>"},{"location":"ops/environment-variables/#example-env_1","title":"Example <code>.env</code>","text":"<pre><code># Alchemy (for testnet deployment)\nALCHEMY_API_KEY=your_alchemy_api_key\n\n# Etherscan (for contract verification)\nETHERSCAN_V2_API_KEY=your_etherscan_api_key\n\n# Deployer (generated by yarn generate)\nDEPLOYER_PRIVATE_KEY_ENCRYPTED=...encrypted_key...\n</code></pre>"},{"location":"ops/environment-variables/#webrtc-server","title":"WebRTC Server","text":"<p>Location: <code>backend/webRTC-implementation-LangDAO/</code> (no .env file, uses environment variables)</p>"},{"location":"ops/environment-variables/#server-configuration_1","title":"Server Configuration","text":"Variable Required Default Description <code>PORT</code> No <code>3000</code> Port for WebRTC server <code>BACKEND_URL</code> No <code>http://localhost:4000/api/webrtc-events</code> Backend API endpoint for session events"},{"location":"ops/environment-variables/#example-set-in-shell-or-process-manager","title":"Example (set in shell or process manager)","text":"<pre><code>PORT=3000\nBACKEND_URL=http://localhost:4000/api/webrtc-events\n</code></pre>"},{"location":"ops/environment-variables/#environment-specific-configurations","title":"Environment-Specific Configurations","text":""},{"location":"ops/environment-variables/#development-local","title":"Development (Local)","text":"<pre><code># Backend\nPORT=4000\nNODE_ENV=development\nRPC_URL=http://localhost:8545\nREDIS_URL=redis://localhost:6379\n\n# Frontend\nNEXT_PUBLIC_SOCKET_URL=http://localhost:4000\nNEXT_PUBLIC_WEBRTC_URL=http://localhost:3000\n\n# WebRTC\nPORT=3000\nBACKEND_URL=http://localhost:4000/api/webrtc-events\n</code></pre>"},{"location":"ops/environment-variables/#production-testnet","title":"Production (Testnet)","text":"<pre><code># Backend\nPORT=4000\nNODE_ENV=production\nRPC_URL=https://eth-sepolia.g.alchemy.com/v2/YOUR_KEY\nREDIS_URL=redis://your-redis-cloud-url:6379\nCORS_ORIGIN=https://your-frontend.vercel.app\n\n# Frontend\nNEXT_PUBLIC_SOCKET_URL=https://your-backend.railway.app\nNEXT_PUBLIC_WEBRTC_URL=https://your-webrtc.railway.app\nNEXT_PUBLIC_ALCHEMY_API_KEY=your_alchemy_api_key\n\n# WebRTC\nPORT=3000\nBACKEND_URL=https://your-backend.railway.app/api/webrtc-events\n</code></pre>"},{"location":"ops/environment-variables/#security-best-practices","title":"Security Best Practices","text":""},{"location":"ops/environment-variables/#never-commit-these-to-git","title":"Never Commit These to Git","text":"<ul> <li>\u274c Private keys (<code>BACKEND_PRIVATE_KEY</code>, <code>DEPLOYER_PRIVATE_KEY</code>)</li> <li>\u274c API keys (<code>ALCHEMY_API_KEY</code>, <code>ETHERSCAN_API_KEY</code>)</li> <li>\u274c Client IDs (<code>THIRDWEB_CLIENT_ID</code>, <code>WALLET_CONNECT_PROJECT_ID</code>)</li> <li>\u274c Production Redis URLs with credentials</li> </ul>"},{"location":"ops/environment-variables/#use-gitignore","title":"Use <code>.gitignore</code>","text":"<p>Ensure these are in <code>.gitignore</code>: <pre><code>.env\n.env.local\n.env.*.local\n</code></pre></p>"},{"location":"ops/environment-variables/#production-secrets-management","title":"Production Secrets Management","text":"<p>For production, use:</p> <ul> <li>Vercel: Environment Variables in project settings</li> <li>Railway: Environment Variables in service settings</li> <li>Render: Environment Variables in service settings</li> <li>AWS: AWS Secrets Manager</li> <li>GCP: Secret Manager</li> <li>Azure: Key Vault</li> </ul>"},{"location":"ops/environment-variables/#rotate-keys-regularly","title":"Rotate Keys Regularly","text":"<ul> <li>Rotate API keys every 90 days</li> <li>Never reuse private keys across environments</li> <li>Use different keys for dev/staging/production</li> </ul>"},{"location":"ops/environment-variables/#troubleshooting","title":"Troubleshooting","text":""},{"location":"ops/environment-variables/#backend-cant-connect-to-redis","title":"Backend Can't Connect to Redis","text":"<p>Error: <code>Redis connection failed</code></p> <p>Solution:</p> <ol> <li>Check Redis is running: <code>redis-cli ping</code></li> <li>Verify <code>REDIS_URL</code> is correct</li> <li>Check firewall/network settings</li> </ol>"},{"location":"ops/environment-variables/#frontend-cant-connect-to-backend","title":"Frontend Can't Connect to Backend","text":"<p>Error: <code>Socket.io connection failed</code></p> <p>Solution:</p> <ol> <li>Check <code>NEXT_PUBLIC_SOCKET_URL</code> matches backend URL</li> <li>Verify CORS settings in backend</li> <li>Check backend is running: <code>curl http://localhost:4000/health</code></li> </ol>"},{"location":"ops/environment-variables/#smart-contract-deployment-fails","title":"Smart Contract Deployment Fails","text":"<p>Error: <code>Insufficient funds</code> or <code>Invalid API key</code></p> <p>Solution:</p> <ol> <li>Check <code>ALCHEMY_API_KEY</code> is valid</li> <li>Ensure deployer wallet has testnet ETH</li> <li>Verify network configuration in <code>hardhat.config.ts</code></li> </ol>"},{"location":"ops/environment-variables/#webrtc-server-cant-notify-backend","title":"WebRTC Server Can't Notify Backend","text":"<p>Error: <code>Backend notification failed</code></p> <p>Solution:</p> <ol> <li>Check <code>BACKEND_URL</code> is correct</li> <li>Verify backend is running and accessible</li> <li>Check network/firewall settings</li> </ol>"},{"location":"ops/environment-variables/#quick-setup-guide","title":"Quick Setup Guide","text":""},{"location":"ops/environment-variables/#1-clone-repository","title":"1. Clone Repository","text":"<pre><code>git clone https://github.com/aenhsaihan/langdao-ethonline2025.git\ncd langdao-ethonline2025\n</code></pre>"},{"location":"ops/environment-variables/#2-install-node-version","title":"2. Install Node Version","text":"<pre><code>nvm use\n</code></pre>"},{"location":"ops/environment-variables/#3-set-up-backend","title":"3. Set Up Backend","text":"<pre><code>cd backend\ncp .env.example .env\n# Edit .env with your values\nnpm install\n</code></pre>"},{"location":"ops/environment-variables/#4-set-up-frontend","title":"4. Set Up Frontend","text":"<pre><code>cd webapp\nnpm install --legacy-peer-deps\n\ncd packages/nextjs\ncp .env.example .env.local\n# Edit .env.local with your API keys\n</code></pre>"},{"location":"ops/environment-variables/#5-set-up-smart-contracts","title":"5. Set Up Smart Contracts","text":"<pre><code>cd webapp/packages/hardhat\ncp .env.example .env\nyarn generate  # Generate deployer account\n</code></pre>"},{"location":"ops/environment-variables/#6-start-services","title":"6. Start Services","text":"<pre><code># Terminal 1: Local blockchain\ncd webapp/packages/hardhat\nyarn chain\n\n# Terminal 2: Deploy contracts\ncd webapp/packages/hardhat\nyarn deploy\n\n# Terminal 3: Redis\nredis-server\n\n# Terminal 4: Backend\ncd backend\nnpm run dev\n\n# Terminal 5: WebRTC\ncd backend/webRTC-implementation-LangDAO\nnpm start\n\n# Terminal 6: Frontend\ncd webapp\nyarn start\n</code></pre>"},{"location":"ops/environment-variables/#environment-variables-checklist","title":"Environment Variables Checklist","text":""},{"location":"ops/environment-variables/#before-development","title":"Before Development","text":"<ul> <li> Backend <code>.env</code> created and configured</li> <li> Frontend <code>.env.local</code> created with API keys</li> <li> Hardhat <code>.env</code> created (or use <code>yarn generate</code>)</li> <li> Redis running locally</li> <li> All API keys obtained (Alchemy, WalletConnect, Thirdweb)</li> </ul>"},{"location":"ops/environment-variables/#before-deployment","title":"Before Deployment","text":"<ul> <li> Production environment variables set in hosting platform</li> <li> Private keys stored securely (not in code)</li> <li> API keys rotated for production</li> <li> CORS origins updated for production URLs</li> <li> Redis URL updated for production instance</li> <li> Contract addresses updated for deployed contracts</li> </ul>"},{"location":"ops/environment-variables/#related-documentation","title":"Related Documentation","text":"<ul> <li>Architecture Overview - System architecture</li> <li>Socket Events Reference - Socket.io events</li> <li>API Reference - HTTP API endpoints</li> </ul> <p>Last Updated: November 10, 2025</p>"},{"location":"product/overview/","title":"Product Overview","text":"<p>LangDAO is a community platform where people use their language and communication skills to teach, guide, translate, and onboard others into Web3 \u2014 and earn crypto for real contribution.</p>"},{"location":"product/overview/#problem","title":"Problem","text":"<ul> <li>Web3 adoption needs human onboarding (live guidance, local language support).</li> <li>Language access is uneven; incentives for helpers are weak or ad hoc.</li> </ul>"},{"location":"product/overview/#solution","title":"Solution","text":"<ul> <li>Live sessions (WebRTC) and wallet-connected rooms.</li> <li>Proof of participation/skill using POAP or lightweight credential NFTs.</li> <li>Micro-rewards for verified tasks: teaching, moderating, translating, or guiding.</li> </ul>"},{"location":"product/overview/#initial-users","title":"Initial Users","text":"<ul> <li>Spanish speakers (teachers/mentors) in LatAm, and global learners seeking human guidance.</li> </ul>"},{"location":"product/overview/#value","title":"Value","text":"<ul> <li>Learners: trusted, human help.</li> <li>Contributors: income + credentials + reputation.</li> <li>Ecosystem: scalable, community-driven onboarding.</li> </ul>"},{"location":"product/roadmap/","title":"Roadmap","text":""},{"location":"product/roadmap/#m1-mvp-completed","title":"M1 \u2014 MVP \u2705 COMPLETED","text":"<p>Status: Completed Timeline: Hackathon phase</p> <p>What Was Built:</p> <ul> <li>\u2705 Real-time student/tutor matching via Socket.io</li> <li>\u2705 Wallet authentication and on-chain registration</li> <li>\u2705 Custom WebRTC video sessions</li> <li>\u2705 Timestamp-based payment system (PYUSD)</li> <li>\u2705 Session lifecycle management</li> <li>\u2705 Smart contract for payments and session tracking</li> </ul> <p>What Works:</p> <ul> <li>Students can search for tutors</li> <li>Tutors can search for students</li> <li>Roulette-style matching (first come, first served)</li> <li>Live video sessions</li> <li>Automatic payment processing</li> <li>Return to search after session ends</li> </ul>"},{"location":"product/roadmap/#m2-polish-credentials-in-progress","title":"M2 \u2014 Polish &amp; Credentials \ud83d\udd04 IN PROGRESS","text":"<p>Target: Q1 2026</p> <p>Goals:</p> <ul> <li>Add POAP/credential minting after sessions</li> <li>Implement heartbeat monitoring for disconnect detection</li> <li>Add session history and analytics</li> <li>Improve language matching (fix string/ID mismatch)</li> <li>Add user profiles and session stats</li> <li>Better error handling and user feedback</li> </ul> <p>Features:</p> <ul> <li>\ud83d\udd04 POAP minting for completed sessions</li> <li>\ud83d\udd04 Heartbeat monitoring (30s intervals)</li> <li>\ud83d\udd04 Session history dashboard</li> <li>\ud83d\udd04 Tutor earnings tracking</li> <li>\ud83d\udd04 Student learning progress</li> <li>\u23f3 Rating/review system</li> </ul>"},{"location":"product/roadmap/#m3-pilot-latam","title":"M3 \u2014 Pilot (LatAm)","text":"<p>Target: Q2 2026</p> <p>Goals:</p> <ul> <li>Launch pilot program in Latin America</li> <li>Onboard vetted Spanish tutors</li> <li>Build community partnerships</li> <li>Gather user feedback</li> <li>Iterate on UX/UI</li> </ul> <p>Features:</p> <ul> <li>DAO-curated tutor vetting</li> <li>Booking/scheduling system</li> <li>Repeat sessions with favorite tutors</li> <li>Community features (forums, groups)</li> <li>Early partnerships with language learning communities</li> </ul>"},{"location":"product/roadmap/#m4-scale","title":"M4 \u2014 Scale","text":"<p>Target: Q3-Q4 2026</p> <p>Goals:</p> <ul> <li>Multi-language expansion</li> <li>Reputation system</li> <li>Advanced tokenomics</li> <li>Mobile app</li> </ul> <p>Features:</p> <ul> <li>Support for 10+ languages</li> <li>Contributor reputation &amp; credentials</li> <li>Advanced matching algorithms</li> <li>Group sessions</li> <li>Mobile apps (iOS/Android)</li> <li>Grants/partners for regional rollouts</li> </ul>"},{"location":"product/roadmap/#future-considerations","title":"Future Considerations","text":"<ul> <li>Recording: Session recording for review</li> <li>Moderation: Content moderation tools</li> <li>AI Features: AI-powered language assessment</li> <li>Gamification: Badges, streaks, achievements</li> <li>Marketplace: Tutor marketplace with profiles</li> <li>Multi-chain: Support for other blockchains</li> </ul>"},{"location":"product/scope-mvp/","title":"MVP Scope","text":""},{"location":"product/scope-mvp/#goal","title":"Goal","text":"<p>Deliver a working platform that proves the core loop: Student finds tutor \u2192 Match confirmed \u2192 Live session \u2192 Payment processed.</p>"},{"location":"product/scope-mvp/#whats-implemented","title":"What's Implemented \u2705","text":""},{"location":"product/scope-mvp/#core-matching-system","title":"Core Matching System","text":"<ul> <li>Real-time matching: Students and tutors can search for each other via Socket.io</li> <li>Roulette-style: Whoever comes online first gets matched</li> <li>Language selection: Match based on language and rate preferences</li> </ul>"},{"location":"product/scope-mvp/#session-management","title":"Session Management","text":"<ul> <li>Wallet authentication: Connect wallet (MetaMask, WalletConnect, etc.)</li> <li>User registration: Register as student or tutor on-chain</li> <li>Session lifecycle: Start session \u2192 WebRTC call \u2192 End session \u2192 Payment</li> </ul>"},{"location":"product/scope-mvp/#payment-system","title":"Payment System","text":"<ul> <li>PYUSD payments: Students deposit PYUSD, tutors receive PYUSD</li> <li>Timestamp-based: Payment = (endTime - startTime) \u00d7 ratePerSecond</li> <li>On-chain settlement: All payments processed via smart contract</li> </ul>"},{"location":"product/scope-mvp/#video-sessions","title":"Video Sessions","text":"<ul> <li>Custom WebRTC: Peer-to-peer video/audio calls</li> <li>Session monitoring: Detect disconnects and end sessions</li> <li>Auto-return: Both parties return to search after session ends</li> </ul>"},{"location":"product/scope-mvp/#descoped-post-mvp","title":"Descoped (Post-MVP)","text":"<ul> <li>POAP/credential minting (moved to roadmap)</li> <li>Booking/scheduling system</li> <li>Full tokenomics and reputation system</li> <li>Multi-language orchestration</li> <li>DAO vetting for tutors</li> <li>Rating/review system</li> </ul>"},{"location":"product/scope-mvp/#success-metrics","title":"Success Metrics","text":"<ul> <li>\u2705 Students can find and match with tutors</li> <li>\u2705 Sessions start and payments are processed on-chain</li> <li>\u2705 Video calls work peer-to-peer</li> <li>\u2705 Tutors receive payment after sessions</li> <li>\u2705 Both parties can return to search after session ends</li> </ul>"},{"location":"product/scope-mvp/#technical-stack","title":"Technical Stack","text":"<ul> <li>Frontend: Next.js + wagmi/viem + Socket.io-client</li> <li>Backend: Express + Socket.io + Redis</li> <li>Video: Custom WebRTC implementation</li> <li>Blockchain: Hardhat + Sepolia testnet</li> <li>Payment Token: PYUSD (PayPal USD)</li> </ul>"},{"location":"product/testbed-latam/","title":"Testbed: Latin America","text":""},{"location":"product/testbed-latam/#why-latam-first","title":"Why LatAm first","text":"<ul> <li>High Spanish/Portuguese language density</li> <li>Strong student demand from North America</li> <li>Remittance culture + mobile-first adoption</li> </ul>"},{"location":"product/testbed-latam/#risks-mitigations","title":"Risks &amp; Mitigations","text":"<ul> <li>Payments/ramps: start testnet + stablecoins; explore local partners.</li> <li>Connectivity: mobile-friendly flows; low-bandwidth options.</li> <li>Trust: verifiable credentials; community moderation.</li> </ul>"},{"location":"product/testbed-latam/#success-criteria","title":"Success Criteria","text":"<ul> <li>Repeat instructors</li> <li>Session completion &amp; credential claims</li> <li>Community partnerships formed</li> </ul>"},{"location":"project/audit/","title":"LangDAO Project Audit - November 2025","text":""},{"location":"project/audit/#executive-summary","title":"Executive Summary","text":"<p>This audit reviews the current state of the LangDAO project to identify what's been built, what's outdated, and what needs updating.</p> <p>Status: MVP is partially implemented with core matching and session flow working. Documentation is outdated and doesn't reflect actual implementation.</p>"},{"location":"project/audit/#whats-working-implemented","title":"\ud83d\udfe2 What's Working (Implemented)","text":""},{"location":"project/audit/#backend-nodejs-socketio-redis","title":"Backend (Node.js + Socket.io + Redis)","text":"<ul> <li>\u2705 Real-time matching system - Students and tutors can find each other via Socket.io</li> <li>\u2705 Redis-based state management - Session data, tutor availability, pending requests</li> <li>\u2705 Rate limiting - Socket and HTTP endpoint protection</li> <li>\u2705 WebRTC integration - Session end events from video calls trigger blockchain transactions</li> <li>\u2705 Session lifecycle - Full flow from request \u2192 match \u2192 session start \u2192 session end</li> </ul>"},{"location":"project/audit/#frontend-nextjs-scaffold-eth-2","title":"Frontend (Next.js + Scaffold-ETH 2)","text":"<ul> <li>\u2705 Wallet connection - WalletConnect integration</li> <li>\u2705 Student flow - <code>/find-tutor</code> page for requesting tutors</li> <li>\u2705 Tutor flow - <code>/tutor</code> page for setting availability</li> <li>\u2705 Dashboard - Basic user dashboard</li> <li>\u2705 Socket.io client - Real-time communication with backend</li> </ul>"},{"location":"project/audit/#smart-contracts-hardhat","title":"Smart Contracts (Hardhat)","text":"<ul> <li>\u2705 LangDAO contract - Session management, payments, language registration</li> <li>\u2705 Local blockchain - Hardhat network for development</li> <li>\u2705 Deployment scripts - Automated contract deployment</li> </ul>"},{"location":"project/audit/#infrastructure","title":"Infrastructure","text":"<ul> <li>\u2705 Redis - Session state and caching</li> <li>\u2705 WebRTC server - Separate video call server (in <code>backend/webRTC-implementation-LangDAO/</code>)</li> <li>\u2705 Documentation site - MkDocs setup (though content is outdated)</li> </ul>"},{"location":"project/audit/#whats-partially-implemented","title":"\ud83d\udfe1 What's Partially Implemented","text":""},{"location":"project/audit/#payment-system","title":"Payment System","text":"<ul> <li>Documented: Superfluid/Sablier integration with per-second streaming</li> <li>Reality: Custom timestamp-based payment system in smart contract</li> <li>Students deposit PYUSD into contract</li> <li><code>startSession()</code> records start timestamp</li> <li><code>endSession()</code> calculates duration and pays tutor based on <code>duration * ratePerSecond</code></li> <li>No external streaming protocol needed</li> <li>Status: \u2705 Implemented and working (simpler than documented)</li> </ul>"},{"location":"project/audit/#credentials-poapsbt","title":"Credentials (POAP/SBT)","text":"<ul> <li>Documented: Automatic POAP minting after sessions</li> <li>Reality: Not found in codebase</li> <li>Status: Not implemented yet</li> </ul>"},{"location":"project/audit/#language-matching","title":"Language Matching","text":"<ul> <li>Issue: Mismatch between frontend (lowercase codes like \"spanish\"), backend (string matching), and smart contract (numeric IDs like 1, 2, 3)</li> <li>Workaround: <code>LANGUAGE_MATCHING_FIX.md</code> documents current approach</li> <li>Status: Works but needs proper fix (see recommendations)</li> </ul>"},{"location":"project/audit/#heartbeat-monitoring","title":"Heartbeat Monitoring","text":"<ul> <li>Documented: 5-second heartbeat pings to detect disconnects</li> <li>Reality: WebRTC server sends events, but heartbeat implementation unclear</li> <li>Status: Needs verification</li> </ul>"},{"location":"project/audit/#whats-outdated-or-missing","title":"\ud83d\udd34 What's Outdated or Missing","text":""},{"location":"project/audit/#documentation-issues","title":"Documentation Issues","text":""},{"location":"project/audit/#1-architecture-docs-dont-match-reality","title":"1. Architecture Docs Don't Match Reality","text":"<p>File: <code>docs/tech/architecture.md</code></p> <p>Documented:</p> <ul> <li>Complex flow with Matchmaker API, Heartbeat Service, Relayer Bot, Payment Controller</li> <li>Superfluid streaming with FlowOperator permissions</li> <li>DAO vetting for SBT credentials</li> <li>Booking system with calendar integration</li> </ul> <p>Reality:</p> <ul> <li>Simple Socket.io matching (no separate Matchmaker API)</li> <li>No Relayer Bot (backend calls contracts directly)</li> <li>No booking system implemented</li> <li>No DAO vetting system</li> <li>No calendar integration</li> </ul> <p>Action Needed: Rewrite architecture doc to reflect actual implementation</p>"},{"location":"project/audit/#2-empty-spec-files","title":"2. Empty Spec Files","text":"<p>Files: <code>specs/prd.md</code>, <code>specs/metrics-kpi.smd</code>, <code>design/user-flows.md</code></p> <p>Status: All empty Action Needed: Either populate or delete these files</p>"},{"location":"project/audit/#3-mvp-scope-is-vague","title":"3. MVP Scope is Vague","text":"<p>File: <code>docs/product/scope-mvp.md</code></p> <p>Issue: Says \"clickable + minimally on-chain\" but doesn't specify what's actually built Action Needed: Update with actual implemented features</p>"},{"location":"project/audit/#4-integration-docs-are-incomplete","title":"4. Integration Docs Are Incomplete","text":"<p>File: <code>docs/tech/integrations.md</code></p> <p>Listed but not implemented: - Chainlink (not used) - IPFS/Arweave (not used) - POAP (not implemented)</p> <p>Action Needed: Update to show only what's actually integrated</p>"},{"location":"project/audit/#missing-documentation","title":"Missing Documentation","text":"<ol> <li>No API documentation - Backend endpoints not documented</li> <li>No socket event reference - List of all socket events and their payloads</li> <li>No deployment guide - How to deploy to production</li> <li>No testing guide - How to run tests (no tests exist)</li> <li>No troubleshooting guide - Common issues and solutions</li> </ol>"},{"location":"project/audit/#missing-features-documented-but-not-built","title":"Missing Features (Documented but Not Built)","text":"<ol> <li>POAP/Credential Minting - Documented extensively, not implemented</li> <li>Streaming Payments - NOT using Superfluid/Sablier (using custom timestamp-based system instead)</li> <li>Booking System - Documented in architecture, not built</li> <li>DAO Vetting - Documented, not built</li> <li>Rating System - Documented, not built</li> <li>Multi-language Support - Partially implemented (language IDs exist but matching is buggy)</li> </ol>"},{"location":"project/audit/#current-vs-documented-architecture","title":"\ud83d\udcca Current vs Documented Architecture","text":""},{"location":"project/audit/#what-was-documented-complex","title":"What Was Documented (Complex)","text":"<pre><code>Student \u2192 Matchmaker API \u2192 Heartbeat Service \u2192 Relayer Bot \u2192 Payment Controller \u2192 Superfluid\n                \u2193\n            Huddle01 WebRTC\n                \u2193\n         POAP/SBT Credentials\n                \u2193\n         DAO Vetting System\n</code></pre>"},{"location":"project/audit/#what-actually-exists-simple","title":"What Actually Exists (Simple)","text":"<pre><code>Student \u2192 Socket.io Backend \u2192 Redis \u2192 Smart Contract \u2192 Payment\n              \u2193\n          Custom WebRTC\n              \u2193\n          Backend calls endSession()\n</code></pre>"},{"location":"project/audit/#recommendations","title":"\ud83c\udfaf Recommendations","text":""},{"location":"project/audit/#immediate-actions-this-week","title":"Immediate Actions (This Week)","text":"<ol> <li> <p>\u2705 Update README.md - DONE</p> <ul> <li>Removed Superfluid references</li> <li>Updated architecture section</li> <li>Now reflects actual implementation</li> </ul> </li> <li> <p>\u2705 Create Architecture Documentation - DONE</p> <ul> <li>Created <code>docs/architecture/overview.md</code> with complete details</li> <li>Marked old <code>docs/tech/architecture.md</code> as outdated</li> <li>Added warning banner with link to new doc</li> </ul> </li> <li> <p>\u2705 Fix or Delete Empty Files - DONE</p> <ul> <li>Deleted all empty spec and design files</li> <li>Cleaned up root-level test files</li> <li>Kept empty directories for future use</li> </ul> </li> <li> <p>\u23f3 Create Socket Event Reference</p> <ul> <li>Document all socket events with examples</li> <li>Show request/response payloads</li> <li>Add to <code>docs/tech/socket-events.md</code></li> </ul> </li> <li> <p>\u23f3 Document Language Matching Fix</p> <ul> <li>Move <code>LANGUAGE_MATCHING_FIX.md</code> into proper docs</li> <li>Implement one of the recommended fixes</li> <li>Update frontend/backend to use consistent language IDs</li> </ul> </li> </ol>"},{"location":"project/audit/#short-term-next-2-weeks","title":"Short-term (Next 2 Weeks)","text":"<ol> <li> <p>~~Verify Payment Implementation~~ \u2705 COMPLETED</p> <ul> <li>Confirmed: NOT using Superfluid/Sablier</li> <li>Using custom timestamp-based payment system</li> <li>Documentation updated accordingly</li> </ul> </li> <li> <p>~~Add API Documentation~~ \u2705 COMPLETED</p> <ul> <li>All HTTP endpoints documented</li> <li>Request/response examples added</li> <li>Created <code>docs/tech/api-reference.md</code></li> </ul> </li> <li> <p>Create Deployment Guide</p> <ul> <li>Document production deployment steps</li> <li>Add environment variable reference</li> <li>Create <code>docs/ops/deployment.md</code></li> </ul> </li> <li> <p>Add Testing</p> <ul> <li>Write basic integration tests for socket events</li> <li>Add contract tests</li> <li>Document how to run tests</li> </ul> </li> </ol>"},{"location":"project/audit/#medium-term-next-month","title":"Medium-term (Next Month)","text":"<ol> <li> <p>Implement or Remove POAP</p> <ul> <li>Either build the POAP minting feature</li> <li>Or remove all references from docs</li> </ul> </li> <li> <p>Standardize Language System</p> <ul> <li>Implement Option 3 from <code>LANGUAGE_MATCHING_FIX.md</code></li> <li>Use language IDs everywhere (frontend, backend, contract)</li> <li>Remove string-based matching</li> </ul> </li> <li> <p>Add Monitoring</p> <ul> <li>Add logging for all socket events</li> <li>Track session metrics (duration, completion rate)</li> <li>Add error tracking (Sentry?)</li> </ul> </li> <li> <p>Security Audit</p> <ul> <li>Review smart contract security</li> <li>Check backend authentication</li> <li>Verify rate limiting is sufficient</li> </ul> </li> </ol>"},{"location":"project/audit/#file-cleanup-recommendations","title":"\ud83d\udcc1 File Cleanup Recommendations","text":""},{"location":"project/audit/#delete-empty-or-outdated-completed","title":"~~Delete (Empty or Outdated)~~ \u2705 COMPLETED","text":"<ul> <li>~~<code>specs/prd.md</code>~~ (deleted)</li> <li>~~<code>specs/metrics-kpi.smd</code>~~ (deleted)</li> <li>~~<code>design/user-flows.md</code>~~ (deleted)</li> <li>~~<code>socket-test.html</code>~~ (deleted)</li> <li>~~<code>test-socket.js</code>~~ (deleted)</li> <li><code>design/wireframes/</code> (empty directory - kept for future)</li> <li><code>specs/</code> (empty directory - kept for future)</li> </ul>"},{"location":"project/audit/#move-to-archive","title":"Move to Archive","text":"<ul> <li>~~<code>docs/adr/0001-huddle01.md</code>~~ - Updated with superseded status (Huddle01 didn't work, using custom WebRTC)</li> <li><code>docs/product/testbed-latam.md</code> (if still relevant, keep; if not, archive)</li> <li><code>docs/research/assumptions.md</code> (move to archive if outdated)</li> </ul>"},{"location":"project/audit/#update-outdated-content","title":"Update (Outdated Content)","text":"<ul> <li><code>docs/tech/architecture.md</code> (major rewrite needed)</li> <li><code>docs/tech/integrations.md</code> (remove unimplemented integrations)</li> <li><code>docs/product/scope-mvp.md</code> (update with actual scope)</li> <li><code>docs/product/roadmap.md</code> (update milestones)</li> <li><code>README.md</code> (simplify, remove unimplemented features)</li> </ul>"},{"location":"project/audit/#create-missing-documentation","title":"Create (Missing Documentation)","text":"<ul> <li><code>docs/tech/socket-events.md</code> (socket event reference)</li> <li><code>docs/tech/api-reference.md</code> (HTTP API docs)</li> <li><code>docs/ops/deployment.md</code> (deployment guide)</li> <li><code>docs/dev/testing.md</code> (testing guide)</li> <li><code>docs/dev/troubleshooting.md</code> (common issues)</li> </ul>"},{"location":"project/audit/#questions-to-answer","title":"\ud83d\udd0d Questions to Answer","text":"<p>Before updating docs, clarify these implementation details:</p> <ol> <li> <p>~~Is Superfluid/Sablier actually integrated?~~ \u2705 ANSWERED</p> <ul> <li>No external streaming protocol used</li> <li>Custom timestamp-based payment in LangDAO.sol</li> <li>Payment = <code>(endTime - startTime) * ratePerSecond</code></li> <li>Simpler and more reliable than Superfluid</li> </ul> </li> <li> <p>What's the actual session lifecycle?</p> <ul> <li>Student requests \u2192 Tutor accepts \u2192 ??? \u2192 Session starts \u2192 ??? \u2192 Session ends</li> <li>Fill in the gaps with actual implementation</li> </ul> </li> <li> <p>How does WebRTC integration work?</p> <ul> <li>What events does the WebRTC server send?</li> <li>How does backend know when to call <code>endSession()</code>?</li> <li>Is heartbeat monitoring actually implemented?</li> </ul> </li> <li> <p>What's the language matching logic?</p> <ul> <li>Frontend sends what format?</li> <li>Backend stores what format?</li> <li>Contract expects what format?</li> <li>How are they mapped?</li> </ul> </li> <li> <p>What's deployed vs local-only?</p> <ul> <li>Is there a production deployment?</li> <li>What services are running where?</li> <li>What's the deployment architecture?</li> </ul> </li> </ol>"},{"location":"project/audit/#next-steps","title":"\ud83d\udcdd Next Steps","text":"<ol> <li>Review this audit - Confirm accuracy of findings</li> <li>Answer the questions - Clarify implementation details</li> <li>Prioritize updates - Decide what to fix first</li> <li>Create issues - Track each documentation update</li> <li>Update incrementally - Don't try to fix everything at once</li> </ol>"},{"location":"project/audit/#summary","title":"Summary","text":"<p>Good news: The core MVP is working - students can find tutors, sessions can start/end, payments happen.</p> <p>Bad news: Documentation is significantly out of sync with reality. Many documented features don't exist, and actual implementation isn't documented.</p> <p>Priority: Update docs to reflect reality before adding new features. This will prevent confusion and make onboarding new contributors easier.</p>"},{"location":"project/cleanup-summary/","title":"Documentation Cleanup Summary - November 10, 2025","text":""},{"location":"project/cleanup-summary/#what-we-did","title":"What We Did","text":""},{"location":"project/cleanup-summary/#1-audited-the-project","title":"1. Audited the Project \u2705","text":"<ul> <li>Created <code>PROJECT_AUDIT.md</code> with comprehensive analysis</li> <li>Identified what's working vs what's documented</li> <li>Found major discrepancy: docs describe Superfluid/complex architecture, reality is simpler custom system</li> </ul>"},{"location":"project/cleanup-summary/#2-documented-actual-architecture","title":"2. Documented Actual Architecture \u2705","text":"<ul> <li>Created <code>docs/architecture/overview.md</code> - complete, accurate documentation</li> <li>Covers real tech stack: Socket.io, Redis, custom timestamp-based payments</li> <li>Includes user flows, payment details, environment variables</li> <li>Documents known issues and workarounds</li> </ul>"},{"location":"project/cleanup-summary/#3-updated-existing-docs","title":"3. Updated Existing Docs \u2705","text":"<ul> <li>README.md - Removed Superfluid, updated architecture section</li> <li>docs/tech/integrations.md - Removed unimplemented integrations, added status indicators</li> <li>docs/tech/architecture.md - Added warning banner pointing to new doc</li> </ul>"},{"location":"project/cleanup-summary/#4-cleaned-up-empty-files","title":"4. Cleaned Up Empty Files \u2705","text":"<p>Deleted: - <code>specs/prd.md</code> (empty) - <code>specs/metrics-kpi.smd</code> (empty) - <code>design/user-flows.md</code> (empty) - <code>socket-test.html</code> (root-level test file) - <code>test-socket.js</code> (root-level test file)</p> <p>Kept (for future use): - <code>specs/</code> directory (empty but may be used later) - <code>design/wireframes/</code> directory (empty but may be used later)</p>"},{"location":"project/cleanup-summary/#5-created-status-tracking","title":"5. Created Status Tracking \u2705","text":"<ul> <li><code>DOCUMENTATION_STATUS.md</code> - Quick reference for doc accuracy</li> <li><code>CLEANUP_SUMMARY.md</code> - This file, summarizing the cleanup</li> </ul>"},{"location":"project/cleanup-summary/#key-findings","title":"Key Findings","text":""},{"location":"project/cleanup-summary/#payment-system","title":"Payment System","text":"<p>Documented: Superfluid/Sablier streaming payments with FlowOperator, Relayer Bot, etc.</p> <p>Reality: Custom timestamp-based system in LangDAO.sol <pre><code>// Simple and effective:\nuint256 duration = endTime - startTime;\nuint256 payment = duration * ratePerSecond;\nIERC20(PYUSD_TOKEN).transfer(tutor, payment);\n</code></pre></p> <p>Why the change: Simpler, more reliable, easier to audit, lower gas costs.</p>"},{"location":"project/cleanup-summary/#architecture","title":"Architecture","text":"<p>Documented: Complex system with separate Matchmaker API, Heartbeat Service, Relayer Bot, Payment Controller</p> <p>Reality: Simple Socket.io backend that handles matching and calls smart contract directly</p> <p>Why the change: Faster to build MVP, easier to maintain, fewer moving parts.</p>"},{"location":"project/cleanup-summary/#what-actually-works","title":"What Actually Works","text":"<ul> <li>\u2705 Real-time student/tutor matching via Socket.io</li> <li>\u2705 Video sessions via custom WebRTC implementation</li> <li>\u2705 Timestamp-based payments via custom smart contract</li> <li>\u2705 Full session lifecycle from request to payment</li> <li>\u2705 PYUSD token integration on Sepolia</li> </ul>"},{"location":"project/cleanup-summary/#whats-not-implemented-yet","title":"What's Not Implemented (Yet)","text":"<ul> <li>\u274c POAP/credential minting</li> <li>\u274c Booking/calendar system</li> <li>\u274c DAO vetting for tutors</li> <li>\u274c Rating system</li> <li>\u274c Reputation tracking</li> </ul>"},{"location":"project/cleanup-summary/#files-created","title":"Files Created","text":"<ol> <li> <p><code>docs/project/audit.md</code> (4.5 KB)</p> <ul> <li>Comprehensive audit of current state</li> <li>What's working, what's outdated, what's missing</li> <li>Recommendations for next steps</li> </ul> </li> <li> <p><code>docs/architecture/overview.md</code> (18 KB)</p> <ul> <li>Complete, accurate architecture documentation</li> <li>User flows, payment details, security considerations</li> <li>Environment variables, deployment info</li> <li>Known issues and workarounds</li> </ul> </li> <li> <p><code>docs/project/documentation-status.md</code> (2 KB)</p> <ul> <li>Quick reference for doc accuracy</li> <li>Priority actions checklist</li> <li>What to work on next</li> </ul> </li> <li> <p><code>docs/project/cleanup-summary.md</code> (This file)</p> <ul> <li>Summary of cleanup work</li> <li>Key findings and changes</li> </ul> </li> </ol>"},{"location":"project/cleanup-summary/#impact","title":"Impact","text":""},{"location":"project/cleanup-summary/#before-cleanup","title":"Before Cleanup","text":"<ul> <li>5 empty files cluttering the repo</li> <li>2 root-level test files</li> <li>Major docs describing unimplemented features</li> <li>Confusion about payment system (Superfluid vs custom)</li> <li>No clear picture of what's actually built</li> </ul>"},{"location":"project/cleanup-summary/#after-cleanup","title":"After Cleanup","text":"<ul> <li>All empty files removed</li> <li>Clear documentation of actual implementation</li> <li>Outdated docs marked with warnings</li> <li>New comprehensive architecture doc</li> <li>Easy to onboard new contributors</li> </ul>"},{"location":"project/cleanup-summary/#next-steps","title":"Next Steps","text":""},{"location":"project/cleanup-summary/#high-priority","title":"High Priority","text":"<ol> <li> <p>Create Socket Event Reference (<code>docs/tech/socket-events.md</code>)</p> <ul> <li>Document all 15+ socket events</li> <li>Include request/response examples</li> <li>Add error cases</li> </ul> </li> <li> <p>Fix Language Matching</p> <ul> <li>Implement Option 3 from <code>LANGUAGE_MATCHING_FIX.md</code></li> <li>Use language IDs everywhere (frontend, backend, contract)</li> <li>Remove string-based matching</li> </ul> </li> <li> <p>Update MVP Scope Doc (<code>docs/product/scope-mvp.md</code>)</p> <ul> <li>List actual implemented features</li> <li>Remove references to unimplemented features</li> <li>Add success metrics from real usage</li> </ul> </li> </ol>"},{"location":"project/cleanup-summary/#medium-priority","title":"Medium Priority","text":"<ol> <li> <p>Create API Reference (<code>docs/tech/api-reference.md</code>)</p> <ul> <li>Document HTTP endpoints</li> <li>Include request/response examples</li> <li>Add authentication details</li> </ul> </li> <li> <p>Add Deployment Guide (<code>docs/ops/deployment.md</code>)</p> <ul> <li>Production deployment steps</li> <li>Environment variable reference</li> <li>Service configuration</li> </ul> </li> <li> <p>Add Testing Guide (<code>docs/dev/testing.md</code>)</p> <ul> <li>How to run manual tests</li> <li>How to add automated tests</li> <li>Test scenarios and expected results</li> </ul> </li> </ol>"},{"location":"project/cleanup-summary/#low-priority","title":"Low Priority","text":"<ol> <li> <p>Create Troubleshooting Guide (<code>docs/dev/troubleshooting.md</code>)</p> <ul> <li>Common issues and solutions</li> <li>Debug tips</li> <li>FAQ</li> </ul> </li> <li> <p>Add Contributing Guide (<code>docs/dev/contributing.md</code>)</p> <ul> <li>How to set up dev environment</li> <li>Code style guidelines</li> <li>PR process</li> </ul> </li> </ol>"},{"location":"project/cleanup-summary/#metrics","title":"Metrics","text":"<ul> <li>Files deleted: 5</li> <li>Files created: 4</li> <li>Files updated: 4</li> <li>Lines of documentation added: ~1,200</li> <li>Outdated references removed: 10+</li> <li>Time saved for future contributors: Significant (clear docs = faster onboarding)</li> </ul>"},{"location":"project/cleanup-summary/#lessons-learned","title":"Lessons Learned","text":"<ol> <li>Documentation drift is real - As implementation evolves, docs get stale quickly</li> <li>Simpler is often better - Custom payment system is easier than Superfluid integration</li> <li>Empty files are noise - Better to delete than keep \"for later\"</li> <li>Mark outdated docs clearly - Don't just leave them to confuse people</li> <li>Actual architecture docs are valuable - Saves hours of code reading</li> </ol>"},{"location":"project/cleanup-summary/#conclusion","title":"Conclusion","text":"<p>The LangDAO project has a working MVP with core functionality implemented. The main issue was documentation being out of sync with reality. </p> <p>This cleanup provides:</p> <ul> <li>\u2705 Clear picture of what's actually built</li> <li>\u2705 Accurate technical documentation</li> <li>\u2705 Roadmap for what's next</li> <li>\u2705 Clean, organized repo</li> </ul> <p>The project is now ready for:</p> <ul> <li>Testing with real users</li> <li>Adding new features</li> <li>Onboarding contributors</li> <li>Iterating on the MVP</li> </ul> <p>Total cleanup time: ~2 hours Impact: High - Clear docs enable faster development and better collaboration</p>"},{"location":"project/documentation-reorganization/","title":"Documentation Reorganization - November 10, 2025","text":""},{"location":"project/documentation-reorganization/#summary","title":"Summary","text":"<p>Reorganized all documentation files from the root directory into proper subdirectories within <code>docs/</code> for better organization and maintainability.</p>"},{"location":"project/documentation-reorganization/#what-changed","title":"What Changed","text":""},{"location":"project/documentation-reorganization/#before-root-directory-clutter","title":"Before (Root Directory Clutter)","text":"<pre><code>root/\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 CONTRIBUTING.md\n\u251c\u2500\u2500 CODE_OF_CONDUCT.md\n\u251c\u2500\u2500 SECURITY.md\n\u251c\u2500\u2500 ACTUAL_ARCHITECTURE.md          \u274c Should be in docs/\n\u251c\u2500\u2500 PROJECT_AUDIT.md                \u274c Should be in docs/\n\u251c\u2500\u2500 CLEANUP_SUMMARY.md              \u274c Should be in docs/\n\u251c\u2500\u2500 DOCUMENTATION_STATUS.md         \u274c Should be in docs/\n\u251c\u2500\u2500 LANGUAGE_MATCHING_FIX.md        \u274c Should be in docs/\n\u251c\u2500\u2500 WEBRTC_END_SESSION_INTEGRATION.md \u274c Should be in docs/\n\u251c\u2500\u2500 HUDDLE01_TO_WEBRTC_UPDATE.md    \u274c Should be in docs/\n\u2514\u2500\u2500 docs/\n    \u251c\u2500\u2500 product/\n    \u251c\u2500\u2500 tech/\n    \u251c\u2500\u2500 adr/\n    \u2514\u2500\u2500 research/\n</code></pre>"},{"location":"project/documentation-reorganization/#after-clean-organized","title":"After (Clean &amp; Organized)","text":"<pre><code>root/\n\u251c\u2500\u2500 README.md                       \u2705 Essential\n\u251c\u2500\u2500 CONTRIBUTING.md                 \u2705 Essential\n\u251c\u2500\u2500 CODE_OF_CONDUCT.md              \u2705 Essential\n\u251c\u2500\u2500 SECURITY.md                     \u2705 Essential\n\u2514\u2500\u2500 docs/\n    \u251c\u2500\u2500 README.md                   \u2705 NEW - Documentation guide\n    \u251c\u2500\u2500 architecture/\n    \u2502   \u2514\u2500\u2500 overview.md             \u2705 Moved from ACTUAL_ARCHITECTURE.md\n    \u251c\u2500\u2500 guides/\n    \u2502   \u251c\u2500\u2500 language-matching-fix.md \u2705 Moved from LANGUAGE_MATCHING_FIX.md\n    \u2502   \u2514\u2500\u2500 webrtc-integration.md   \u2705 Moved from WEBRTC_END_SESSION_INTEGRATION.md\n    \u251c\u2500\u2500 project/\n    \u2502   \u251c\u2500\u2500 audit.md                \u2705 Moved from PROJECT_AUDIT.md\n    \u2502   \u251c\u2500\u2500 cleanup-summary.md      \u2705 Moved from CLEANUP_SUMMARY.md\n    \u2502   \u251c\u2500\u2500 documentation-status.md \u2705 Moved from DOCUMENTATION_STATUS.md\n    \u2502   \u2514\u2500\u2500 huddle01-to-webrtc.md   \u2705 Moved from HUDDLE01_TO_WEBRTC_UPDATE.md\n    \u251c\u2500\u2500 product/\n    \u251c\u2500\u2500 tech/\n    \u251c\u2500\u2500 adr/\n    \u2514\u2500\u2500 research/\n</code></pre>"},{"location":"project/documentation-reorganization/#files-moved","title":"Files Moved","text":"Old Path New Path Category <code>ACTUAL_ARCHITECTURE.md</code> <code>docs/architecture/overview.md</code> Architecture <code>LANGUAGE_MATCHING_FIX.md</code> <code>docs/guides/language-matching-fix.md</code> Guide <code>WEBRTC_END_SESSION_INTEGRATION.md</code> <code>docs/guides/webrtc-integration.md</code> Guide <code>PROJECT_AUDIT.md</code> <code>docs/project/audit.md</code> Project <code>CLEANUP_SUMMARY.md</code> <code>docs/project/cleanup-summary.md</code> Project <code>DOCUMENTATION_STATUS.md</code> <code>docs/project/documentation-status.md</code> Project <code>HUDDLE01_TO_WEBRTC_UPDATE.md</code> <code>docs/project/huddle01-to-webrtc.md</code> Project"},{"location":"project/documentation-reorganization/#new-directories-created","title":"New Directories Created","text":"<ul> <li><code>docs/architecture/</code> - System architecture documentation</li> <li><code>docs/guides/</code> - How-to guides and tutorials</li> <li><code>docs/project/</code> - Project management and meta-documentation</li> </ul>"},{"location":"project/documentation-reorganization/#files-updated","title":"Files Updated","text":"<p>All internal references to moved files were updated:</p> <ol> <li><code>docs/tech/architecture.md</code> - Updated link to new architecture doc</li> <li><code>docs/project/huddle01-to-webrtc.md</code> - Updated all file references</li> <li><code>docs/project/documentation-status.md</code> - Updated all file paths</li> <li><code>docs/project/audit.md</code> - Updated file references</li> <li><code>docs/project/cleanup-summary.md</code> - Updated file paths</li> <li><code>mkdocs.yml</code> - Added new sections and updated navigation</li> </ol>"},{"location":"project/documentation-reorganization/#new-files-created","title":"New Files Created","text":"<ul> <li><code>docs/README.md</code> - Documentation guide explaining the structure</li> </ul>"},{"location":"project/documentation-reorganization/#benefits","title":"Benefits","text":""},{"location":"project/documentation-reorganization/#1-cleaner-root-directory","title":"1. Cleaner Root Directory","text":"<ul> <li>Only 4 markdown files in root (all essential)</li> <li>Professional appearance</li> <li>Easier to navigate</li> </ul>"},{"location":"project/documentation-reorganization/#2-better-organization","title":"2. Better Organization","text":"<ul> <li>Logical grouping by category</li> <li>Easier to find documentation</li> <li>Clear separation of concerns</li> </ul>"},{"location":"project/documentation-reorganization/#3-scalability","title":"3. Scalability","text":"<ul> <li>Easy to add new docs in appropriate folders</li> <li>Clear conventions for contributors</li> <li>Room to grow without clutter</li> </ul>"},{"location":"project/documentation-reorganization/#4-standard-practice","title":"4. Standard Practice","text":"<ul> <li>Follows common open-source conventions</li> <li>Similar to popular projects (React, Vue, etc.)</li> <li>Easier for new contributors to understand</li> </ul>"},{"location":"project/documentation-reorganization/#documentation-categories","title":"Documentation Categories","text":""},{"location":"project/documentation-reorganization/#architecture-system-design","title":"<code>/architecture</code> - System Design","text":"<p>High-level and detailed architecture documentation. How the system works.</p>"},{"location":"project/documentation-reorganization/#guides-how-to-documentation","title":"<code>/guides</code> - How-To Documentation","text":"<p>Step-by-step guides for specific tasks or issues.</p>"},{"location":"project/documentation-reorganization/#product-product-documentation","title":"<code>/product</code> - Product Documentation","text":"<p>Product vision, roadmap, MVP scope, market strategy.</p>"},{"location":"project/documentation-reorganization/#tech-technical-specifications","title":"<code>/tech</code> - Technical Specifications","text":"<p>Integration details, technical decisions, API specs.</p>"},{"location":"project/documentation-reorganization/#project-project-management","title":"<code>/project</code> - Project Management","text":"<p>Audits, status reports, cleanup summaries, meta-documentation.</p>"},{"location":"project/documentation-reorganization/#research-research-analysis","title":"<code>/research</code> - Research &amp; Analysis","text":"<p>Assumptions, market research, user research.</p>"},{"location":"project/documentation-reorganization/#adr-architecture-decision-records","title":"<code>/adr</code> - Architecture Decision Records","text":"<p>Important technical decisions and their rationale.</p>"},{"location":"project/documentation-reorganization/#mkdocs-navigation","title":"MkDocs Navigation","text":"<p>Updated <code>mkdocs.yml</code> with new structure:</p> <pre><code>nav:\n  - Home: index.md\n  - Architecture:\n      - Overview: architecture/overview.md\n      - Legacy (Outdated): tech/architecture.md\n  - Product: [...]\n  - Guides:\n      - Language Matching Fix: guides/language-matching-fix.md\n      - WebRTC Integration: guides/webrtc-integration.md\n  - Tech: [...]\n  - Project:\n      - Audit: project/audit.md\n      - Cleanup Summary: project/cleanup-summary.md\n      - Documentation Status: project/documentation-status.md\n      - Huddle01 to WebRTC: project/huddle01-to-webrtc.md\n  - Research: [...]\n</code></pre>"},{"location":"project/documentation-reorganization/#migration-checklist","title":"Migration Checklist","text":"<ul> <li>\u2705 Created new directories (<code>architecture/</code>, <code>guides/</code>, <code>project/</code>)</li> <li>\u2705 Moved all 7 files to appropriate locations</li> <li>\u2705 Updated all internal references</li> <li>\u2705 Updated <code>mkdocs.yml</code> navigation</li> <li>\u2705 Created <code>docs/README.md</code> guide</li> <li>\u2705 Verified no broken links</li> <li>\u2705 Tested documentation site builds</li> </ul>"},{"location":"project/documentation-reorganization/#verification","title":"Verification","text":"<pre><code># Check root directory (should only have 4 .md files)\nls -1 *.md\n# Output:\n# CODE_OF_CONDUCT.md\n# CONTRIBUTING.md\n# README.md\n# SECURITY.md\n\n# Check docs structure\ntree docs -L 2\n# Output shows organized structure with all files in place\n</code></pre>"},{"location":"project/documentation-reorganization/#impact","title":"Impact","text":""},{"location":"project/documentation-reorganization/#before","title":"Before","text":"<ul> <li>11 markdown files in root directory</li> <li>Confusing for new contributors</li> <li>Hard to find specific documentation</li> <li>Unprofessional appearance</li> </ul>"},{"location":"project/documentation-reorganization/#after","title":"After","text":"<ul> <li>4 markdown files in root (all essential)</li> <li>Clear, logical organization</li> <li>Easy to find documentation</li> <li>Professional, standard structure</li> </ul>"},{"location":"project/documentation-reorganization/#next-steps","title":"Next Steps","text":"<ol> <li>Add more guides as needed in <code>docs/guides/</code></li> <li>Create API reference in <code>docs/tech/api-reference.md</code></li> <li>Add deployment guide in <code>docs/guides/deployment.md</code></li> <li>Create troubleshooting guide in <code>docs/guides/troubleshooting.md</code></li> </ol>"},{"location":"project/documentation-reorganization/#standards-going-forward","title":"Standards Going Forward","text":"<p>When adding new documentation:</p> <ol> <li>Choose the appropriate directory:</li> <li>Architecture \u2192 <code>docs/architecture/</code></li> <li>How-to guides \u2192 <code>docs/guides/</code></li> <li>Product specs \u2192 <code>docs/product/</code></li> <li>Technical specs \u2192 <code>docs/tech/</code></li> <li> <p>Project management \u2192 <code>docs/project/</code></p> </li> <li> <p>Use descriptive filenames (kebab-case)</p> </li> <li> <p>Update <code>mkdocs.yml</code> navigation</p> </li> <li> <p>Add links from related documents</p> </li> <li> <p>Update <code>docs/README.md</code> if adding a new category</p> </li> </ol>"},{"location":"project/documentation-reorganization/#conclusion","title":"Conclusion","text":"<p>The documentation is now properly organized following industry best practices. The root directory is clean, and all documentation is logically grouped in the <code>docs/</code> folder.</p> <p>This makes the project more professional, easier to navigate, and more welcoming to new contributors.</p> <p>Total files moved: 7 New directories created: 3 Files updated: 6 Time saved for future contributors: Significant</p>"},{"location":"project/documentation-status/","title":"Documentation Status - November 10, 2025","text":"<p>Quick reference for which docs are accurate vs outdated.</p>"},{"location":"project/documentation-status/#accurate-up-to-date","title":"\u2705 Accurate &amp; Up-to-Date","text":"<ul> <li><code>docs/architecture/overview.md</code> - Complete, accurate architecture description</li> <li><code>docs/project/audit.md</code> - Comprehensive audit of current state</li> <li><code>docs/guides/language-matching-fix.md</code> - Known issue and solutions</li> <li><code>docs/guides/webrtc-integration.md</code> - WebRTC integration details</li> <li><code>docs/tech/integrations.md</code> - Updated to reflect reality</li> <li><code>README.md</code> - Updated with correct architecture</li> <li><code>webapp/packages/hardhat/contracts/LangDAO.sol</code> - The source of truth</li> </ul>"},{"location":"project/documentation-status/#outdated-marked-as-such","title":"\u26a0\ufe0f Outdated (Marked as Such)","text":"<ul> <li><code>docs/tech/architecture.md</code> - Describes unimplemented Superfluid/Relayer system</li> <li>Now has warning banner pointing to <code>docs/architecture/overview.md</code></li> <li>Kept for historical reference</li> </ul>"},{"location":"project/documentation-status/#needs-work","title":"\ud83d\udcdd Needs Work","text":"<ul> <li><code>docs/product/scope-mvp.md</code> - Too vague, needs actual feature list</li> <li><code>docs/product/roadmap.md</code> - Needs update with current milestones</li> <li><code>docs/product/overview.md</code> - Accurate but could be more specific</li> </ul>"},{"location":"project/documentation-status/#empty-should-delete-cleaned-up","title":"\ud83d\uddd1\ufe0f ~~Empty / Should Delete~~ \u2705 CLEANED UP","text":"<ul> <li>~~<code>specs/prd.md</code>~~ - Deleted</li> <li>~~<code>specs/metrics-kpi.smd</code>~~ - Deleted</li> <li>~~<code>design/user-flows.md</code>~~ - Deleted</li> <li>~~<code>socket-test.html</code>~~ - Deleted (root-level test file)</li> <li>~~<code>test-socket.js</code>~~ - Deleted (root-level test file)</li> <li><code>design/wireframes/</code> - Empty directory (kept for future use)</li> <li><code>specs/</code> - Empty directory (kept for future use)</li> </ul>"},{"location":"project/documentation-status/#missing-should-create","title":"\ud83d\udccb Missing (Should Create)","text":"<ul> <li><code>docs/tech/socket-events.md</code> - Socket.io event reference</li> <li><code>docs/tech/api-reference.md</code> - HTTP API documentation</li> <li><code>docs/ops/deployment.md</code> - Production deployment guide</li> <li><code>docs/dev/testing.md</code> - How to run tests</li> <li><code>docs/dev/troubleshooting.md</code> - Common issues and solutions</li> <li><code>docs/dev/contributing.md</code> - How to contribute</li> </ul>"},{"location":"project/documentation-status/#priority-actions","title":"\ud83c\udfaf Priority Actions","text":""},{"location":"project/documentation-status/#this-week","title":"This Week","text":"<ol> <li>\u2705 Create <code>docs/architecture/overview.md</code> - DONE</li> <li>\u2705 Update <code>docs/tech/integrations.md</code> - DONE</li> <li>\u2705 Update <code>README.md</code> - DONE</li> <li>\u2705 Mark <code>docs/tech/architecture.md</code> as outdated - DONE</li> <li>\u2705 Delete empty files - DONE</li> <li>\u2705 Remove Huddle01 references, document custom WebRTC - DONE</li> <li>\u2705 Reorganize docs into proper folders - DONE</li> <li>\u23f3 Create socket events reference</li> </ol>"},{"location":"project/documentation-status/#next-week","title":"Next Week","text":"<ol> <li>Update <code>docs/product/scope-mvp.md</code> with actual features</li> <li>Create <code>docs/tech/socket-events.md</code></li> <li>Create <code>docs/tech/api-reference.md</code></li> <li>Add deployment guide</li> </ol>"},{"location":"project/documentation-status/#this-month","title":"This Month","text":"<ol> <li>Add automated tests</li> <li>Create troubleshooting guide</li> <li>Document all environment variables</li> <li>Create contributing guide</li> </ol>"},{"location":"project/documentation-status/#key-insights","title":"Key Insights","text":"<p>What changed from original plan:</p> <ul> <li>\u274c No Superfluid/Sablier \u2192 \u2705 Custom timestamp-based payments</li> <li>\u274c No separate Matchmaker API \u2192 \u2705 Socket.io backend</li> <li>\u274c No Relayer Bot \u2192 \u2705 Backend calls contract directly</li> <li>\u274c No booking system \u2192 \u2705 Roulette matching only (for now)</li> <li>\u274c No POAP/credentials \u2192 \u23f3 Planned for future</li> </ul> <p>Why the changes:</p> <ul> <li>Simpler implementation</li> <li>Easier to debug and maintain</li> <li>Lower gas costs</li> <li>More predictable behavior</li> <li>Faster to build MVP</li> </ul> <p>Result: Working MVP with core functionality, ready for testing and iteration.</p>"},{"location":"project/huddle01-to-webrtc/","title":"Huddle01 \u2192 Custom WebRTC Update","text":"<p>Date: November 10, 2025</p>"},{"location":"project/huddle01-to-webrtc/#summary","title":"Summary","text":"<p>Removed all references to Huddle01 and updated documentation to reflect the actual custom WebRTC implementation.</p>"},{"location":"project/huddle01-to-webrtc/#why-the-change","title":"Why the Change?","text":"<p>Original Plan: Use Huddle01 for decentralized video sessions</p> <p>Reality: Huddle01 integration didn't work for our use case</p> <p>Solution: Built custom WebRTC implementation in <code>backend/webRTC-implementation-LangDAO/</code></p>"},{"location":"project/huddle01-to-webrtc/#files-updated","title":"Files Updated","text":""},{"location":"project/huddle01-to-webrtc/#core-documentation","title":"Core Documentation","text":"<ul> <li>\u2705 <code>docs/architecture/overview.md</code> - Updated all references to WebRTC</li> <li>\u2705 <code>README.md</code> - Changed from \"Huddle01\" to \"Custom WebRTC implementation\"</li> <li>\u2705 <code>docs/project/cleanup-summary.md</code> - Updated tech stack description</li> <li>\u2705 <code>docs/project/audit.md</code> - Updated architecture diagrams</li> </ul>"},{"location":"project/huddle01-to-webrtc/#product-docs","title":"Product Docs","text":"<ul> <li>\u2705 <code>docs/product/overview.md</code> - Changed \"Huddle01\" to \"WebRTC\"</li> <li>\u2705 <code>docs/product/scope-mvp.md</code> - Updated session description</li> <li>\u2705 <code>docs/product/roadmap.md</code> - Updated M1 milestone</li> <li>\u2705 <code>docs/index.md</code> - Updated core integrations list</li> </ul>"},{"location":"project/huddle01-to-webrtc/#technical-docs","title":"Technical Docs","text":"<ul> <li>\u2705 <code>docs/tech/integrations.md</code> - Replaced Huddle01 section with \"Custom WebRTC Implementation\"</li> <li>\u2705 <code>docs/adr/0001-huddle01.md</code> - Marked as SUPERSEDED, documented actual implementation</li> <li>\u2705 <code>mkdocs.yml</code> - Updated ADR title</li> </ul>"},{"location":"project/huddle01-to-webrtc/#what-changed","title":"What Changed","text":""},{"location":"project/huddle01-to-webrtc/#before","title":"Before","text":"<pre><code>Video: Huddle01 for decentralized sessions\n- Wallet-gated rooms\n- Token gating possible\n- Low-latency P2P\n</code></pre>"},{"location":"project/huddle01-to-webrtc/#after","title":"After","text":"<pre><code>Video: Custom WebRTC implementation\n- Peer-to-peer video calls\n- Session monitoring and disconnect detection\n- Direct integration with backend\n- Full control over session lifecycle\n</code></pre>"},{"location":"project/huddle01-to-webrtc/#benefits-of-custom-webrtc","title":"Benefits of Custom WebRTC","text":"<ol> <li> <p>Better Integration</p> <ul> <li>Tight coupling with session management</li> <li>Direct communication with backend</li> <li>Easier to trigger <code>endSession()</code> on disconnect</li> </ul> </li> <li> <p>More Control</p> <ul> <li>Full control over session lifecycle</li> <li>Custom disconnect detection logic</li> <li>Easier to debug and troubleshoot</li> </ul> </li> <li> <p>Simpler Architecture</p> <ul> <li>No external service dependency</li> <li>No API rate limits or quotas</li> <li>Predictable behavior</li> </ul> </li> <li> <p>Cost Effective</p> <ul> <li>No third-party service fees</li> <li>Self-hosted solution</li> <li>Scales with our infrastructure</li> </ul> </li> </ol>"},{"location":"project/huddle01-to-webrtc/#trade-offs","title":"Trade-offs","text":""},{"location":"project/huddle01-to-webrtc/#advantages","title":"Advantages","text":"<ul> <li>\u2705 Full control over video infrastructure</li> <li>\u2705 Better session lifecycle management</li> <li>\u2705 Reliable disconnect detection</li> <li>\u2705 No external dependencies</li> <li>\u2705 Easier to maintain and debug</li> </ul>"},{"location":"project/huddle01-to-webrtc/#disadvantages","title":"Disadvantages","text":"<ul> <li>\u26a0\ufe0f More code to maintain</li> <li>\u26a0\ufe0f Need to handle scaling ourselves</li> <li>\u26a0\ufe0f No built-in features (recording, moderation, etc.)</li> <li>\u26a0\ufe0f Need to manage TURN servers for NAT traversal</li> </ul>"},{"location":"project/huddle01-to-webrtc/#implementation-details","title":"Implementation Details","text":"<p>Location: <code>backend/webRTC-implementation-LangDAO/</code></p> <p>Key Features:</p> <ul> <li>Peer-to-peer WebRTC connections</li> <li>Session heartbeat monitoring</li> <li>Disconnect detection (2-minute timeout)</li> <li>HTTP POST to backend on session events</li> <li>Integration with <code>endSession()</code> smart contract call</li> </ul> <p>Events Sent to Backend: <pre><code>POST /api/webrtc-events\n{\n  \"type\": \"session-ended\",\n  \"sessionId\": \"req_abc123\",\n  \"endedBy\": \"student\",\n  \"timestamp\": 1234567890\n}\n</code></pre></p>"},{"location":"project/huddle01-to-webrtc/#future-considerations","title":"Future Considerations","text":""},{"location":"project/huddle01-to-webrtc/#short-term","title":"Short-term","text":"<ul> <li>Add TURN server configuration for better connectivity</li> <li>Implement reconnection logic</li> <li>Add connection quality monitoring</li> </ul>"},{"location":"project/huddle01-to-webrtc/#medium-term","title":"Medium-term","text":"<ul> <li>Add session recording capability</li> <li>Implement screen sharing</li> <li>Add chat functionality</li> </ul>"},{"location":"project/huddle01-to-webrtc/#long-term","title":"Long-term","text":"<ul> <li>Evaluate SFU (Selective Forwarding Unit) for group sessions</li> <li>Add moderation features</li> <li>Consider hybrid approach (P2P + SFU)</li> </ul>"},{"location":"project/huddle01-to-webrtc/#documentation-status","title":"Documentation Status","text":"<p>All documentation now accurately reflects the custom WebRTC implementation. No references to Huddle01 remain except in the superseded ADR (kept for historical context).</p>"},{"location":"project/huddle01-to-webrtc/#related-files","title":"Related Files","text":"<ul> <li><code>docs/architecture/overview.md</code> - Complete architecture with WebRTC details</li> <li><code>docs/guides/webrtc-integration.md</code> - WebRTC integration documentation</li> <li><code>docs/adr/0001-huddle01.md</code> - Historical ADR (marked as superseded)</li> </ul> <p>Result: Documentation now matches reality. Custom WebRTC implementation is properly documented and understood.</p>"},{"location":"project/reorganization-complete/","title":"Documentation Reorganization Complete! \u2705","text":"<p>Date: November 10, 2025</p>"},{"location":"project/reorganization-complete/#what-we-did","title":"What We Did","text":"<p>Reorganized all documentation from the root directory into proper subdirectories within <code>docs/</code> following industry best practices.</p>"},{"location":"project/reorganization-complete/#before-after","title":"Before &amp; After","text":""},{"location":"project/reorganization-complete/#root-directory","title":"Root Directory","text":"<p>Before: 11 markdown files After: 4 markdown files (only essentials)</p> <pre><code># Root directory now contains only:\nCODE_OF_CONDUCT.md\nCONTRIBUTING.md\nREADME.md\nSECURITY.md\n</code></pre>"},{"location":"project/reorganization-complete/#documentation-structure","title":"Documentation Structure","text":"<p>Before: Flat structure with files scattered After: Organized into logical categories</p> <pre><code>docs/\n\u251c\u2500\u2500 README.md                          # NEW - Documentation guide\n\u251c\u2500\u2500 architecture/\n\u2502   \u2514\u2500\u2500 overview.md                    # Complete system architecture\n\u251c\u2500\u2500 guides/\n\u2502   \u251c\u2500\u2500 language-matching-fix.md       # How-to guides\n\u2502   \u2514\u2500\u2500 webrtc-integration.md\n\u251c\u2500\u2500 project/\n\u2502   \u251c\u2500\u2500 audit.md                       # Project management docs\n\u2502   \u251c\u2500\u2500 cleanup-summary.md\n\u2502   \u251c\u2500\u2500 documentation-status.md\n\u2502   \u251c\u2500\u2500 documentation-reorganization.md\n\u2502   \u2514\u2500\u2500 huddle01-to-webrtc.md\n\u251c\u2500\u2500 product/                           # Product documentation\n\u251c\u2500\u2500 tech/                              # Technical specs\n\u251c\u2500\u2500 adr/                               # Architecture decisions\n\u2514\u2500\u2500 research/                          # Research &amp; analysis\n</code></pre>"},{"location":"project/reorganization-complete/#files-moved","title":"Files Moved","text":"Old Location New Location <code>ACTUAL_ARCHITECTURE.md</code> <code>docs/architecture/overview.md</code> <code>LANGUAGE_MATCHING_FIX.md</code> <code>docs/guides/language-matching-fix.md</code> <code>WEBRTC_END_SESSION_INTEGRATION.md</code> <code>docs/guides/webrtc-integration.md</code> <code>PROJECT_AUDIT.md</code> <code>docs/project/audit.md</code> <code>CLEANUP_SUMMARY.md</code> <code>docs/project/cleanup-summary.md</code> <code>DOCUMENTATION_STATUS.md</code> <code>docs/project/documentation-status.md</code> <code>HUDDLE01_TO_WEBRTC_UPDATE.md</code> <code>docs/project/huddle01-to-webrtc.md</code>"},{"location":"project/reorganization-complete/#updates-made","title":"Updates Made","text":"<ol> <li>\u2705 Created 3 new directories (<code>architecture/</code>, <code>guides/</code>, <code>project/</code>)</li> <li>\u2705 Moved 7 files to appropriate locations</li> <li>\u2705 Updated all internal references in 6 files</li> <li>\u2705 Updated <code>mkdocs.yml</code> navigation structure</li> <li>\u2705 Created <code>docs/README.md</code> as documentation guide</li> <li>\u2705 Created <code>docs/project/documentation-reorganization.md</code> for details</li> <li>\u2705 Verified no broken links</li> </ol>"},{"location":"project/reorganization-complete/#benefits","title":"Benefits","text":""},{"location":"project/reorganization-complete/#professional-appearance","title":"Professional Appearance","text":"<ul> <li>Clean root directory</li> <li>Follows open-source conventions</li> <li>Easy for new contributors to navigate</li> </ul>"},{"location":"project/reorganization-complete/#better-organization","title":"Better Organization","text":"<ul> <li>Logical grouping by category</li> <li>Clear separation of concerns</li> <li>Scalable structure</li> </ul>"},{"location":"project/reorganization-complete/#improved-discoverability","title":"Improved Discoverability","text":"<ul> <li>Easy to find specific documentation</li> <li>Clear naming conventions</li> <li>Comprehensive README in docs/</li> </ul>"},{"location":"project/reorganization-complete/#quick-links","title":"Quick Links","text":"<p>Start here:</p> <ul> <li>Documentation Guide - Overview of all documentation</li> <li>Architecture Overview - How the system works</li> <li>Documentation Status - What's accurate</li> </ul> <p>For contributors:</p> <ul> <li>Project Audit - What needs work</li> <li>Cleanup Summary - Recent changes</li> <li>Reorganization Details - This reorganization</li> </ul>"},{"location":"project/reorganization-complete/#verification","title":"Verification","text":"<pre><code># Verify clean root\nls -1 *.md\n# Should show only 4 files\n\n# Verify docs structure\ntree docs -L 2\n# Should show organized structure\n\n# Test MkDocs build\nmkdocs build\n# Should build without errors\n</code></pre>"},{"location":"project/reorganization-complete/#standards-going-forward","title":"Standards Going Forward","text":"<p>When adding new documentation:</p> <ol> <li> <p>Choose the right folder:</p> <ul> <li>System design \u2192 <code>docs/architecture/</code></li> <li>How-to guides \u2192 <code>docs/guides/</code></li> <li>Product specs \u2192 <code>docs/product/</code></li> <li>Technical specs \u2192 <code>docs/tech/</code></li> <li>Project management \u2192 <code>docs/project/</code></li> </ul> </li> <li> <p>Use clear filenames:</p> <ul> <li>Use kebab-case: <code>my-document.md</code></li> <li>Be descriptive: <code>webrtc-integration.md</code> not <code>integration.md</code></li> </ul> </li> <li> <p>Update navigation:</p> <ul> <li>Add to <code>mkdocs.yml</code></li> <li>Link from related docs</li> <li>Update <code>docs/README.md</code> if needed</li> </ul> </li> </ol>"},{"location":"project/reorganization-complete/#summary","title":"Summary","text":"<p>The LangDAO documentation is now professionally organized following industry best practices. The root directory is clean with only essential files, and all documentation is logically grouped in the <code>docs/</code> folder.</p> <p>This makes the project more welcoming to contributors and easier to maintain long-term.</p> <p>Files moved: 7 Directories created: 3 References updated: 6 Root directory cleaned: 7 files removed Result: Professional, organized documentation structure \u2728</p>"},{"location":"project/review-pass-2/","title":"Documentation Review - Pass 2","text":"<p>Date: November 10, 2025</p>"},{"location":"project/review-pass-2/#overview","title":"Overview","text":"<p>Second pass review to identify what needs to be updated, clarified, or created based on the actual implementation.</p>"},{"location":"project/review-pass-2/#high-priority-needs-immediate-update","title":"\ud83d\udd34 High Priority - Needs Immediate Update","text":""},{"location":"project/review-pass-2/#1-docsproductscope-mvpmd-inaccurate-scope","title":"1. <code>docs/product/scope-mvp.md</code> - Inaccurate Scope","text":"<p>Current Issues:</p> <ul> <li>Says \"mint credential \u2192 get paid\" but POAP minting is NOT implemented</li> <li>Mentions \"POAP mints\" in success signals but this doesn't exist</li> <li>Too vague about what's actually built</li> </ul> <p>What Actually Works:</p> <ul> <li>\u2705 Wallet connection</li> <li>\u2705 Real-time tutor/student matching via Socket.io</li> <li>\u2705 WebRTC video sessions</li> <li>\u2705 Timestamp-based payments (PYUSD on Sepolia)</li> <li>\u2705 Session lifecycle management</li> <li>\u274c NO POAP/credential minting</li> </ul> <p>Action Needed:</p> <ul> <li>Rewrite to reflect actual MVP features</li> <li>Remove POAP references or mark as \"planned\"</li> <li>Add actual success metrics (sessions completed, payments processed)</li> </ul>"},{"location":"project/review-pass-2/#2-docsproductroadmapmd-outdated-milestones","title":"2. <code>docs/product/roadmap.md</code> - Outdated Milestones","text":"<p>Current Issues:</p> <ul> <li>M1 says \"Hackathon\" but we're past that</li> <li>Vague about what's done vs what's planned</li> <li>No dates or current status</li> </ul> <p>Action Needed:</p> <ul> <li>Update M1 to show what was actually completed</li> <li>Add current status (e.g., \"M1 - COMPLETED\")</li> <li>Add realistic timeline for M2 and M3</li> <li>Clarify what's in progress vs planned</li> </ul>"},{"location":"project/review-pass-2/#3-missing-socket-events-reference","title":"3. Missing: Socket Events Reference","text":"<p>Why Critical: The backend has 15+ socket events that are core to the matching system, but they're not documented anywhere except in code.</p> <p>Events to Document: <pre><code>Tutor Events:\n- tutor:setAvailable\n- tutor:set-unavailable\n- tutor:accept-request\n- tutor:decline-request\n- tutor:withdraw-acceptance\n\nStudent Events:\n- student:request-tutor\n- student:cancel-request\n- student:accept-tutor\n- student:reject-tutor\n- student:entered-room\n- student:rejected-transaction\n\nSession Events:\n- session:started\n- user:connect\n</code></pre></p> <p>Action Needed: - Create <code>docs/tech/socket-events.md</code> - Document each event with:   - Purpose   - Request payload   - Response/emitted events   - Example usage   - Error cases</p>"},{"location":"project/review-pass-2/#medium-priority-should-update-soon","title":"\ud83d\udfe1 Medium Priority - Should Update Soon","text":""},{"location":"project/review-pass-2/#4-docsproductoverviewmd-too-generic","title":"4. <code>docs/product/overview.md</code> - Too Generic","text":"<p>Current Issues:</p> <ul> <li>Mentions \"POAP or lightweight credential NFTs\" (not implemented)</li> <li>Says \"teaching, moderating, translating, or guiding\" but only teaching is implemented</li> <li>No mention of actual tech stack</li> </ul> <p>Action Needed:</p> <ul> <li>Focus on what's actually built (1-on-1 language tutoring)</li> <li>Remove or mark as \"future\" features not yet implemented</li> <li>Add brief tech stack mention</li> </ul>"},{"location":"project/review-pass-2/#5-missing-environment-variables-reference","title":"5. Missing: Environment Variables Reference","text":"<p>Why Important: Multiple <code>.env</code> files across backend, frontend, WebRTC server with no central documentation.</p> <p>Action Needed:</p> <ul> <li>Create <code>docs/ops/environment-variables.md</code></li> <li>Document all env vars for:<ul> <li>Backend</li> <li>Frontend</li> <li>WebRTC server</li> <li>Smart contracts</li> </ul> </li> <li>Include examples and required vs optional</li> </ul>"},{"location":"project/review-pass-2/#6-missing-api-reference","title":"6. Missing: API Reference","text":"<p>Why Important: Backend has HTTP endpoints that aren't documented.</p> <p>Known Endpoints: <pre><code>GET  /health\nPOST /api/webrtc-events\nGET  /api/tutors/*\nGET  /api/students/*\nGET  /api/matching/*\n</code></pre></p> <p>Action Needed:</p> <ul> <li>Create <code>docs/tech/api-reference.md</code></li> <li>Document each endpoint with:</li> <li>Method and path</li> <li>Request body/params</li> <li>Response format</li> <li>Authentication (if any)</li> <li>Example curl commands</li> </ul>"},{"location":"project/review-pass-2/#low-priority-nice-to-have","title":"\ud83d\udfe2 Low Priority - Nice to Have","text":""},{"location":"project/review-pass-2/#7-missing-deployment-guide","title":"7. Missing: Deployment Guide","text":"<p>Action Needed:</p> <ul> <li>Create <code>docs/ops/deployment.md</code></li> <li>Document how to deploy:</li> <li>Frontend (Vercel?)</li> <li>Backend (Railway/Render?)</li> <li>WebRTC server</li> <li>Smart contracts (testnet/mainnet)</li> <li>Include environment setup</li> <li>Add troubleshooting section</li> </ul>"},{"location":"project/review-pass-2/#8-missing-testing-guide","title":"8. Missing: Testing Guide","text":"<p>Action Needed:</p> <ul> <li>Create <code>docs/dev/testing.md</code></li> <li>Document manual testing flow</li> <li>Add instructions for automated tests (when they exist)</li> <li>Include test scenarios and expected results</li> </ul>"},{"location":"project/review-pass-2/#9-missing-troubleshooting-guide","title":"9. Missing: Troubleshooting Guide","text":"<p>Action Needed:</p> <ul> <li>Create <code>docs/dev/troubleshooting.md</code></li> <li>Document common issues:<ul> <li>Socket connection failures</li> <li>WebRTC connection issues</li> <li>Transaction failures</li> <li>Language matching bugs</li> </ul> </li> <li>Add solutions and debug tips</li> </ul>"},{"location":"project/review-pass-2/#10-missing-contributing-guide","title":"10. Missing: Contributing Guide","text":"<p>Action Needed:</p> <ul> <li>Create <code>docs/dev/contributing.md</code> or update root <code>CONTRIBUTING.md</code></li> <li>Document:<ul> <li>How to set up dev environment</li> <li>Code style guidelines</li> <li>PR process</li> <li>How to run tests</li> <li>Where to ask questions</li> </ul> </li> </ul>"},{"location":"project/review-pass-2/#documentation-accuracy-check","title":"\ud83d\udcca Documentation Accuracy Check","text":""},{"location":"project/review-pass-2/#files-that-need-fact-checking","title":"Files That Need Fact-Checking","text":"<ol> <li> <p><code>docs/architecture/overview.md</code></p> <ul> <li>\u2705 Mostly accurate</li> <li>\u26a0\ufe0f Need to verify: Is heartbeat monitoring actually implemented?</li> <li>\u26a0\ufe0f Need to verify: WebRTC disconnect detection details</li> </ul> </li> <li> <p><code>docs/guides/language-matching-fix.md</code></p> <ul> <li>\u2705 Accurate description of the problem</li> <li>\u23f3 Need to implement one of the proposed solutions</li> </ul> </li> <li> <p><code>docs/guides/webrtc-integration.md</code></p> <ul> <li>\u2705 Accurate</li> <li>\u26a0\ufe0f Need to verify: Is heartbeat timeout actually 2 minutes?</li> <li>\u26a0\ufe0f Need to verify: Is grace period actually 30 seconds?</li> </ul> </li> </ol>"},{"location":"project/review-pass-2/#questions-to-answer","title":"\ud83d\udd0d Questions to Answer","text":"<p>Before updating docs, we need to clarify:</p>"},{"location":"project/review-pass-2/#backend-implementation","title":"Backend Implementation","text":"<ol> <li> <p>Is heartbeat monitoring actually implemented?</p> <ul> <li>Check <code>backend/src/server.js</code> for heartbeat logic</li> <li>Check WebRTC server for heartbeat sending</li> </ul> </li> <li> <p>What are the actual HTTP endpoints?</p> <ul> <li>List all routes in <code>backend/src/routes/</code></li> <li>Document their purpose and usage</li> </ul> </li> <li> <p>How does session state management work?</p> <ul> <li>What's stored in Redis?</li> <li>What's the lifecycle of a session?</li> <li>When does data get cleaned up?</li> </ul> </li> </ol>"},{"location":"project/review-pass-2/#frontend-implementation","title":"Frontend Implementation","text":"<ol> <li> <p>What pages actually exist?</p> <ul> <li><code>/</code> - Landing page</li> <li><code>/find-tutor</code> - Student flow</li> <li><code>/tutor</code> - Tutor flow</li> <li><code>/dashboard</code> - User dashboard</li> <li>What else?</li> </ul> </li> <li> <p>What's the actual user flow?</p> <ul> <li>Step-by-step for student</li> <li>Step-by-step for tutor</li> <li>Where do they get stuck?</li> </ul> </li> </ol>"},{"location":"project/review-pass-2/#smart-contract","title":"Smart Contract","text":"<ol> <li> <p>What's the actual payment flow?</p> <ul> <li>How does student deposit funds?</li> <li>How does payment get calculated?</li> <li>How does tutor receive payment?</li> <li>What happens if student runs out of funds mid-session?</li> </ul> </li> <li> <p>What are the gas costs?</p> <ul> <li>registerStudent</li> <li>registerTutor</li> <li>depositFunds</li> <li>startSession</li> <li>endSession</li> </ul> </li> </ol>"},{"location":"project/review-pass-2/#action-plan","title":"\ud83d\udcdd Action Plan","text":""},{"location":"project/review-pass-2/#immediate-todaytomorrow","title":"Immediate (Today/Tomorrow)","text":"<ol> <li>\u2705 Update <code>docs/product/scope-mvp.md</code> with actual features</li> <li>\u2705 Update <code>docs/product/roadmap.md</code> with current status</li> <li>\u2705 Create <code>docs/tech/socket-events.md</code></li> </ol>"},{"location":"project/review-pass-2/#this-week","title":"This Week","text":"<ol> <li>Create <code>docs/ops/environment-variables.md</code></li> <li>Create <code>docs/tech/api-reference.md</code></li> <li>Verify and update architecture details (heartbeat, disconnect detection)</li> </ol>"},{"location":"project/review-pass-2/#next-week","title":"Next Week","text":"<ol> <li>Create <code>docs/ops/deployment.md</code></li> <li>Create <code>docs/dev/testing.md</code></li> <li>Create <code>docs/dev/troubleshooting.md</code></li> <li>Update or create <code>docs/dev/contributing.md</code></li> </ol>"},{"location":"project/review-pass-2/#success-criteria","title":"\ud83c\udfaf Success Criteria","text":"<p>Documentation is complete when:</p> <ul> <li>\u2705 All implemented features are accurately documented</li> <li>\u2705 All unimplemented features are clearly marked as \"planned\"</li> <li>\u2705 New contributors can set up dev environment from docs alone</li> <li>\u2705 All socket events are documented with examples</li> <li>\u2705 All API endpoints are documented</li> <li>\u2705 Common issues have documented solutions</li> <li>\u2705 Deployment process is documented</li> </ul>"},{"location":"project/review-pass-2/#notes","title":"\ud83d\udccc Notes","text":"<ul> <li>Keep docs in sync with code as features are added</li> <li>Mark outdated sections clearly</li> <li>Link related documentation</li> <li>Use examples and code snippets</li> <li>Keep it concise and actionable</li> </ul>"},{"location":"project/todo/","title":"LangDAO - TODO List","text":"<p>Last Updated: November 10, 2025</p> <p>This document tracks features and improvements that need to be implemented.</p>"},{"location":"project/todo/#high-priority-critical","title":"\ud83d\udd34 High Priority (Critical)","text":""},{"location":"project/todo/#1-webrtc-disconnect-detection-auto-end-session","title":"1. WebRTC Disconnect Detection &amp; Auto-End Session","text":"<p>\u26a0\ufe0f CRITICAL: Without this, sessions continue billing even after users disconnect!</p> <p>(See details below in Medium Priority section - moved up to High Priority)</p>"},{"location":"project/todo/#2-end-session-button-in-webrtc-interface","title":"2. End Session Button in WebRTC Interface","text":"<p>Current State: - WebRTC interface has \"End Call\" button - Clicking \"End Call\" only ends the WebRTC connection - Blockchain session continues running (payment keeps accruing!) - Users must manually go back to main app to end blockchain session - No indication that blockchain session is still active</p> <p>Problem: This is a critical UX and payment issue: - Users think they ended the session by clicking \"End Call\" - Payment continues in the background - Users get overcharged - No way to end blockchain session from within video call</p> <p>Desired State: - \"End Session\" button in WebRTC interface - Clicking button ends BOTH WebRTC and blockchain session - Clear confirmation that session ended - Show final cost/duration - Redirect back to main app</p> <p>Changes Needed:</p>"},{"location":"project/todo/#webrtc-client","title":"WebRTC Client","text":"<ul> <li>Add \"End Session\" button (or make existing \"End Call\" button do both)</li> <li>Call backend API endpoint to end blockchain session</li> <li>Show loading state while blockchain tx processes</li> <li>Show confirmation modal with session summary</li> <li>Redirect to main app after confirmation</li> </ul>"},{"location":"project/todo/#backend","title":"Backend","text":"<ul> <li>Add endpoint: <code>POST /api/sessions/:sessionId/end</code></li> <li>Verify session exists and is active</li> <li>Call <code>endSession(tutorAddress)</code> on blockchain</li> <li>Wait for transaction confirmation</li> <li>Return session summary (duration, cost)</li> <li>Clean up Redis state</li> </ul>"},{"location":"project/todo/#webrtc-server","title":"WebRTC Server","text":"<ul> <li>Send session-ended event to backend when user clicks \"End Session\"</li> <li>Include session details for blockchain call</li> </ul> <p>User Flow: 1. User clicks \"End Session\" in WebRTC interface 2. Modal: \"Ending session... Please wait\" 3. Backend calls <code>endSession()</code> on blockchain 4. Transaction confirms 5. Modal: \"Session ended! Duration: 10 min, Cost: 60 PYUSD\" 6. Redirect to dashboard</p> <p>Alternative Approach: Make the existing \"End Call\" button end both: - User clicks \"End Call\" - Confirmation: \"This will end the call and the session. Continue?\" - If yes, end both WebRTC and blockchain - Show summary and redirect</p> <p>Estimated Effort: Small (1-2 days)</p> <p>Priority: \ud83d\udea8 CRITICAL - Users are being overcharged!</p>"},{"location":"project/todo/#3-frontend-cannot-monitor-webrtc-session-status","title":"3. Frontend Cannot Monitor WebRTC Session Status","text":"<p>Current State: - Frontend redirects users to external WebRTC URL (live link) - WebRTC session runs on separate server/domain - Frontend has NO visibility into WebRTC session state - Backend ALSO has NO visibility (WebRTC server runs locally, not accessible) - Neither frontend nor backend knows:   - If user is still in the call   - If call ended   - If user disconnected   - Session duration   - Connection quality - WebRTC server is isolated - can't communicate with backend or frontend</p> <p>Problem: This creates multiple critical issues:</p> <p>Frontend Issues: - Can't show \"Session in Progress\" status - Can't warn user if they navigate away during active session - Can't automatically end blockchain session when WebRTC ends - Can't show real-time session duration/cost - No way to detect if user closed WebRTC tab - Dashboard shows stale session state</p> <p>Backend Issues: - Can't receive disconnect events from live WebRTC server (backend is local, not accessible from live server) - Can't call <code>endSession()</code> when users disconnect - Can't implement heartbeat monitoring - Can't track active sessions - Live WebRTC server can't notify local backend of session events - Payment continues even after call ends</p> <p>Root Cause: Backend and frontend run locally (<code>localhost:4000</code> and <code>localhost:3000</code>) while WebRTC session runs on a live/deployed URL. Local backend/frontend cannot communicate with the live WebRTC server. There's no communication channel between the local development environment and the live WebRTC system.</p> <p>Desired State: - Frontend receives real-time updates from WebRTC session - Shows live session status in dashboard - Can detect when session ends - Can automatically trigger blockchain session end - Shows live duration and cost estimate</p> <p>Possible Solutions:</p>"},{"location":"project/todo/#option-1-websocket-connection","title":"Option 1: WebSocket Connection","text":"<ul> <li>WebRTC server opens WebSocket connection to frontend</li> <li>Sends real-time status updates</li> <li>Frontend subscribes to session events</li> <li>Challenge: CORS, authentication, connection management</li> </ul>"},{"location":"project/todo/#option-2-server-sent-events-sse","title":"Option 2: Server-Sent Events (SSE)","text":"<ul> <li>Frontend opens SSE connection to backend</li> <li>Backend relays WebRTC events to frontend</li> <li>Simpler than WebSocket</li> <li>Challenge: One-way communication only</li> </ul>"},{"location":"project/todo/#option-3-polling","title":"Option 3: Polling","text":"<ul> <li>Frontend polls backend for session status every 5-10 seconds</li> <li>Backend queries WebRTC server or Redis</li> <li>Pros: Simple, no persistent connections</li> <li>Cons: Not real-time, more server load</li> </ul>"},{"location":"project/todo/#option-4-embed-webrtc-in-frontend-recommended","title":"Option 4: Embed WebRTC in Frontend (Recommended)","text":"<ul> <li>Instead of redirecting to external URL, embed WebRTC in iframe or component</li> <li>Frontend has full control over WebRTC session</li> <li>Can listen to all WebRTC events directly</li> <li>Can coordinate WebRTC and blockchain session lifecycle</li> <li>Pros: Best UX, full control, real-time updates</li> <li>Cons: More complex integration</li> </ul> <p>Changes Needed (Option 4 - Recommended):</p>"},{"location":"project/todo/#frontend","title":"Frontend","text":"<ul> <li>Create WebRTC component/page within Next.js app</li> <li>Integrate WebRTC client library directly</li> <li>Listen to WebRTC connection events</li> <li>Show session status in real-time</li> <li>Coordinate \"End Call\" with blockchain <code>endSession()</code></li> <li>Keep user in app (no external redirect)</li> </ul>"},{"location":"project/todo/#webrtc-integration","title":"WebRTC Integration","text":"<ul> <li>Use WebRTC library (simple-peer, PeerJS, or native WebRTC API)</li> <li>Connect to WebRTC signaling server</li> <li>Handle peer connection lifecycle</li> <li>Show video/audio streams in React components</li> </ul>"},{"location":"project/todo/#backend_1","title":"Backend","text":"<ul> <li>WebRTC signaling server (Socket.io for signaling)</li> <li>Coordinate peer connections</li> <li>Track active sessions</li> <li>Send session events to frontend</li> <li>Deploy backend to production so it can communicate with live WebRTC server</li> <li>Configure proper URLs (not localhost)</li> <li>Ensure backend is accessible from WebRTC server</li> </ul> <p>Benefits of Embedding: - \u2705 Frontend knows session status in real-time - \u2705 Can end both WebRTC and blockchain together - \u2705 Better UX (no external redirect) - \u2705 Can show live duration/cost - \u2705 Can prevent navigation during active session - \u2705 Can auto-end blockchain when WebRTC ends</p> <p>Estimated Effort: Large (4-5 days for full integration)</p> <p>Priority: \ud83d\udd34 HIGH - Required for proper session management</p> <p>Alternative Quick Fix: If embedding is too complex right now, implement Option 3 (polling): - Frontend polls backend every 10 seconds - Backend checks Redis for session status - Shows basic status (active/ended) - Effort: Small (1 day) - Note: Still requires backend/frontend to be deployed and accessible!</p> <p>Deployment Requirement: Regardless of which option is chosen, the backend and frontend MUST be deployed to publicly accessible URLs (not localhost) so they can communicate with the live WebRTC server. Currently, backend/frontend run locally while WebRTC is live, preventing any communication.</p>"},{"location":"project/todo/#4-multi-language-support-for-students","title":"4. Multi-Language Support for Students","text":"<p>Current State: - Students can only select ONE target language when registering - <code>Student</code> struct has single <code>uint8 targetLanguage</code> field - Tutors already support multiple languages via mapping</p> <p>Desired State: - Students should be able to select multiple languages they want to learn - Match with tutors who teach any of their target languages</p> <p>Changes Needed:</p>"},{"location":"project/todo/#smart-contract-langdaosol","title":"Smart Contract (<code>LangDAO.sol</code>)","text":"<ul> <li>Change <code>Student</code> struct:</li> <li>Replace <code>uint8 targetLanguage</code> with <code>mapping(uint8 =&gt; bool) targetLanguages</code></li> <li>Update <code>registerStudent()</code> function:</li> <li>Accept <code>uint8[] memory _targetLanguages</code> instead of single language</li> <li>Loop through array and set each language to true in mapping</li> <li>Update <code>getStudentInfo()</code> function:</li> <li>Return array of languages or add new getter function</li> <li>Update <code>canAffordRate()</code> function:</li> <li>Check if tutor teaches any of student's target languages</li> <li>Update <code>hasSufficientBalance()</code> function:</li> <li>Similar language matching logic</li> </ul>"},{"location":"project/todo/#frontend_1","title":"Frontend","text":"<ul> <li>Update student registration UI to allow multiple language selection</li> <li>Update student profile to show all target languages</li> <li>Update matching UI to show which language the match is for</li> </ul>"},{"location":"project/todo/#backend_2","title":"Backend","text":"<ul> <li>Update matching logic to find tutors who teach any of student's languages</li> <li>Update session creation to specify which language the session is for</li> </ul> <p>Estimated Effort: Medium (2-3 days)</p>"},{"location":"project/todo/#medium-priority","title":"\ud83d\udfe1 Medium Priority","text":""},{"location":"project/todo/#5-session-history-analytics","title":"5. Session History &amp; Analytics","text":"<p>Current State: - Sessions are stored on-chain but no UI to view them - No analytics or statistics</p> <p>Desired State: - Students can see their past sessions - Tutors can see their earnings history - Dashboard with statistics</p> <p>Changes Needed: - Create session history page - Add analytics dashboard - Query blockchain for past sessions - Display session details (date, duration, cost, language)</p> <p>Estimated Effort: Medium (3-4 days)</p>"},{"location":"project/todo/#3-webrtc-disconnect-detection-auto-end-session","title":"3. WebRTC Disconnect Detection &amp; Auto-End Session","text":"<p>Current State: - WebRTC server sends some events but disconnect detection is incomplete - Sessions do NOT auto-end when student or tutor drops from call - No heartbeat monitoring implemented - Manual \"End Call\" button works, but connection loss doesn't trigger <code>endSession()</code></p> <p>Desired State: - Detect when either party disconnects from WebRTC session - Automatically call <code>endSession()</code> on blockchain - Heartbeat every 30 seconds to detect stale connections - Grace period (30-60 seconds) for reconnection before ending - Handle all disconnect scenarios:   - Browser closed   - Network loss   - Tab closed   - Computer sleep/crash</p> <p>Changes Needed:</p>"},{"location":"project/todo/#webrtc-client_1","title":"WebRTC Client","text":"<ul> <li>Implement heartbeat ping every 30 seconds</li> <li>Send heartbeat to WebRTC server</li> <li>Detect connection state changes (<code>disconnected</code>, <code>failed</code>, <code>closed</code>)</li> <li>Send disconnect event to WebRTC server</li> </ul>"},{"location":"project/todo/#webrtc-server_1","title":"WebRTC Server","text":"<ul> <li>Track last heartbeat timestamp for each user</li> <li>Monitor for missing heartbeats (&gt;2 minutes = stale)</li> <li>Detect WebRTC peer disconnection events</li> <li>Send disconnect notification to backend immediately</li> <li>Implement grace period before notifying backend</li> </ul>"},{"location":"project/todo/#backend_3","title":"Backend","text":"<ul> <li>Receive disconnect events from WebRTC server</li> <li>Wait for grace period (30-60 seconds) for reconnection</li> <li>If no reconnection, call <code>endSession(tutorAddress)</code> on blockchain</li> <li>Handle both student and tutor disconnects</li> <li>Clean up session state in Redis</li> </ul> <p>Edge Cases to Handle: - Both parties disconnect simultaneously - Reconnection within grace period - Multiple disconnect events for same session - Session already ended manually</p> <p>Related Critical Issue: Currently, there's NO way to end the blockchain session from within the WebRTC interface. If a user clicks \"End Call\" in the WebRTC UI: - \u2705 WebRTC session ends - \u274c Blockchain session continues (payment keeps running!)</p> <p>This means users MUST go back to the main app and manually end the session, which is terrible UX and can lead to overcharging.</p> <p>Solution Needed: - Add \"End Session\" button in WebRTC interface - Button calls backend API to trigger <code>endSession()</code> on blockchain - OR: WebRTC \"End Call\" automatically triggers blockchain session end - Show confirmation that blockchain session ended - Redirect users back to main app after session ends</p> <p>Estimated Effort: Medium (2-3 days)</p> <p>Priority: \ud83d\udea8 CRITICAL - Users are being overcharged!</p>"},{"location":"project/todo/#6-standardize-language-codes-across-web2-and-web3","title":"6. Standardize Language Codes Across Web2 and Web3","text":"<p>Current State: - Frontend (Web2): Uses lowercase string codes (<code>\"spanish\"</code>, <code>\"french\"</code>) - Backend (Web2): Uses string matching for languages - Smart Contract (Web3): Uses numeric IDs (<code>1</code> = Spanish, <code>2</code> = French, etc.) - Socket Events: Mix of strings and IDs - Mismatch causes bugs and requires constant mapping</p> <p>Problem: - Inconsistent language representation across the stack - Frontend sends <code>\"spanish\"</code> \u2192 Backend matches by string \u2192 Must map to ID <code>1</code> for contract - Error-prone conversions at every layer - Hard to maintain (3 different systems) - Bugs when mapping fails - String comparisons are inefficient</p> <p>Desired State: - Single source of truth: Use keccak256 hash of ISO 639-1 codes everywhere - Frontend, backend, and contract all use the same hash values - No conversions needed at any layer - Efficient hash comparison (bytes32) instead of string matching - Direct pass-through of hash values from frontend \u2192 backend \u2192 contract</p> <p>Language Hash Standard (keccak256 of ISO 639-1): <pre><code>// Generate hash from ISO code\nconst languageHash = keccak256(\"es\"); // Spanish\nconst languageHash = keccak256(\"en\"); // English\nconst languageHash = keccak256(\"fr\"); // French\n\n// Example hash values (bytes32):\nkeccak256(\"en\") = 0x559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd\nkeccak256(\"es\") = 0x3e0b1d3e5c4c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c8c\nkeccak256(\"fr\") = 0x...\n... (38 languages total)\n</code></pre></p> <p>Implementation Approach: - Use keccak256 hash of ISO 639-1 codes as the universal identifier - Frontend generates hash: <code>keccak256(\"es\")</code> and uses that everywhere - Backend stores and matches by hash value - Contract compares hash values directly (already does this internally) - Human-readable ISO code only used for display purposes - Hash is the actual data passed between systems</p> <p>Changes Needed:</p>"},{"location":"project/todo/#frontend_2","title":"Frontend","text":"<ul> <li>Add keccak256 hashing utility (use ethers.js or viem)</li> <li>Update <code>LANGUAGES</code> constant to include hash values:   <pre><code>{\n  id: 1,\n  name: \"Spanish\",\n  iso: \"es\",\n  hash: keccak256(\"es\"), // This is what gets used\n  flag: \"\ud83c\uddea\ud83c\uddf8\"\n}\n</code></pre></li> <li>Store language hash in state (not string or numeric ID)</li> <li>Send language hash in all API calls and socket events</li> <li>Display language name in UI but use hash internally</li> <li>Update registration forms to send hash values</li> <li>Update matching UI to use hash values</li> </ul>"},{"location":"project/todo/#backend_4","title":"Backend","text":"<ul> <li>Update matching logic to use language hashes (bytes32)</li> <li>Update Redis storage to use hash values as keys</li> <li>Update socket event handlers to expect hash values</li> <li>Use hash comparison for language matching (exact match, very efficient)</li> <li>Update session storage to use hash values</li> <li>When calling smart contract, pass hash directly (no conversion needed)</li> </ul>"},{"location":"project/todo/#socket-events","title":"Socket Events","text":"<ul> <li>Change all language fields to hash values (bytes32/string)</li> <li><code>tutor:setAvailable</code> \u2192 <code>languageHash: \"0x559aead...\"</code> (keccak256 of ISO code)</li> <li><code>student:request-tutor</code> \u2192 <code>languageHash: \"0x559aead...\"</code></li> <li>Update socket events documentation with hash format</li> </ul>"},{"location":"project/todo/#smart-contract","title":"Smart Contract","text":"<ul> <li>Contract already uses keccak256 hashing internally</li> <li>Can accept hash values directly for comparison</li> <li>May need to add functions that accept bytes32 hash instead of string</li> <li>Or continue using <code>isoToLanguage()</code> but frontend pre-computes the hash</li> <li>Internal numeric IDs can remain for storage efficiency</li> </ul> <p>Migration Strategy: 1. Add hash field alongside existing fields (backward compatible) 2. Update frontend to send both old format and hash (transition period) 3. Update backend to accept both but prefer hash values 4. Remove old string/ID formats once all clients updated 5. Update documentation and socket events reference</p> <p>Example Migration: <pre><code>// Old format\n{ language: \"spanish\", languageId: 1 }\n\n// Transition (send both)\n{ \n  language: \"spanish\",  // deprecated\n  languageId: 1,        // deprecated\n  languageHash: keccak256(\"es\")  // new standard\n}\n\n// Final format\n{ languageHash: keccak256(\"es\") }\n</code></pre></p> <p>Benefits: - \u2705 No more string/ID mapping bugs - \u2705 Single identifier (hash) used across entire stack - \u2705 Efficient comparison (bytes32 hash vs string matching) - \u2705 No conversions needed at any layer - \u2705 Based on ISO 639-1 standard (hash of \"es\", \"en\", etc.) - \u2705 Type-safe (TypeScript can enforce bytes32/hex string format) - \u2705 Gas efficient in smart contract - \u2705 Deterministic (same ISO code always produces same hash) - \u2705 Frontend, backend, and contract speak the same language</p> <p>Estimated Effort: Small-Medium (2-3 days)</p> <p>Priority: \ud83d\udfe1 Medium (fixes bugs, improves maintainability)</p> <p>Reference: See <code>docs/guides/language-matching-fix.md</code> for detailed analysis</p>"},{"location":"project/todo/#low-priority","title":"\ud83d\udfe2 Low Priority","text":""},{"location":"project/todo/#7-poapcredential-minting","title":"7. POAP/Credential Minting","text":"<p>Current State: - Not implemented</p> <p>Desired State: - Mint POAP or credential NFT after session completion - Display in user profile</p> <p>Changes Needed: - Integrate POAP API or create custom NFT - Add minting logic after session ends - Display credentials in dashboard</p> <p>Estimated Effort: Medium (3-4 days)</p>"},{"location":"project/todo/#8-rating-system","title":"8. Rating System","text":"<p>Current State: - Not implemented</p> <p>Desired State: - Students can rate tutors after sessions - Tutors can rate students - Ratings displayed on profiles</p> <p>Changes Needed: - Add rating storage (on-chain or IPFS) - Create rating UI - Display ratings on profiles - Use ratings in matching algorithm</p> <p>Estimated Effort: Medium (3-4 days)</p>"},{"location":"project/todo/#9-bookingscheduling-system","title":"9. Booking/Scheduling System","text":"<p>Current State: - Only roulette-style matching (first come, first served)</p> <p>Desired State: - Students can book tutors for specific times - Calendar integration - Reminders</p> <p>Changes Needed: - Add booking logic to backend - Create calendar UI - Add notification system - Store scheduled sessions</p> <p>Estimated Effort: Large (5-7 days)</p>"},{"location":"project/todo/#10-user-profiles","title":"10. User Profiles","text":"<p>Current State: - Minimal profile (just wallet address)</p> <p>Desired State: - Rich profiles with bio, languages, experience - Profile pictures - Session history - Ratings and reviews</p> <p>Changes Needed: - Add profile storage (IPFS or database) - Create profile UI - Add profile editing</p> <p>Estimated Effort: Medium (3-4 days)</p>"},{"location":"project/todo/#technical-improvements","title":"\ud83d\udd27 Technical Improvements","text":""},{"location":"project/todo/#11-better-balancefund-management-ux","title":"11. Better Balance/Fund Management UX","text":"<p>Current State: - Students must manually deposit PYUSD before sessions - No clear indication of current balance in UI - No warnings when balance is low - No way to estimate session cost before starting - Unclear how much to deposit - No real-time balance updates during session</p> <p>Desired State: - Show current PYUSD balance prominently in dashboard - Estimate session cost based on tutor rate and expected duration - Warn if balance too low for minimum session time - Show \"time remaining\" during session based on current balance - Easy top-up flow during or before session - Transaction history showing deposits and session costs</p> <p>Changes Needed: - Add balance display component in header/dashboard - Add cost estimator: <code>rate \u00d7 duration = estimated cost</code> - Add low balance warnings before starting session - Add real-time balance tracking during active session - Add quick deposit/top-up modal - Add transaction history page</p> <p>Estimated Effort: Medium (2-3 days)</p> <p>Priority: \ud83d\udfe1 Medium (improves UX, prevents confusion)</p>"},{"location":"project/todo/#12-error-messages-user-feedback","title":"12. Error Messages &amp; User Feedback","text":"<p>Current State: - Generic error messages (\"Transaction failed\") - No loading states in many places - Users don't know what's happening during blockchain transactions - Socket connection failures are silent - No feedback when operations succeed</p> <p>Desired State: - Clear, actionable error messages (\"Insufficient PYUSD balance. Please deposit at least 100 PYUSD\") - Loading states for all async operations - Transaction progress indicators (\"Confirming transaction... 1/3 confirmations\") - Connection status indicators - Success confirmations with next steps</p> <p>Changes Needed: - Add toast/notification system (react-hot-toast or similar) - Improve error handling with user-friendly messages - Add loading spinners/skeletons everywhere - Add transaction status tracking component - Add connection status indicator in header - Add success messages with clear next actions</p> <p>Estimated Effort: Small-Medium (2-3 days)</p> <p>Priority: \ud83d\udfe1 Medium (significantly improves UX)</p>"},{"location":"project/todo/#13-code-documentation-comments","title":"13. Code Documentation &amp; Comments","text":"<p>Current State: - Minimal code comments - No JSDoc/TSDoc for functions - Complex logic not explained (especially language matching, session lifecycle) - Hard for new developers (or AI assistants!) to understand codebase - No architecture diagrams in code</p> <p>Desired State: - All exported functions have JSDoc comments - Complex logic explained with inline comments - README in each major directory explaining purpose - Architecture diagrams embedded in code comments - Clear explanation of state management patterns</p> <p>Changes Needed: - Add JSDoc to all exported functions (params, returns, examples) - Add inline comments for complex logic (socket events, matching algorithm) - Create README files for:   - <code>webapp/packages/nextjs/app/</code> - Page structure   - <code>webapp/packages/nextjs/components/</code> - Component library   - <code>backend/src/services/</code> - Service layer   - <code>backend/src/routes/</code> - API routes - Document state management patterns (React hooks, context) - Add mermaid diagrams in comments for complex flows</p> <p>Estimated Effort: Medium (3-4 days)</p> <p>Priority: \ud83d\udfe2 Low (helps maintainability but not user-facing)</p> <p>Note: This would significantly help AI assistants understand the codebase and make better suggestions!</p>"},{"location":"project/todo/#14-add-automated-tests","title":"14. Add Automated Tests","text":"<p>Current State: - No automated tests</p> <p>Desired State: - Smart contract tests (Hardhat) - Backend integration tests (Jest) - Frontend E2E tests (Playwright)</p> <p>Changes Needed: - Write contract tests for all functions - Write backend tests for socket events - Write E2E tests for user flows</p> <p>Estimated Effort: Large (5-7 days)</p>"},{"location":"project/todo/#15-improve-error-handling","title":"15. Improve Error Handling","text":"<p>Current State: - Basic error handling - Not all edge cases covered</p> <p>Desired State: - Comprehensive error handling - User-friendly error messages - Proper error logging</p> <p>Changes Needed: - Add try-catch blocks - Improve error messages - Add error logging service</p> <p>Estimated Effort: Medium (2-3 days)</p>"},{"location":"project/todo/#16-add-deployment-guide","title":"16. Add Deployment Guide","text":"<p>Current State: - No production deployment documentation</p> <p>Desired State: - Complete deployment guide - CI/CD pipeline - Environment setup</p> <p>Changes Needed: - Document deployment steps - Create deployment scripts - Set up CI/CD (GitHub Actions)</p> <p>Estimated Effort: Small (1-2 days)</p>"},{"location":"project/todo/#priority-matrix","title":"\ud83d\udcca Priority Matrix","text":"Priority Feature Effort Impact \ud83d\udd34 CRITICAL Disconnect Detection Medium CRITICAL \ud83d\udd34 CRITICAL End Session in WebRTC Small CRITICAL \ud83d\udd34 High Frontend Monitor WebRTC Large High \ud83d\udd34 High Multi-Language Support Medium High \ud83d\udfe1 Medium Session History Medium Medium \ud83d\udfe1 Medium Language Matching Fix Small Medium \ud83d\udfe2 Low POAP Minting Medium Low \ud83d\udfe2 Low Rating System Medium Medium \ud83d\udfe2 Low Booking System Large High \ud83d\udfe2 Low User Profiles Medium Medium \ud83d\udd27 Tech Automated Tests Large High \ud83d\udd27 Tech Error Handling Medium Medium \ud83d\udd27 Tech Deployment Guide Small Low"},{"location":"project/todo/#next-steps","title":"Next Steps","text":""},{"location":"project/todo/#immediate-critical-payment-issues","title":"Immediate (Critical Payment Issues)","text":"<ol> <li>\ud83d\udea8 URGENT: End Session Button in WebRTC (users being overcharged!)</li> <li>\ud83d\udea8 URGENT: WebRTC Disconnect Detection (prevents payment issues!)</li> </ol>"},{"location":"project/todo/#short-term-this-week","title":"Short-term (This Week)","text":"<ol> <li>Quick Fix: Frontend polling for session status (1 day)</li> <li>Multi-Language Support for Students</li> <li>Language Matching Fix</li> </ol>"},{"location":"project/todo/#medium-term-next-2-weeks","title":"Medium-term (Next 2 Weeks)","text":"<ol> <li>Proper Fix: Embed WebRTC in Frontend (4-5 days)</li> <li>Session History &amp; Analytics</li> </ol>"},{"location":"project/todo/#long-term-this-month","title":"Long-term (This Month)","text":"<ol> <li>POAP Minting + Rating System</li> <li>Booking/Scheduling System</li> </ol>"},{"location":"project/todo/#notes","title":"Notes","text":"<ul> <li>Focus on high-impact, low-effort items first</li> <li>Get multi-language support working before adding more features</li> <li>Automated tests should be added incrementally as features are built</li> <li>User feedback will help prioritize low-priority items</li> </ul> <p>Questions or suggestions? Add them to this document or create GitHub issues.</p>"},{"location":"research/assumptions/","title":"Research Assumptions","text":"<ul> <li>People with language skills will teach/guide if incentives are clear.</li> <li>Learners prefer verified, human-led onboarding for first steps.</li> <li>LatAm communities can seed initial supply/demand efficiently.</li> </ul>"},{"location":"research/assumptions/#open-questions","title":"Open Questions","text":"<ul> <li>Optimal reward size/frequency?</li> <li>Best verification flow to prevent abuse?</li> <li>Most effective community channels for growth?</li> </ul>"},{"location":"tech/api-reference/","title":"HTTP API Reference","text":"<p>Complete reference for all HTTP REST API endpoints in the LangDAO backend.</p> <p>Base URL (Development): <code>http://localhost:4000</code> Base URL (Production): <code>https://your-backend.railway.app</code></p>"},{"location":"tech/api-reference/#health-check","title":"Health Check","text":""},{"location":"tech/api-reference/#get-health","title":"<code>GET /health</code>","text":"<p>Check if the backend server is running and healthy.</p> <p>Response: <pre><code>{\n  \"status\": \"ok\",\n  \"timestamp\": \"2025-11-10T15:30:00.000Z\",\n  \"environment\": \"development\",\n  \"redis\": \"connected\"\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Server is healthy - <code>500</code> - Server error</p> <p>Example: <pre><code>curl http://localhost:4000/health\n</code></pre></p>"},{"location":"tech/api-reference/#tutor-endpoints","title":"Tutor Endpoints","text":""},{"location":"tech/api-reference/#get-apitutorsavailable","title":"<code>GET /api/tutors/available</code>","text":"<p>Get all currently available tutors.</p> <p>Response: <pre><code>{\n  \"success\": true,\n  \"tutors\": [\n    {\n      \"address\": \"0x1234...\",\n      \"language\": \"spanish\",\n      \"ratePerSecond\": 100000,\n      \"socketId\": \"abc123\"\n    }\n  ]\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Success - <code>500</code> - Server error</p> <p>Example: <pre><code>curl http://localhost:4000/api/tutors/available\n</code></pre></p>"},{"location":"tech/api-reference/#get-apitutorsaddress","title":"<code>GET /api/tutors/:address</code>","text":"<p>Get tutor information from the smart contract.</p> <p>Parameters: - <code>address</code> (path) - Tutor's wallet address</p> <p>Response: <pre><code>{\n  \"success\": true,\n  \"tutor\": {\n    \"totalEarnings\": \"1000000000\",\n    \"sessionCount\": 5,\n    \"isRegistered\": true\n  }\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Success - <code>500</code> - Server error</p> <p>Example: <pre><code>curl http://localhost:4000/api/tutors/0x1234567890abcdef1234567890abcdef12345678\n</code></pre></p>"},{"location":"tech/api-reference/#get-apitutorsaddressavailability","title":"<code>GET /api/tutors/:address/availability</code>","text":"<p>Check if a specific tutor is currently available.</p> <p>Parameters: - <code>address</code> (path) - Tutor's wallet address</p> <p>Response: <pre><code>{\n  \"success\": true,\n  \"isAvailable\": true,\n  \"tutor\": {\n    \"address\": \"0x1234...\",\n    \"language\": \"spanish\",\n    \"ratePerSecond\": 100000\n  }\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Success - <code>500</code> - Server error</p> <p>Example: <pre><code>curl http://localhost:4000/api/tutors/0x1234567890abcdef1234567890abcdef12345678/availability\n</code></pre></p>"},{"location":"tech/api-reference/#student-endpoints","title":"Student Endpoints","text":""},{"location":"tech/api-reference/#get-apistudentsaddress","title":"<code>GET /api/students/:address</code>","text":"<p>Get student information from the smart contract.</p> <p>Parameters: - <code>address</code> (path) - Student's wallet address</p> <p>Response: <pre><code>{\n  \"success\": true,\n  \"student\": {\n    \"targetLanguage\": 1,\n    \"budgetPerSec\": 150000,\n    \"isRegistered\": true\n  }\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Success - <code>500</code> - Server error</p> <p>Example: <pre><code>curl http://localhost:4000/api/students/0x1234567890abcdef1234567890abcdef12345678\n</code></pre></p>"},{"location":"tech/api-reference/#post-apistudentsaddressvalidate-budget","title":"<code>POST /api/students/:address/validate-budget</code>","text":"<p>Validate if a student can afford a specific tutor's rate.</p> <p>Parameters: - <code>address</code> (path) - Student's wallet address</p> <p>Request Body: <pre><code>{\n  \"tutorAddress\": \"0x...\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"success\": true,\n  \"canAfford\": true\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Success - <code>500</code> - Server error</p> <p>Example: <pre><code>curl -X POST http://localhost:4000/api/students/0xSTUDENT/validate-budget \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"tutorAddress\": \"0xTUTOR\"}'\n</code></pre></p>"},{"location":"tech/api-reference/#matching-endpoints","title":"Matching Endpoints","text":""},{"location":"tech/api-reference/#post-apimatchingfind-tutors","title":"<code>POST /api/matching/find-tutors</code>","text":"<p>Find tutors that match student requirements.</p> <p>Request Body: <pre><code>{\n  \"language\": \"spanish\",\n  \"budgetPerSecond\": 150000,\n  \"studentAddress\": \"0x...\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"success\": true,\n  \"tutors\": [\n    {\n      \"address\": \"0x1234...\",\n      \"language\": \"spanish\",\n      \"ratePerSecond\": 100000\n    }\n  ],\n  \"count\": 1\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Success - <code>400</code> - Missing required fields - <code>500</code> - Server error</p> <p>Example: <pre><code>curl -X POST http://localhost:4000/api/matching/find-tutors \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"language\": \"spanish\",\n    \"budgetPerSecond\": 150000,\n    \"studentAddress\": \"0xSTUDENT\"\n  }'\n</code></pre></p>"},{"location":"tech/api-reference/#get-apimatchingstats","title":"<code>GET /api/matching/stats</code>","text":"<p>Get matching system statistics.</p> <p>Response: <pre><code>{\n  \"success\": true,\n  \"stats\": {\n    \"totalAvailableTutors\": 5,\n    \"tutorsByLanguage\": {\n      \"spanish\": 3,\n      \"french\": 2\n    }\n  }\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Success - <code>500</code> - Server error</p> <p>Example: <pre><code>curl http://localhost:4000/api/matching/stats\n</code></pre></p>"},{"location":"tech/api-reference/#webrtc-events-endpoint","title":"WebRTC Events Endpoint","text":""},{"location":"tech/api-reference/#post-apiwebrtc-events","title":"<code>POST /api/webrtc-events</code>","text":"<p>Receives events from the WebRTC server (internal use).</p> <p>Request Body: <pre><code>{\n  \"type\": \"session-ended\",\n  \"sessionId\": \"req_abc123\",\n  \"endedBy\": \"student\",\n  \"userAddress\": \"0x...\",\n  \"timestamp\": 1699999000\n}\n</code></pre></p> <p>Event Types: - <code>user-connected</code> - User joined WebRTC room - <code>session-heartbeat</code> - Heartbeat ping from active session - <code>session-ended</code> - User clicked \"End Call\" - <code>user-disconnected</code> - User lost connection</p> <p>Response: <pre><code>{\n  \"success\": true,\n  \"message\": \"Event processed\"\n}\n</code></pre></p> <p>Status Codes: - <code>200</code> - Success - <code>500</code> - Server error</p> <p>Example: <pre><code>curl -X POST http://localhost:4000/api/webrtc-events \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"type\": \"session-ended\",\n    \"sessionId\": \"req_abc123\",\n    \"endedBy\": \"student\",\n    \"timestamp\": 1699999000\n  }'\n</code></pre></p> <p>Notes: - This endpoint is called by the WebRTC server, not by clients - Triggers <code>endSession()</code> on the smart contract - Handles session cleanup and payment processing</p>"},{"location":"tech/api-reference/#error-responses","title":"Error Responses","text":"<p>All endpoints return errors in this format:</p> <pre><code>{\n  \"success\": false,\n  \"error\": \"Error message here\"\n}\n</code></pre> <p>Common Error Messages: - <code>\"Rate limit exceeded\"</code> - Too many requests - <code>\"Missing required fields\"</code> - Invalid request body - <code>\"Failed to get tutor information\"</code> - Smart contract error - <code>\"Request not found or expired\"</code> - Invalid session ID</p>"},{"location":"tech/api-reference/#rate-limiting","title":"Rate Limiting","text":"<p>HTTP Endpoints: 100 requests per minute per IP Socket Events: 10 requests per minute per socket</p> <p>Rate Limit Response: <pre><code>{\n  \"error\": \"Too many requests, please try again later\"\n}\n</code></pre></p> <p>Headers: - <code>X-RateLimit-Limit</code> - Request limit - <code>X-RateLimit-Remaining</code> - Remaining requests - <code>X-RateLimit-Reset</code> - Time until reset</p>"},{"location":"tech/api-reference/#authentication","title":"Authentication","text":"<p>Currently, there is no authentication on HTTP endpoints. Authentication is handled via: - Wallet signatures for blockchain transactions - Socket.io connection binding for real-time events</p> <p>Future: May add JWT or API key authentication for production.</p>"},{"location":"tech/api-reference/#cors-configuration","title":"CORS Configuration","text":"<p>Allowed Origins: - Development: <code>http://localhost:3000</code> - Production: Set via <code>CORS_ORIGIN</code> environment variable</p> <p>Allowed Methods: - <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, <code>OPTIONS</code></p> <p>Allowed Headers: - <code>Content-Type</code>, <code>Authorization</code></p>"},{"location":"tech/api-reference/#testing","title":"Testing","text":""},{"location":"tech/api-reference/#using-curl","title":"Using curl","text":"<pre><code># Health check\ncurl http://localhost:4000/health\n\n# Get available tutors\ncurl http://localhost:4000/api/tutors/available\n\n# Get matching stats\ncurl http://localhost:4000/api/matching/stats\n\n# Find tutors\ncurl -X POST http://localhost:4000/api/matching/find-tutors \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"language\": \"spanish\", \"budgetPerSecond\": 150000}'\n</code></pre>"},{"location":"tech/api-reference/#using-javascript-fetch","title":"Using JavaScript (fetch)","text":"<pre><code>// Get available tutors\nconst response = await fetch('http://localhost:4000/api/tutors/available');\nconst data = await response.json();\nconsole.log(data.tutors);\n\n// Find matching tutors\nconst response = await fetch('http://localhost:4000/api/matching/find-tutors', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({\n    language: 'spanish',\n    budgetPerSecond: 150000,\n    studentAddress: '0x...'\n  })\n});\nconst data = await response.json();\nconsole.log(data.tutors);\n</code></pre>"},{"location":"tech/api-reference/#using-postman","title":"Using Postman","text":"<ol> <li>Import collection from <code>docs/postman/langdao-api.json</code> (if available)</li> <li>Set base URL to <code>http://localhost:4000</code></li> <li>Test endpoints</li> </ol>"},{"location":"tech/api-reference/#smart-contract-integration","title":"Smart Contract Integration","text":"<p>These endpoints interact with the LangDAO smart contract:</p> Endpoint Contract Function <code>GET /api/tutors/:address</code> <code>getTutorInfo(address)</code> <code>GET /api/students/:address</code> <code>getStudentInfo(address)</code> <code>POST /api/students/:address/validate-budget</code> <code>canAffordRate(student, tutor)</code> <code>POST /api/webrtc-events</code> (session-ended) <code>endSession(tutorAddress)</code> <p>Contract Address: Set via <code>CONTRACT_ADDRESS</code> environment variable</p> <p>RPC URL: Set via <code>RPC_URL</code> environment variable</p>"},{"location":"tech/api-reference/#monitoring","title":"Monitoring","text":""},{"location":"tech/api-reference/#health-check-monitoring","title":"Health Check Monitoring","text":"<p>Set up monitoring to ping <code>/health</code> every 30 seconds:</p> <pre><code># Simple monitoring script\nwhile true; do\n  curl -s http://localhost:4000/health | jq .\n  sleep 30\ndone\n</code></pre>"},{"location":"tech/api-reference/#logging","title":"Logging","text":"<p>All requests are logged with: - Timestamp - Method and path - Response status - Response time</p> <p>Log Format (Morgan): <pre><code>:method :url :status :response-time ms - :res[content-length]\n</code></pre></p>"},{"location":"tech/api-reference/#related-documentation","title":"Related Documentation","text":"<ul> <li>Socket Events Reference - Real-time Socket.io events</li> <li>Architecture Overview - System architecture</li> <li>Environment Variables - Configuration</li> </ul> <p>Last Updated: November 10, 2025</p>"},{"location":"tech/architecture/","title":"Architecture (MVP)","text":"<p>\u26a0\ufe0f OUTDATED DOCUMENT - This document describes the originally planned architecture with Superfluid streaming, separate Matchmaker API, Relayer Bot, and other components that were not implemented.</p> <p>For the actual implemented architecture, see: <code>docs/architecture/overview.md</code></p> <p>This document is kept for historical reference and may be useful for future enhancements.</p>"},{"location":"tech/architecture/#original-planned-architecture","title":"Original Planned Architecture","text":"<p>This MVP lets a Tutor go online with a per-minute/per-second rate, and a Student:</p> <ul> <li>match via roulette or booking</li> <li>pay only for time in call</li> <li>get auto call cutoff when balance ends or either side disconnects</li> <li>receive POAP/credential (optional)</li> <li>rate the tutor and track progress</li> </ul> <p>We minimize contracts to what\u2019s essential for time-billed calls and auto-stop.</p>"},{"location":"tech/architecture/#high-level-components","title":"High-level Components","text":"<pre><code>graph TD\n  subgraph \"Client\"\n    S[\"Student dApp - NextJS\"]:::box\n    T[\"Tutor dApp - NextJS\"]:::box\n    W[\"WalletConnect\"]:::box\n  end\n\n  subgraph \"Realtime\"\n    H[\"Huddle01 WebRTC Rooms\"]:::svc\n  end\n\n  subgraph \"Off-chain Services\"\n    MM[\"Matchmaker API - Roulette &amp; Booking\"]:::svc\n    HB[\"Heartbeat Service - 5s signed pings\"]:::svc\n    RL[\"Relayer Bot - authorized\"]:::svc\n    NF[\"Notifications &amp; Calendar\"]:::svc\n  end\n\n  subgraph \"On-chain / Protocol\"\n    CTRL[\"Payment Controller - Flow Operator\"]:::chain\n    STR[\"Streaming Protocol - Superfluid or Sablier\"]:::chain\n    CRED[\"Credentials - POAP or SBT\"]:::chain\n    RAT[\"Ratings (IPFS + on-chain hash)\"]:::chain\n    DAO[\"DAO Multisig + Snapshot\"]:::chain\n  end\n\n  S --&gt;|auth| W\n  T --&gt;|auth| W\n  S --&gt; MM\n  T --&gt; MM\n  MM --&gt; H\n  S --&gt;|join| H\n  T --&gt;|join| H\n\n  S --&gt; HB\n  T --&gt; HB\n  H --&gt; HB\n  HB --&gt; RL\n  RL --&gt; CTRL\n  CTRL --&gt;|create/update/delete flow| STR\n\n  S --&gt;|grant operator + top-ups| CTRL\n  STR --&gt;|real-time stream| T\n\n  S --&gt; CRED\n  T --&gt; CRED\n  S --&gt; RAT\n  T --&gt; RAT\n  DAO --&gt; CRED\n\n  classDef box fill:#0b5fff0d,stroke:#0b5fff,stroke-width:1px,color:#0b2540;\n  classDef svc fill:#ffd50014,stroke:#d4a000,stroke-width:1px,color:#5a4500;\n  classDef chain fill:#00a36b14,stroke:#008a59,stroke-width:1px,color:#0b3b2c;</code></pre>"},{"location":"tech/architecture/#reading-notes","title":"Reading notes","text":"<ul> <li>Matchmaker handles roulette/booking, then hands off to Huddle01 for the live session.</li> <li>Heartbeat watches WebRTC + pings; Relayer \u2192 Controller deletes the stream on drop.</li> <li>Controller is pre-authorized by the student (flow operator) to manage their stream non-interactively.</li> <li>Top-ups go from Student \u2192 Controller/Protocol; funds stream to Tutor in real time.</li> <li>Credentials (POAP/SBT) and Ratings form the reputation layer; DAO issues SBTs via Snapshot + Multisig.</li> </ul>"},{"location":"tech/architecture/#component-1-session-escrow-time-billed-calls","title":"Component 1: Session Escrow (time-billed calls)","text":"<p>Goal: pay the tutor only for time in call; auto-stop on cap/disconnect.</p> <pre><code>stateDiagram-v2\n  [*] --&gt; Idle\n\n  Idle --&gt; Funded: deposit(cap, rate)&lt;br&gt;(by Student)\n  Funded --&gt; Active: startSession()&lt;br&gt;(both joined)\n\n  Active --&gt; Stopping: cap reached&lt;br&gt;(or Student ends)\n  Active --&gt; Stopping: disconnect detected&lt;br&gt;(heartbeat/webRTC)\n  Active --&gt; Stopping: tutor ends\n\n  Stopping --&gt; Settled: settle owed = min(elapsed, cap) * rate\n  Settled --&gt; Refunded: refund remainder (cap - elapsed)*rate\n  Refunded --&gt; Closed</code></pre>"},{"location":"tech/architecture/#what-this-component-does-and-only-this","title":"What this component does (and only this)","text":"<ul> <li>deposit(cap, rate): Student pre-funds max spend \u2192 moves to Funded.</li> <li>startSession(): Called once both are in the room \u2192 moves to Active.</li> <li>elapsed accounting: measured inside contract (block timestamps) or a \u201cmeter\u201d submodule.</li> <li>stop triggers:</li> <li>cap reached,</li> <li>disconnect (from heartbeat/webRTC signal relayed on-chain),</li> <li>either party ends.</li> <li>settle(): pay tutor min(elapsed, cap) \u00d7 rate, refund remainder to student.</li> <li>no overpaying, no post-drop leakage by construction.</li> </ul>"},{"location":"tech/architecture/#caveats","title":"Caveats","text":"<p>What if the user wishes to keep the current session running longer than his deposit allows? Could be a UX bug.</p>"},{"location":"tech/architecture/#component-2-heartbeat-auto-stop","title":"Component 2: Heartbeat &amp; Auto-Stop","text":"<p>Purpose: guarantee that if either peer drops from a Huddle01 call, billing halts instantly.</p>"},{"location":"tech/architecture/#concept","title":"Concept","text":"<p>Each participant\u2019s client emits a signed \u201cI\u2019m still here\u201d ping every N seconds to a lightweight service. If either side fails to send two consecutive heartbeats (\u2248 10 s of silence), the service calls the on-chain <code>stopSession()</code> via a relayer.</p> <pre><code>sequenceDiagram\n  autonumber\n  participant Student as Student Client\n  participant Tutor as Tutor Client\n  participant Huddle as Huddle01 (WebRTC)\n  participant Heartbeat as Heartbeat Service\n  participant Relayer as Relayer Bot\n  participant Controller as Payment Controller\n  participant Stream as Streaming Protocol\n\n  %% Start of call (elsewhere: Matchmaker + Controller.startSession)\n  Student-&gt;&gt;Huddle: join()\n  Tutor-&gt;&gt;Huddle: join()\n\n  %% Periodic liveness pings\n  loop every 5s\n    Student-&gt;&gt;Heartbeat: POST /ping {sessionId, sig}\n    Tutor-&gt;&gt;Heartbeat: POST /ping {sessionId, sig}\n  end\n\n  Note over Heartbeat: tracks lastPing for both peers\n\n  %% Disconnect from Huddle or missing pings\n  Huddle--&gt;&gt;Heartbeat: peer-left / connectionState=failed\n  Heartbeat-&gt;&gt;Heartbeat: OR detect missing ping &gt; 10s\n\n  alt disconnect or missing ping\n    Heartbeat--&gt;&gt;Relayer: emit \"disconnect(sessionId)\"\n    Relayer-&gt;&gt;Controller: stopSession(sessionId)\n    Controller-&gt;&gt;Stream: deleteFlow(student -&gt; tutor)\n    Note over Controller,Stream: Stream deleted \u2192 payment stops instantly\n  end</code></pre>"},{"location":"tech/architecture/#key-changes","title":"Key changes","text":"<ul> <li>Heartbeat no longer calls escrow; it instructs the Controller to delete the live stream (Superfluid/Sablier) so billing halts immediately.</li> <li>The note is placed inside a valid branch to avoid Mermaid parse errors.</li> </ul>"},{"location":"tech/architecture/#behavior-summary","title":"Behavior Summary","text":"Event Trigger Action \u2705 Normal pings both clients responding nothing changes \u26a0\ufe0f One peer silent &gt; 10 s network loss/closed tab Heartbeat \u2192 Relayer \u2192 stopSession() Stop Acknowledgement Escrow settles tutor payout + student refund issued"},{"location":"tech/architecture/#implementation-notes","title":"Implementation notes","text":"<ul> <li>Ping = small JSON {sessionId, walletAddr, signature}.</li> <li>Verification = HMAC / signature ensures no spoofing.</li> <li>Relayer = can be Biconomy, Gelato, OZ Defender or simple script with funded key.</li> <li>Timeout tunable (5 s, 10 s, 15 s).</li> <li>Logs feed optional analytics (\u201caverage disconnect time\u201d).</li> </ul>"},{"location":"tech/architecture/#component-3a-matchmaker-roulette-find-tutor-now","title":"Component 3A \u2014 Matchmaker (Roulette \u201cfind tutor now\u201d)","text":"<p>Purpose: pair a student with an available, matching tutor quickly, confirm the rate/cap, and hand off to escrow \u2192 call.</p>"},{"location":"tech/architecture/#assumptions","title":"Assumptions","text":"<ul> <li>Student specifies filters: language, level, max rate, credential (optional SBT).</li> <li>Tutor sets availability + per-second/minute rate and optional credentials.</li> <li>We pre-check student balance/cap before proposing.</li> </ul> <pre><code>sequenceDiagram\n  autonumber\n  participant Student as Student dApp\n  participant MM as Matchmaker API\n  participant Tutor as Tutor dApp\n  participant Wallet as Wallet/Balance\n  participant Escrow as Escrow Contract\n  participant Huddle as Huddle01\n\n  Student-&gt;&gt;Wallet: read balance / max spend cap\n  Student-&gt;&gt;MM: findNow({lang, level, maxRate, credReq, cap})\n  MM-&gt;&gt;MM: filter tutors: online \u2227 rate&lt;=maxRate \u2227 cred ok\n  alt no tutors\n    MM--&gt;&gt;Student: none available \u2192 suggest booking/waitlist\n    Note over Student,MM: END (no match)\n  else candidates exist\n    MM-&gt;&gt;Tutor: proposal({rate, estCap, filters}) (30s ttl)\n    alt tutor accepts\n      Tutor--&gt;&gt;MM: accept\n      MM-&gt;&gt;Huddle: create room token (ephemeral)\n      MM--&gt;&gt;Student: matchFound({tutor, rate, roomToken, cap})\n      Student-&gt;&gt;Escrow: deposit(cap), startSessionIntent(rate,tutor)\n      alt deposit OK\n        Escrow--&gt;&gt;Student: sessionId\n        Student-&gt;&gt;Huddle: join(roomToken)\n        Tutor-&gt;&gt;Huddle: join(roomToken)\n        Note over Student,Tutor: handoff to Heartbeat + Escrow component\n      else deposit fails / too low\n        Escrow--&gt;&gt;Student: insufficient funds\n        MM--&gt;&gt;Student: retry / reduce cap\n      end\n    else tutor times out / declines\n      Tutor--&gt;&gt;MM: decline/timeout\n      MM-&gt;&gt;MM: try next candidate (max N attempts)\n      MM--&gt;&gt;Student: (optional) still matching\u2026 spinner\n    end\n  end</code></pre>"},{"location":"tech/architecture/#behavior","title":"Behavior","text":"<ul> <li>Filter \u2192 Propose \u2192 Accept loop with short TTL to keep UX snappy.</li> <li>Balance &amp; cap pre-check avoids proposing rates the student can\u2019t afford.</li> <li>Rate lock at acceptance (for the session intent), so no last-second changes.</li> <li>On accept, we create room, then require escrow deposit before join.</li> <li>If escrow fails, offer retry or reduce cap; the tutor can be auto-released.</li> </ul>"},{"location":"tech/architecture/#edge-cases-timeouts","title":"Edge cases &amp; timeouts","text":"<ul> <li>No tutors \u2192 offer booking or waitlist ping.</li> <li>Tutor non-response \u2192 retry next (max N attempts, e.g., 3).</li> <li>Race conditions (two students propose same tutor): first valid accept wins; others get retry.</li> </ul>"},{"location":"tech/architecture/#component-3b-matchmaker-booking-flow","title":"Component 3B \u2014 Matchmaker (Booking Flow)","text":"<p>Purpose: let students book tutors in advance, ensure both confirm, and automatically trigger the escrow + call flow at the appointment time.</p> <pre><code>sequenceDiagram\n  autonumber\n  participant Student as Student dApp\n  participant MM as Matchmaker API\n  participant Tutor as Tutor dApp\n  participant Cal as Calendar / Scheduler\n  participant Escrow as Escrow Contract\n  participant Huddle as Huddle01\n  participant Notif as Notification Service\n\n  Student-&gt;&gt;MM: requestBooking({tutorId, dateTime, duration, rateCap})\n  MM-&gt;&gt;Tutor: proposeSlot({dateTime, duration, rateCap})\n  alt tutor accepts\n    Tutor--&gt;&gt;MM: accept\n    MM-&gt;&gt;Cal: createEvent({student, tutor, time, duration})\n    Cal--&gt;&gt;MM: eventId\n    MM-&gt;&gt;Notif: sendConfirmation(emails/push to both)\n    Notif--&gt;&gt;Student: booking confirmed\n    Notif--&gt;&gt;Tutor: booking confirmed\n  else tutor declines\n    Tutor--&gt;&gt;MM: decline\n    MM--&gt;&gt;Student: suggest new slot / other tutors\n    Note over MM: END (no booking)\n  end\n\n  %% Day-of-Session automation\n  Notif-&gt;&gt;Student: reminder T-30 min\n  Notif-&gt;&gt;Tutor: reminder T-30 min\n  Cal-&gt;&gt;MM: trigger start window (T-5 min)\n\n  MM-&gt;&gt;Huddle: createRoomToken(eventId)\n  MM-&gt;&gt;Escrow: preAuthSession({student,tutor,rate,durationCap})\n  Escrow--&gt;&gt;MM: sessionIntent ok\n  MM--&gt;&gt;Student: joinLink + depositPrompt\n  Student-&gt;&gt;Escrow: deposit(cap)\n  Student-&gt;&gt;Huddle: join(roomToken)\n  Tutor-&gt;&gt;Huddle: join(roomToken)\n\n  Note over Huddle: handoff \u2192 Heartbeat &amp; Escrow components</code></pre>"},{"location":"tech/architecture/#behavior-summary_1","title":"Behavior Summary","text":"Phase Who Action Proposal Student -&gt; Tutor request slot (date, duration, rateCap) Confirmation Tutor accept/decline \u2192 calendar entry Reminders Notification service 30 min &amp; 5 min pre-session Pre-fund Student deposits cap before start Session Start System opens Huddle room + Escrow intent Live Call Both proceeds under Heartbeat + Auto-Stop rules"},{"location":"tech/architecture/#key-properties","title":"Key Properties","text":"<ul> <li>Double opt-in: prevents ghost bookings.</li> <li>Pre-authorization: ensures funds exist before the room opens.</li> <li>Automation: Cal/Notif triggers prevent manual coordination.</li> <li>Handoff: identical to roulette after join \u2192 no duplicate logic.</li> </ul>"},{"location":"tech/architecture/#component-4-credentials-ratings","title":"Component 4 \u2014 Credentials &amp; Ratings","text":"<p>Purpose: after every session, issue a verifiable proof of participation and update both participants\u2019 reputations. for vetted tutors, issue a Soul-Bound Token (SBT) to unlock credential-gated rooms.</p> <pre><code>sequenceDiagram\n  autonumber\n  participant Student as Student dApp\n  participant Tutor as Tutor dApp\n  participant ESC as Escrow Contract\n  participant POAP as POAP API / Mint Contract\n  participant DAO as Vetting DAO / SBT Issuer\n  participant IPFS as Ratings Storage\n\n  ESC--&gt;&gt;Student: sessionSettled(eventId)\n  Student-&gt;&gt;POAP: mintPOAP(eventId, sig)\n  POAP--&gt;&gt;Student: tokenId (POAP NFT)\n  Note over Student,POAP: proof of session = credential #1\n\n  Student-&gt;&gt;IPFS: uploadRating({tutorId, score, text})\n  IPFS--&gt;&gt;Student: cid\n  Student-&gt;&gt;ESC: recordRatingHash(cid)\n  ESC--&gt;&gt;Tutor: reputationUpdate(cid)\n\n  alt DAO vetting process\n    Tutor-&gt;&gt;DAO: applyForCredential({proofs, ratings})\n    DAO--&gt;&gt;Tutor: verify + mint SBT\n    Tutor-&gt;&gt;SBT: hold soul-bound credential\n  end</code></pre>"},{"location":"tech/architecture/#credential-types","title":"Credential Types","text":"Type Purpose Who mints Transferable Example POAP Proof of attendance / completion automatic API \u2705 Student finishes a lesson SBT (Tutor Credential) DAO-vetted qualification DAO governance \u274c \u201cCertified Spanish native speaker\u201d Rating Record Session feedback student \u2192 IPFS + hash on-chain n/a 5 stars, comment"},{"location":"tech/architecture/#logic-highlights","title":"Logic Highlights","text":"<ul> <li>Automatic POAP: triggered by sessionSettled; minimal friction.</li> <li>Reputation anchor: each rating = IPFS CID + hash on-chain \u2192 verifiable, append-only.</li> <li>DAO vetting: a DAO multisig reviews proofs/ratings \u2192 issues an SBT NFT.</li> <li>Access control: smart-contract rooms or filters check balanceOf(SBT) &gt; 0.</li> </ul>"},{"location":"tech/architecture/#component-5-dao-vetting-flow-tutor-credential-sbt","title":"Component 5 \u2014 DAO Vetting Flow (Tutor Credential SBT)","text":"<ul> <li>DAO Vetting Flow</li> </ul>"},{"location":"tech/architecture/#component-6-streaming-payments-with-dynamic-top-up","title":"Component 6 \u2014 Streaming Payments with Dynamic Top-Up","text":""},{"location":"tech/architecture/#goals","title":"Goals","text":"<ul> <li>Pay exactly per second while the call is live.</li> <li>No fixed cap; student keeps talking while funded.</li> <li>Top up during the call (adds balance; stream continues).</li> <li>Auto-stop on disconnect without needing the student\u2019s tx.</li> </ul>"},{"location":"tech/architecture/#key-pieces","title":"Key Pieces","text":"<ul> <li>Streaming protocol: Superfluid CFA (or Sablier v2 per-second).</li> <li>Controller contract: has FlowOperator perms (Superfluid) / broker role (Sablier) for the student \u2192 can start/stop/update flows.</li> <li>Heartbeat service + Relayer: listens to Huddle01 events; calls controller to stop the stream on drop.</li> <li>Top-ups: student upgrades/supplies more tokens (can be gasless via Paymaster/AA if you want).</li> </ul> <pre><code>sequenceDiagram\n  autonumber\n  participant Student as Student dApp\n  participant Controller as Controller (Flow Operator)\n  participant Stream as Streaming Protocol (e.g., Superfluid)\n  participant Heartbeat as Heartbeat Service\n  participant Relayer as Relayer Bot\n  participant Tutor as Tutor Wallet\n\n  Note over Student: One-time: grant FlowOperator perms to Controller\n\n  Student-&gt;&gt;Controller: startSession(tutor, ratePerSec)\n  Controller-&gt;&gt;Stream: createFlow(student -&gt; tutor, ratePerSec)\n  Stream--&gt;&gt;Tutor: tokens stream per-second\n  Note over Student,Stream: Student must hold/upgrade tokens as balance\n\n  par During call\n    loop Every few seconds\n      Student-&gt;&gt;Stream: topUp(amount)  %% upgrade/mint to stream balance\n      Stream--&gt;&gt;Student: balance updated\n    end\n  and Heartbeat monitoring\n      Heartbeat--&gt;&gt;Relayer: disconnect OR balance low\n      Relayer-&gt;&gt;Controller: stopSession(sessionId)\n      Controller-&gt;&gt;Stream: deleteFlow(student -&gt; tutor)\n  end\n\n  alt Student ends manually\n    Student-&gt;&gt;Controller: stopSession()\n    Controller-&gt;&gt;Stream: deleteFlow(student -&gt; tutor)\n    Note over Controller,Stream: stream deleted \u2192 payment stops instantly\n  end</code></pre>"},{"location":"tech/architecture/#behavior-summary_2","title":"Behavior Summary","text":"<ul> <li>Start: Student clicks \u201cStart Session\u201d \u2192 controller creates a per-second stream at the tutor\u2019s rate.</li> <li>During call:</li> <li>The student\u2019s streaming balance decreases; they can top up anytime (send/upgrade more tokens).</li> <li>UI shows time remaining at current balance; warns early.</li> <li>Disconnect or end: Heartbeat/RTC event \u2192 relayer calls controller \u2192 stream deleted immediately.</li> <li>Billing: Exact, continuous\u2014no settlement step needed. The tutor\u2019s wallet accrues in real time.</li> </ul>"},{"location":"tech/architecture/#why-this-meets-your-constraints","title":"Why this meets your constraints","text":"<ul> <li>No cap UX: the conversation can continue indefinitely, as long as funds remain.</li> <li>Top-up live: student can add funds mid-call (even made gasless later).</li> <li>No post-drop paying: stream is deleted by the controller when the heartbeat detects a drop\u2014no student tx needed.</li> <li>Tutor sets precise rate: store rate in tokens/sec, show per-minute in UI.</li> </ul>"},{"location":"tech/architecture/#minimal-contract-surface-pseudocode-not-solidity","title":"Minimal Contract Surface (pseudocode, not Solidity)","text":"<ul> <li>grantOperator(student \u2192 controller, maxRate) \u2014 one-time user consent.</li> <li>startSession(student, tutor, ratePerSec) \u2192 create flow (enforce ratePerSec &lt;= maxRate).</li> <li>stopSession(sessionId) \u2192 delete flow (callable by student, tutor, or relayer).</li> <li>(Optional) updateRate(newRatePerSec) during call if both sides accept.</li> </ul> <p>Superfluid specifics: student grants the Controller FlowOperator permissions (create/update/delete flows) scoped by allowances; Controller uses CFAv1 to manage the stream. Sablier v2: use a broker/mediator stream that the Controller can cancel.</p>"},{"location":"tech/architecture/#top-up-ux-notes","title":"Top-Up UX Notes","text":"<ul> <li>Warn at thresholds (e.g., 10 min, 3 min remaining at current rate).</li> <li>Provide one-click top-up (send/upgrade stablecoin) and consider a gasless paymaster.</li> <li>If balance dips below protocol buffer, pause or delete flow before liquidation.</li> </ul>"},{"location":"tech/architecture/#failure-edge-cases","title":"Failure / Edge Cases","text":"Case Outcome Student wallet runs out mid-call Stream pauses/stops; UI prompts top-up; call can continue without billing (or you auto-end call). Student hard disconnects Heartbeat \u2192 Relayer \u2192 Controller deletes stream immediately. Tutor disconnects Same path; stream stops; student not charged further. Controller down Worst case: stream continues until student manually stops; mitigate with redundant relayers/cron."},{"location":"tech/architecture/#architecture-high-level","title":"Architecture (High-Level)","text":""},{"location":"tech/architecture/#diagram","title":"Diagram","text":"<pre><code>Learner / Contributor (Wallet)\n\u2502\n\u25bc\nFrontend (Next.js / React)\n\u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \u2502 \u2502\n\u25bc \u25bc \u25bc\nWallet Huddle01 SDK Credential Mint\nConnect (Live Sessions) (POAP or minimal ERC-721)\n(wagmi/viem) \u2502 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba Completion Signal \u2502\n\u2502\n\u25bc\nReward Reminder / Claim payment(testnet)\n</code></pre>"},{"location":"tech/architecture/#components","title":"Components","text":"<ul> <li>Frontend: Next.js + wagmi/viem for wallet connect.</li> <li>Video: Huddle01 for low-latency, wallet-aware live sessions (optionally token-gated).</li> <li>Credentials: POAP (or minimal ERC-721) as proof of completion/participation.</li> <li>Payment: Streaming payment should be terminated upon session completion</li> <li>Serverless (optional for MVP): simple scheduling/metadata endpoints if needed.</li> </ul>"},{"location":"tech/architecture/#primary-flows","title":"Primary Flows","text":"<ol> <li>Join &amp; Learn</li> <li>Connect wallet \u2192 view schedule \u2192 join live Huddle01 session.</li> <li>Verify &amp; Credential</li> <li>Host marks completion \u2192 participant mints POAP/credential.</li> <li>Reward (MVP)</li> <li>Display mock reward, tutor should receive payment</li> </ol>"},{"location":"tech/architecture/#notes-constraints","title":"Notes &amp; Constraints","text":"<ul> <li>MVP: minimize backend; prefer client-side + third-party SDKs.</li> <li>Abuse prevention (post-MVP): host attestation, time-in-session checks, or allowlist for early pilots.</li> <li>Scalability: start single language (Spanish), design flows to be language-agnostic.</li> </ul>"},{"location":"tech/architecture/#future-integrations-post-hackathon","title":"Future Integrations (Post-Hackathon)","text":"<ul> <li>Chainlink: attestations / automation for scheduled tasks.</li> <li>Reputation: simple on-chain badges \u2192 aggregated contributor profile.</li> <li>Storage: IPFS/Arweave for session metadata or recordings if needed.</li> </ul>"},{"location":"tech/dao-vetting/","title":"DAO Vetting Flow (Tutor Credential SBT)","text":"<p>Purpose: community governance verifies tutors and issues a non-transferable SBT that unlocks credential-gated rooms.</p>"},{"location":"tech/dao-vetting/#a-governance-sequence-from-application-to-sbt-mint","title":"A) Governance sequence (from application to SBT mint)","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant Tutor as Tutor\n  participant dApp as LangDAO dApp\n  participant Intake as DAO Intake API\n  participant IPFS as IPFS (evidence bundle)\n  participant Snapshot as Snapshot (off-chain vote)\n  participant Multisig as DAO Multisig\n  participant SBT as SBT Contract (non-transferable)\n\n  Tutor-&gt;&gt;dApp: Apply for credential (proofs, ratings, links)\n  dApp-&gt;&gt;Intake: submitApplication(payload)\n  Intake-&gt;&gt;IPFS: pin evidence bundle (JSON)\n  IPFS--&gt;&gt;Intake: cid\n  Intake--&gt;&gt;dApp: applicationId + cid\n\n  Intake-&gt;&gt;Snapshot: create proposal {title, cid, applicant}\n  Snapshot--&gt;&gt;Community: voting window (e.g., 3\u20135 days)\n\n  alt Quorum met &amp; majority YES\n    Snapshot--&gt;&gt;Multisig: proposal approved (payload: applicant, cid)\n    Multisig-&gt;&gt;SBT: mint(applicant, tokenURI=cid)\n    SBT--&gt;&gt;Tutor: Credential SBT minted \u2705\n  else Rejected / No quorum\n    Snapshot--&gt;&gt;dApp: status=Rejected (option: resubmit with fixes)\n    dApp--&gt;&gt;Tutor: feedback + next steps\n  end</code></pre>"},{"location":"tech/dao-vetting/#notes","title":"Notes","text":"<ul> <li>Evidence bundle: CV, language certs, prior ratings (CIDs), sample sessions.</li> <li>Snapshot: transparent voting; proposal links to CID for reviewers.</li> <li>Multisig: executes mint after approval (clear separation of \u201csignal\u201d vs \u201cexecution\u201d).</li> <li>SBT tokenURI: points to IPFS metadata (credential type, issuedAt, issuer).</li> </ul>"},{"location":"tech/dao-vetting/#b-credential-lifecycle-state-machine","title":"B) Credential lifecycle (state machine)","text":"<pre><code>stateDiagram-v2\n  [*] --&gt; Uncredentialed\n\n  Uncredentialed --&gt; VideoInterview: Submit application\n  VideoInterview --&gt; PendingReview\n  PendingReview --&gt; Approved: Vote passes + SBT minted\n  PendingReview --&gt; Rejected: Vote fails / No quorum\n\n  Approved --&gt; Active: Auto\n  Active --&gt; RevocationProposed: Misconduct/appeal opened\n  RevocationProposed --&gt; Revoked: Vote passes -&gt; burn SBT\n  RevocationProposed --&gt; Active: Vote fails / Dismissed\n\n  Rejected --&gt; Uncredentialed: Reapply after changes\n  Revoked --&gt; Uncredentialed: Reapply after cooldown (policy)</code></pre>"},{"location":"tech/dao-vetting/#policy-hooks","title":"Policy hooks","text":"<ul> <li>Cooldown after rejection/revocation (e.g., 30\u201390 days).</li> <li>Appeals = new proposal referencing prior decision CID.</li> <li>Granular credentials: multiple SBT \u201ctracks\u201d (e.g., Spanish A2, Conversation Coach, Advanced Grammar) issued independently.</li> </ul>"},{"location":"tech/dao-vetting/#c-how-rooms-enforce-credentials","title":"C) How rooms enforce credentials","text":"<ul> <li>Room configs include required credential(s) (SBT contract + tokenId range or trait).</li> <li>Join flow checks <code>SBT.balanceOf(user) &gt; 0</code> (or <code>hasTrait(user, \"Spanish-A2\")</code>).</li> <li>Fallback: allow observer role without SBT (no paid host privileges).</li> </ul>"},{"location":"tech/dao-vetting/#d-minimal-sbt-contract-properties","title":"D) Minimal SBT contract (properties)","text":"<ul> <li>Non-transferable (override <code>transferFrom/safeTransferFrom</code> to revert).</li> <li>Mint only by DAO Multisig.</li> <li>Burn only by Multisig (revocation) or owner+Multisig (appeal outcome).</li> <li>tokenURI = IPFS metadata; consider an Attestation layer later (EAS).</li> </ul>"},{"location":"tech/integrations/","title":"Integrations","text":""},{"location":"tech/integrations/#currently-integrated","title":"Currently Integrated","text":""},{"location":"tech/integrations/#custom-webrtc-implementation","title":"Custom WebRTC Implementation","text":"<ul> <li>Peer-to-peer video calls</li> <li>Real-time audio/video communication</li> <li>Session monitoring and disconnect detection</li> <li>Custom server implementation (not Huddle01)</li> <li>Status: \u2705 Implemented</li> </ul>"},{"location":"tech/integrations/#pyusd-payment-token","title":"PYUSD (Payment Token)","text":"<ul> <li>PayPal USD stablecoin on Sepolia testnet</li> <li>Used for all session payments</li> <li>Contract address: <code>0xCaC524BcA292aaade2DF8A05cC58F0a65B1B3bB9</code></li> <li>Status: \u2705 Implemented</li> </ul>"},{"location":"tech/integrations/#custom-payment-system","title":"Custom Payment System","text":"<ul> <li>Timestamp-based payment calculation</li> <li>Payment = <code>(endTime - startTime) * ratePerSecond</code></li> <li>No external streaming protocol needed</li> <li>Status: \u2705 Implemented (replaced Superfluid/Sablier)</li> </ul>"},{"location":"tech/integrations/#planned-future","title":"Planned / Future","text":""},{"location":"tech/integrations/#poap-credentials","title":"POAP / Credentials","text":"<ul> <li>Mint proof of session completion</li> <li>Display in wallet/portfolio</li> <li>Status: \ud83d\udd04 Planned</li> </ul>"},{"location":"tech/integrations/#chainlink","title":"Chainlink","text":"<ul> <li>Data feeds for exchange rates</li> <li>Automation for scheduled sessions</li> <li>Status: \ud83d\udd04 Planned</li> </ul>"},{"location":"tech/integrations/#storage-ipfsarweave","title":"Storage (IPFS/Arweave)","text":"<ul> <li>Session metadata</li> <li>User profiles</li> <li>Rating/review data</li> <li>Status: \ud83d\udd04 Planned</li> </ul>"},{"location":"tech/integrations/#attestation-layers","title":"Attestation Layers","text":"<ul> <li>EAS (Ethereum Attestation Service)</li> <li>Tutor credentials</li> <li>Skill verification</li> <li>Status: \ud83d\udd04 Planned</li> </ul>"},{"location":"tech/integrations/#removed-not-using","title":"Removed / Not Using","text":""},{"location":"tech/integrations/#superfluid","title":"~~Superfluid~~","text":"<ul> <li>Originally planned for streaming payments</li> <li>Removed due to complexity with session end handling</li> <li>Replaced with custom timestamp-based system</li> </ul>"},{"location":"tech/integrations/#sablier","title":"~~Sablier~~","text":"<ul> <li>Originally considered as Superfluid alternative</li> <li>Not needed with custom payment system</li> </ul>"},{"location":"tech/socket-events/","title":"Socket.io Events Reference","text":"<p>Complete reference for all Socket.io events used in the LangDAO real-time matching system.</p> <p>Backend: <code>backend/src/server.js</code> Rate Limit: 10 requests per minute per socket</p>"},{"location":"tech/socket-events/#connection-events","title":"Connection Events","text":""},{"location":"tech/socket-events/#userconnect","title":"<code>user:connect</code>","text":"<p>Direction: Client \u2192 Server Purpose: Bind socket ID to wallet address for routing messages</p> <p>Payload: <pre><code>{\n  role: \"student\" | \"tutor\",\n  address: \"0x...\" // Wallet address\n}\n</code></pre></p> <p>Response: None (silent success)</p> <p>Example: <pre><code>socket.emit(\"user:connect\", {\n  role: \"student\",\n  address: \"0x1234567890abcdef1234567890abcdef12345678\"\n});\n</code></pre></p>"},{"location":"tech/socket-events/#tutor-events","title":"Tutor Events","text":""},{"location":"tech/socket-events/#tutorsetavailable","title":"<code>tutor:setAvailable</code>","text":"<p>Direction: Client \u2192 Server Purpose: Tutor goes online and becomes available for matching</p> <p>Payload: <pre><code>{\n  address: \"0x...\",\n  language: \"spanish\", // lowercase language code\n  ratePerSecond: 100000 // in PYUSD wei (6 decimals)\n}\n</code></pre></p> <p>Callback Response: <pre><code>{\n  ok: true,\n  result: { success: true },\n  pendingRequests: 2 // Number of pending student requests\n}\n</code></pre></p> <p>Server Emits: - <code>tutor:incoming-request</code> - If there are pending student requests - <code>tutor:available-updated</code> (broadcast) - Notify all clients</p> <p>Example: <pre><code>socket.emit(\"tutor:setAvailable\", {\n  address: \"0x...\",\n  language: \"spanish\",\n  ratePerSecond: 100000\n}, (response) =&gt; {\n  if (response.ok) {\n    console.log(`Available! ${response.pendingRequests} pending requests`);\n  }\n});\n</code></pre></p> <p>Notes: - Automatically checks for pending student requests - Notifies tutor of any matching requests immediately - Old event name <code>tutor:set-available</code> still works (deprecated)</p>"},{"location":"tech/socket-events/#tutorset-unavailable","title":"<code>tutor:set-unavailable</code>","text":"<p>Direction: Client \u2192 Server Purpose: Tutor goes offline and stops receiving requests</p> <p>Payload: <pre><code>{\n  address: \"0x...\"\n}\n</code></pre></p> <p>Server Emits: - <code>tutor:availability-removed</code> - Confirmation to tutor - <code>tutor:withdrew-acceptance</code> (broadcast) - If tutor was in a session state - <code>tutor:available-updated</code> (broadcast) - Notify all clients</p> <p>Example: <pre><code>socket.emit(\"tutor:set-unavailable\", {\n  address: \"0x...\"\n});\n</code></pre></p>"},{"location":"tech/socket-events/#tutoraccept-request","title":"<code>tutor:accept-request</code>","text":"<p>Direction: Client \u2192 Server Purpose: Tutor accepts a student's request</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\"\n}\n</code></pre></p> <p>Server Emits: - <code>student:tutor-accepted</code> - To the student who made the request - <code>tutor:request-accepted</code> - Confirmation to tutor</p> <p>Example: <pre><code>socket.emit(\"tutor:accept-request\", {\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\"\n});\n</code></pre></p> <p>Notes: - Request is removed from pending after acceptance - Student receives tutor details (address, language, rate)</p>"},{"location":"tech/socket-events/#tutordecline-request","title":"<code>tutor:decline-request</code>","text":"<p>Direction: Client \u2192 Server Purpose: Tutor declines a student's request</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\"\n}\n</code></pre></p> <p>Server Emits: - <code>tutor:request-declined</code> - Confirmation to tutor</p> <p>Example: <pre><code>socket.emit(\"tutor:decline-request\", {\n  requestId: \"req_abc123\"\n});\n</code></pre></p>"},{"location":"tech/socket-events/#tutorwithdraw-acceptance","title":"<code>tutor:withdraw-acceptance</code>","text":"<p>Direction: Client \u2192 Server Purpose: Tutor withdraws their acceptance and returns to waiting</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\"\n}\n</code></pre></p> <p>Server Emits: - <code>tutor:withdrew-acceptance</code> (broadcast) - Notify student</p> <p>Example: <pre><code>socket.emit(\"tutor:withdraw-acceptance\", {\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\"\n});\n</code></pre></p>"},{"location":"tech/socket-events/#student-events","title":"Student Events","text":""},{"location":"tech/socket-events/#studentrequest-tutor","title":"<code>student:request-tutor</code>","text":"<p>Direction: Client \u2192 Server Purpose: Student requests a tutor for a language</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\", // Unique request ID\n  studentAddress: \"0x...\",\n  language: \"spanish\",\n  budgetPerSecond: 150000 // Maximum rate willing to pay\n}\n</code></pre></p> <p>Server Emits: - <code>student:request-sent</code> - Confirmation to student - <code>tutor:incoming-request</code> - To all matching tutors - <code>student:no-tutors-available</code> - If no tutors online (request still stored)</p> <p>Example: <pre><code>socket.emit(\"student:request-tutor\", {\n  requestId: \"req_\" + Date.now(),\n  studentAddress: \"0x...\",\n  language: \"spanish\",\n  budgetPerSecond: 150000\n});\n</code></pre></p> <p>Notes: - Request is stored in Redis even if no tutors available - Tutors who come online later will see this request - Multiple tutors can accept the same request</p>"},{"location":"tech/socket-events/#studentcancel-request","title":"<code>student:cancel-request</code>","text":"<p>Direction: Client \u2192 Server Purpose: Student cancels their pending request</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  studentAddress: \"0x...\"\n}\n</code></pre></p> <p>Server Emits: - <code>student:request-cancelled</code> - Confirmation to student - <code>student:request-cancelled-broadcast</code> (broadcast) - Notify all tutors</p> <p>Example: <pre><code>socket.emit(\"student:cancel-request\", {\n  requestId: \"req_abc123\",\n  studentAddress: \"0x...\"\n});\n</code></pre></p>"},{"location":"tech/socket-events/#studentaccept-tutor","title":"<code>student:accept-tutor</code>","text":"<p>Direction: Client \u2192 Server Purpose: Student accepts a specific tutor (rejects all others)</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\"\n}\n</code></pre></p> <p>Server Emits: - <code>tutor:student-selected</code> - To the accepted tutor - <code>tutor:student-rejected</code> - To all other tutors who accepted - <code>student:tutor-accepted</code> - Confirmation to student</p> <p>Example: <pre><code>socket.emit(\"student:accept-tutor\", {\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\"\n});\n</code></pre></p> <p>Notes: - Request is removed from storage - All other tutors are notified they were rejected</p>"},{"location":"tech/socket-events/#studentreject-tutor","title":"<code>student:reject-tutor</code>","text":"<p>Direction: Client \u2192 Server Purpose: Student rejects a specific tutor (continues waiting for others)</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\"\n}\n</code></pre></p> <p>Server Emits: - <code>tutor:student-rejected</code> - To the rejected tutor - <code>student:tutor-rejected</code> - Confirmation to student</p> <p>Example: <pre><code>socket.emit(\"student:reject-tutor\", {\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\"\n});\n</code></pre></p> <p>Notes: - Request remains active for other tutors - Student can continue receiving offers</p>"},{"location":"tech/socket-events/#studentrejected-transaction","title":"<code>student:rejected-transaction</code>","text":"<p>Direction: Client \u2192 Server Purpose: Student rejected the wallet transaction to start session</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\"\n}\n</code></pre></p> <p>Server Emits: - <code>tutor:student-rejected-transaction</code> - To tutor - <code>student:transaction-rejection-confirmed</code> - Confirmation to student</p> <p>Example: <pre><code>socket.emit(\"student:rejected-transaction\", {\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\"\n});\n</code></pre></p> <p>Notes: - Tutor returns to waiting state - Student can try again or cancel</p>"},{"location":"tech/socket-events/#studententered-room","title":"<code>student:entered-room</code>","text":"<p>Direction: Client \u2192 Server Purpose: Student has entered the WebRTC room</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\",\n  videoCallUrl: \"https://...\",\n  languageId: 1 // Optional\n}\n</code></pre></p> <p>Server Emits: - <code>student:in-room</code> - To tutor (tutor can now join) - <code>student:room-entry-confirmed</code> - Confirmation to student</p> <p>Example: <pre><code>socket.emit(\"student:entered-room\", {\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\",\n  videoCallUrl: \"https://webrtc.example.com/room/abc123\"\n});\n</code></pre></p> <p>Notes: - Session mapping is stored in Redis for later cleanup - Tutor is notified to join the room</p>"},{"location":"tech/socket-events/#session-events","title":"Session Events","text":""},{"location":"tech/socket-events/#sessionstarted","title":"<code>session:started</code>","text":"<p>Direction: Client \u2192 Server Purpose: Blockchain transaction confirmed, session officially started</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\",\n  videoCallUrl: \"https://...\",\n  languageId: 1 // Optional\n}\n</code></pre></p> <p>Server Emits: - <code>session:started</code> - To tutor (with video call URL) - <code>session:started-confirmed</code> - Confirmation to student</p> <p>Example: <pre><code>socket.emit(\"session:started\", {\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\",\n  videoCallUrl: \"https://webrtc.example.com/room/abc123\",\n  languageId: 1\n});\n</code></pre></p> <p>Notes: - Session mapping stored in Redis - Tutor receives video call URL to join</p>"},{"location":"tech/socket-events/#server-emitted-events","title":"Server-Emitted Events","text":"<p>These events are emitted by the server to clients:</p>"},{"location":"tech/socket-events/#tutorincoming-request","title":"<code>tutor:incoming-request</code>","text":"<p>Direction: Server \u2192 Tutor Purpose: Notify tutor of a student request</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  student: {\n    address: \"0x...\",\n    language: \"spanish\",\n    budgetPerSecond: 150000\n  }\n}\n</code></pre></p>"},{"location":"tech/socket-events/#studenttutor-accepted","title":"<code>student:tutor-accepted</code>","text":"<p>Direction: Server \u2192 Student Purpose: Notify student that a tutor accepted their request</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  language: \"spanish\",\n  ratePerSecond: 100000,\n  socketId: \"socket_id_here\"\n}\n</code></pre></p>"},{"location":"tech/socket-events/#tutorstudent-selected","title":"<code>tutor:student-selected</code>","text":"<p>Direction: Server \u2192 Tutor Purpose: Notify tutor they were selected by student</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  studentAddress: \"0x...\",\n  message: \"Student selected you! Session starting...\"\n}\n</code></pre></p>"},{"location":"tech/socket-events/#tutorstudent-rejected","title":"<code>tutor:student-rejected</code>","text":"<p>Direction: Server \u2192 Tutor Purpose: Notify tutor they were rejected</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  studentAddress: \"0x...\",\n  selectedTutorAddress: \"0x...\" | null,\n  message: \"Student selected another tutor\"\n}\n</code></pre></p>"},{"location":"tech/socket-events/#tutorwithdrew-acceptance","title":"<code>tutor:withdrew-acceptance</code>","text":"<p>Direction: Server \u2192 Student (broadcast) Purpose: Notify that tutor withdrew their acceptance</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  tutorAddress: \"0x...\",\n  studentAddress: \"0x...\",\n  message: \"Tutor withdrew their acceptance...\"\n}\n</code></pre></p>"},{"location":"tech/socket-events/#studentin-room","title":"<code>student:in-room</code>","text":"<p>Direction: Server \u2192 Tutor Purpose: Notify tutor that student is in the WebRTC room</p> <p>Payload: <pre><code>{\n  requestId: \"req_abc123\",\n  studentAddress: \"0x...\",\n  videoCallUrl: \"https://...\",\n  message: \"Student is in the room! You can join now.\"\n}\n</code></pre></p>"},{"location":"tech/socket-events/#error","title":"<code>error</code>","text":"<p>Direction: Server \u2192 Client Purpose: Notify client of an error</p> <p>Payload: <pre><code>{\n  message: \"Error description\"\n}\n</code></pre></p> <p>Common Errors: - \"Rate limit exceeded\" - \"Missing required fields\" - \"Request not found or expired\" - \"Failed to process request\"</p>"},{"location":"tech/socket-events/#connection-management","title":"Connection Management","text":""},{"location":"tech/socket-events/#disconnect","title":"<code>disconnect</code>","text":"<p>Direction: Automatic (Socket.io) Purpose: Handle client disconnection</p> <p>Server Actions: - Remove tutor from available list - Clean up socket-to-address mapping - Broadcast availability update - Clean up rate limiting data</p> <p>Disconnect Reasons: - <code>transport close</code> - Connection closed - <code>client namespace disconnect</code> - Client disconnected - <code>ping timeout</code> - No ping received - <code>transport error</code> - Network error</p>"},{"location":"tech/socket-events/#rate-limiting","title":"Rate Limiting","text":"<p>All socket events are rate-limited to 10 requests per minute per socket.</p> <p>Exceeded Response: <pre><code>{\n  ok: false,\n  error: \"Rate limit exceeded\"\n}\n</code></pre></p> <p>Or emitted as: <pre><code>socket.emit(\"error\", { message: \"Rate limit exceeded\" });\n</code></pre></p>"},{"location":"tech/socket-events/#redis-data-structures","title":"Redis Data Structures","text":""},{"location":"tech/socket-events/#tutor-availability","title":"Tutor Availability","text":"<pre><code>Key: tutor:{address}\nType: Hash\nFields:\n  - socketId: \"socket_id\"\n  - language: \"spanish\"\n  - ratePerSecond: \"100000\"\n</code></pre>"},{"location":"tech/socket-events/#student-requests","title":"Student Requests","text":"<pre><code>Key: student_request:{requestId}\nType: Hash\nFields:\n  - studentAddress: \"0x...\"\n  - studentSocketId: \"socket_id\"\n  - language: \"spanish\"\n  - budgetPerSecond: \"150000\"\n  - timestamp: \"1699999000\"\n</code></pre>"},{"location":"tech/socket-events/#session-mapping","title":"Session Mapping","text":"<pre><code>Key: session:{requestId}\nType: Hash\nFields:\n  - studentAddress: \"0x...\"\n  - tutorAddress: \"0x...\"\n  - languageId: \"1\"\n</code></pre>"},{"location":"tech/socket-events/#socket-to-address-mapping","title":"Socket-to-Address Mapping","text":"<pre><code>Key: socket_to_address\nType: Hash\nFields:\n  - {socketId}: \"0x...\"\n</code></pre>"},{"location":"tech/socket-events/#example-flow","title":"Example Flow","text":""},{"location":"tech/socket-events/#complete-student-tutor-matching-flow","title":"Complete Student-Tutor Matching Flow","text":"<pre><code>// 1. Tutor goes online\nsocket.emit(\"tutor:setAvailable\", {\n  address: \"0xTUTOR\",\n  language: \"spanish\",\n  ratePerSecond: 100000\n});\n\n// 2. Student requests tutor\nsocket.emit(\"student:request-tutor\", {\n  requestId: \"req_123\",\n  studentAddress: \"0xSTUDENT\",\n  language: \"spanish\",\n  budgetPerSecond: 150000\n});\n\n// 3. Tutor receives request\nsocket.on(\"tutor:incoming-request\", (data) =&gt; {\n  // Show request to tutor\n});\n\n// 4. Tutor accepts\nsocket.emit(\"tutor:accept-request\", {\n  requestId: \"req_123\",\n  tutorAddress: \"0xTUTOR\"\n});\n\n// 5. Student receives acceptance\nsocket.on(\"student:tutor-accepted\", (data) =&gt; {\n  // Show tutor details to student\n});\n\n// 6. Student accepts tutor\nsocket.emit(\"student:accept-tutor\", {\n  requestId: \"req_123\",\n  tutorAddress: \"0xTUTOR\",\n  studentAddress: \"0xSTUDENT\"\n});\n\n// 7. Tutor receives selection\nsocket.on(\"tutor:student-selected\", (data) =&gt; {\n  // Wait for blockchain transaction\n});\n\n// 8. Student starts session on blockchain\n// (calls startSession() smart contract function)\n\n// 9. Student confirms session started\nsocket.emit(\"session:started\", {\n  requestId: \"req_123\",\n  tutorAddress: \"0xTUTOR\",\n  studentAddress: \"0xSTUDENT\",\n  videoCallUrl: \"https://...\"\n});\n\n// 10. Student enters WebRTC room\nsocket.emit(\"student:entered-room\", {\n  requestId: \"req_123\",\n  tutorAddress: \"0xTUTOR\",\n  studentAddress: \"0xSTUDENT\",\n  videoCallUrl: \"https://...\"\n});\n\n// 11. Tutor receives notification\nsocket.on(\"student:in-room\", (data) =&gt; {\n  // Join WebRTC room\n});\n\n// 12. Session happens...\n\n// 13. Either party ends session\n// (WebRTC server calls backend, backend calls endSession() on blockchain)\n\n// 14. Both parties return to search\n</code></pre>"},{"location":"tech/socket-events/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tech/socket-events/#socket-not-connecting","title":"Socket Not Connecting","text":"<ul> <li>Check CORS settings in backend</li> <li>Verify Socket.io client version matches server</li> <li>Check network/firewall settings</li> </ul>"},{"location":"tech/socket-events/#events-not-received","title":"Events Not Received","text":"<ul> <li>Verify socket is connected: <code>socket.connected</code></li> <li>Check if socket ID is bound: emit <code>user:connect</code> first</li> <li>Check rate limiting (10 req/min)</li> </ul>"},{"location":"tech/socket-events/#tutor-not-receiving-requests","title":"Tutor Not Receiving Requests","text":"<ul> <li>Verify tutor called <code>tutor:setAvailable</code></li> <li>Check language matching (must be exact match)</li> <li>Check rate matching (tutor rate &lt;= student budget)</li> <li>Verify socket is still connected</li> </ul>"},{"location":"tech/socket-events/#student-not-receiving-acceptances","title":"Student Not Receiving Acceptances","text":"<ul> <li>Verify request was stored (check Redis)</li> <li>Check if student socket is still connected</li> <li>Verify student socket ID is correct</li> </ul>"},{"location":"tech/socket-events/#testing","title":"Testing","text":""},{"location":"tech/socket-events/#manual-testing-with-socketio-client","title":"Manual Testing with Socket.io Client","text":"<pre><code>const io = require(\"socket.io-client\");\nconst socket = io(\"http://localhost:4000\");\n\nsocket.on(\"connect\", () =&gt; {\n  console.log(\"Connected:\", socket.id);\n\n  // Test tutor availability\n  socket.emit(\"tutor:setAvailable\", {\n    address: \"0x1234...\",\n    language: \"spanish\",\n    ratePerSecond: 100000\n  }, (response) =&gt; {\n    console.log(\"Response:\", response);\n  });\n});\n\nsocket.on(\"error\", (error) =&gt; {\n  console.error(\"Error:\", error);\n});\n</code></pre>"},{"location":"tech/socket-events/#testing-with-browser-console","title":"Testing with Browser Console","text":"<pre><code>// In browser console (if Socket.io client is loaded)\nconst socket = io(\"http://localhost:4000\");\n\nsocket.on(\"connect\", () =&gt; {\n  console.log(\"Connected!\");\n});\n\nsocket.emit(\"student:request-tutor\", {\n  requestId: \"test_\" + Date.now(),\n  studentAddress: \"0xtest\",\n  language: \"spanish\",\n  budgetPerSecond: 150000\n});\n</code></pre>"},{"location":"tech/socket-events/#related-documentation","title":"Related Documentation","text":"<ul> <li>Architecture Overview - System architecture</li> <li>WebRTC Integration - Video call integration</li> <li>Language Matching Fix - Known language matching issue</li> </ul> <p>Last Updated: November 10, 2025</p>"}]}